"use strict";(self.webpackChunkbackoffice=self.webpackChunkbackoffice||[]).push([[210],{9210:(l_,R,n)=>{n.r(R),n.d(R,{AppRepositoriesModule:()=>s_});var S=n(4666),N=n(609),A=n(959),E=n(1670),l=n(3698),p=n(1843),U=n(4505),h=n(4139),C=n(9095),m=n(7418),T=n(6942),b=n(9151),f=n(6123),L=n(2016),B=n(9850),_=n(9676),y=n(640);let c=(()=>{class t{constructor(e,o){this._state=e,this._dialog=o,this._loading=new U.X(!1),this.loading=this._loading.asObservable(),this.item=this._state.item,this.driver_list=this._state.active_item$.pipe((0,C.w)(i=>i instanceof l.aPq&&i.repo_type!==l.VYb.Interface?(this._loading.next(!0),(0,l.qTj)(i.id,{limit:2e3})):(0,h.of)(null)),(0,m.K)(i=>[]),(0,T.U)(i=>(this._loading.next(!1),i))),this.commit=this._state.active_item$.pipe((0,b.h)(i=>i instanceof l.aPq),(0,C.w)(i=>(0,l.rmk)(i.id,{count:1})),(0,m.K)(i=>[]),(0,T.U)(i=>i[0]?.commit||"HEAD"))}get active_item(){return this._state.active_item}pullLatestCommit(){var e=this;return(0,E.Z)(function*(){if(!(yield(0,l.cYE)(e.active_item.id).toPromise().catch(s=>{(0,L.cB)(`Error pulling latest commit. Error: ${JSON.stringify(s.response||s.message||"Pull timed out")}`)})))return;const i=yield(0,l.AOp)(e.active_item.id).toPromise();e._state.replaceItem(i)})()}newDriver(e){var o=this;return(0,E.Z)(function*(){o._dialog.open(B.K,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:new l.CbG({name:"",module_name:"",repository_id:o.active_item.id,file_name:e}),name:"Driver",save:i=>(0,l.X2O)(i)}})})()}}return t.\u0275fac=function(e){return new(e||t)(_.LFG(f.L),_.LFG(y.uw))},t.\u0275prov=_.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var d=n(4522),P=n(1708),$=n(239),Z=n(3674);function D(t,r){if(1&t&&(_.TgZ(0,"span",22),_._uU(1),_.qZA()),2&t){const e=_.oxw();_.xp6(1),_.hij(" (",e.commit,") ")}}function x(t,r){1&t&&(_.ynx(0),_.SDv(1,23),_.BQk())}function K(t,r){1&t&&_._UZ(0,"mat-spinner",24)}let X=(()=>{class t extends p.K{constructor(e){super(),this._service=e,this.commit=""}get item(){return this._service.active_item}get local_url(){return this.item.type===l.VYb.Interface?`${location.origin}/${this.item.folder_name}/`:`${location.hash}`}get repo_uri(){return this.item?.uri.replace(/\/[a-zA-Z0-9\-\.:]*@/,"/...@")}ngOnInit(){this.commit="",this.subscription("commit",this._service.commit.subscribe(e=>this.commit=e))}pullLatestCommit(){var e=this;return(0,E.Z)(function*(){e.pulling=!0,yield e._service.pullLatestCommit(),e.pulling=!1})()}}return t.\u0275fac=function(e){return new(e||t)(_.Y36(c))},t.\u0275cmp=_.Xpm({type:t,selectors:[["repository-about"]],features:[_.qOj],decls:54,vars:25,consts:function(){let r,e,o,i,s,O,I,g,v,M,F;return r=$localize`:@@descriptionLabel␟4a22c6843133f0b0d7dc0d28f864f2f90c1de7ad␟6996799422725544865:Description:`,e=$localize`:@@repoTypeLabel␟e78c0d60ac39787f62c9159646fe0b3c1ed55a1d␟2736556170366900089:Type:`,o=$localize`:␟f07f17add1b4d8fd14dedf1038249bf1fcc7595c␟2995574017154029352:{VAR_SELECT, select, interface {Interface Repository } driver {Driver Repository } , other {=Unknown=}}`,o=_.Zx4(o,{VAR_SELECT:"\ufffd0\ufffd"}),i=$localize`:@@driverListEmpty␟ae94603c1f5d07ee3a1a2697b3b44cdf7ba68b3b␟1624572359752225100: ${o}:ICU: `,s=$localize`:@@repoFolderNameLabel␟28e6abdb97b12116fa31c70e842d7b4b37e08fda␟8999240573830223335:Folder name:`,O=$localize`:@@repoCreatedAtLabel␟a5ed099ffc9e96f6970df843289ade8a7d20ab9f␟1616250945945379783:Created:`,I=$localize`:@@repoUpdatedAtLabel␟f94240161f912dbd8758b858877cddeab80f36cb␟1116759395536210856:Updated:`,g=$localize`:@@repoUriLabel␟6457460dafb273ccfbc2d68f7ec171f467c6e1c1␟1789506856666851299:Repository URI:`,v=$localize`:@@repoBranchLabel␟6ff214f90707e3964f2a08e22f6a079ec2649a5f␟733188758140846537:Branch:`,M=$localize`:@@repoCommitHashLabel␟682ca154aba791fe87aa293b29c921247e12da9c␟7502103762200984555:Commit hash:`,F=$localize`:@@repoPullAction␟e74b9f1086c2fdfeaf7334dbdfa8651830ab2acf␟2864409842456905465: Pull latest commit `,[[1,"mb-4","text-center","flex","space-x-2"],[1,"shadow","rounded","p-2","border","border-black/10","space-y-2","min-w-[45%]","flex-1","flex","flex-col"],[1,"flex","items-center","space-x-2"],r,[1,"value","select-all"],e,[1,"value"],i,s,["target","_blank",3,"href"],O,I,g,[1,"value","underline","select-all"],v,[1,"text-xs"],M,["class","select-text mono",4,"ngIf"],[1,"flex-1"],["mat-button","",1,"w-full",3,"disabled","click"],[4,"ngIf","ngIfElse"],["spinner",""],[1,"select-text","mono"],F,["diameter","32"]]},template:function(e,o){if(1&e&&(_.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"label"),_.SDv(4,3),_.qZA(),_.TgZ(5,"div",4),_._uU(6),_.qZA()(),_.TgZ(7,"div",2)(8,"label"),_.SDv(9,5),_.qZA(),_.TgZ(10,"div",6),_.SDv(11,7),_.qZA()(),_.TgZ(12,"div",2)(13,"label"),_.SDv(14,8),_.qZA(),_.TgZ(15,"div",4)(16,"a",9),_._uU(17),_.qZA()()(),_.TgZ(18,"div",2)(19,"label"),_.SDv(20,10),_.qZA(),_.TgZ(21,"div",6),_._uU(22),_.ALo(23,"dateFrom"),_.qZA()(),_.TgZ(24,"div",2)(25,"label"),_.SDv(26,11),_.qZA(),_.TgZ(27,"div",6),_._uU(28),_.ALo(29,"dateFrom"),_.qZA()()(),_.TgZ(30,"div",1)(31,"div",2)(32,"label"),_.SDv(33,12),_.qZA(),_.TgZ(34,"div",13)(35,"a",9),_.ALo(36,"safe"),_._uU(37),_.qZA()()(),_.TgZ(38,"div",2)(39,"label"),_.SDv(40,14),_.qZA(),_.TgZ(41,"code",15),_._uU(42),_.qZA()(),_.TgZ(43,"div",2)(44,"label"),_.SDv(45,16),_.qZA(),_.TgZ(46,"code",15),_._uU(47),_.YNc(48,D,2,1,"span",17),_.qZA()(),_._UZ(49,"div",18),_.TgZ(50,"button",19),_.NdJ("click",function(){return o.pullLatestCommit()}),_.YNc(51,x,2,0,"ng-container",20),_.qZA()()(),_.YNc(52,K,1,0,"ng-template",null,21,_.W1O)),2&e){const i=_.MAs(53);_.xp6(6),_.hij(" ",o.item.description||"No description"," "),_.xp6(5),_.pQV(o.item.type),_.QtT(11),_.xp6(4),_.ekj("underline","interface"===o.item.type)("pointer-events-none","interface"!==o.item.type),_.xp6(1),_.Q6J("href",o.local_url,_.LSH),_.xp6(1),_.Oqu(o.item.folder_name||"No folder set"),_.xp6(5),_.hij(" ",_.lcZ(23,18,1e3*o.item.created_at)," "),_.xp6(6),_.hij(" ",_.lcZ(29,20,1e3*o.item.updated_at)," "),_.xp6(7),_.Q6J("href",_.xi3(36,22,o.item.uri,"url"),_.LSH),_.xp6(2),_.Oqu(o.repo_uri||"No URI set"),_.xp6(5),_.hij(" ",o.item.branch||"master"," "),_.xp6(5),_.hij(" ",o.item.commit_hash||"No Commit hash set"," "),_.xp6(1),_.Q6J("ngIf",o.commit&&o.commit!==o.item.commit_hash),_.xp6(2),_.Q6J("disabled",o.pulling),_.xp6(1),_.Q6J("ngIf",!o.pulling)("ngIfElse",i)}},dependencies:[S.O5,d.lW,P.Ou,$.R,Z.y],styles:["[_nghost-%COMP%]{height:100%;width:100%}.mono[_ngcontent-%COMP%]{font-family:var(--mono-font)}label[_ngcontent-%COMP%]{width:6rem;text-align:left}\n/*# sourceMappingURL=repository-about.component.ts-angular-inline--47.css.map*/"]}),t})();var u=n(5341),Y=n(9429);function G(t,r){if(1&t){const e=_.EpF();_.TgZ(0,"div",13),_._UZ(1,"div",14),_.ALo(2,"driverFormat"),_.TgZ(3,"div",15)(4,"button",16),_.NdJ("click",function(){const s=_.CHM(e).$implicit,O=_.oxw(3);return _.KtG(O.newDriver(s))}),_._UZ(5,"app-icon",17),_.qZA()()()}if(2&t){const e=r.$implicit;_.xp6(1),_.Q6J("innerHTML",_.lcZ(2,1,e),_.oJD)}}function z(t,r){if(1&t&&(_.TgZ(0,"div",6)(1,"div",7)(2,"td",8),_.SDv(3,9),_.qZA(),_._UZ(4,"td",10),_.qZA(),_.TgZ(5,"div",11),_.YNc(6,G,6,3,"div",12),_.ALo(7,"async"),_.qZA()()),2&t){const e=_.oxw(2);_.xp6(6),_.Q6J("ngForOf",_.lcZ(7,1,e.driver_list))}}function J(t,r){if(1&t&&(_.ynx(0),_.YNc(1,z,8,3,"div",5),_.ALo(2,"async"),_.BQk()),2&t){const e=_.oxw(),o=_.MAs(4);let i;_.xp6(1),_.Q6J("ngIf",null==(i=_.lcZ(2,2,e.driver_list))?null:i.length)("ngIfElse",o)}}function w(t,r){1&t&&(_.TgZ(0,"div",18)(1,"p"),_.SDv(2,19),_.qZA()())}function Q(t,r){1&t&&(_.TgZ(0,"div",18),_._UZ(1,"mat-spinner",20),_.TgZ(2,"p"),_.SDv(3,21),_.qZA()())}let j=(()=>{class t{constructor(e){this._service=e,this.driver_list=this._service.driver_list,this.newDriver=o=>this._service.newDriver(o)}get item(){return this._service.active_item}}return t.\u0275fac=function(e){return new(e||t)(_.Y36(c))},t.\u0275cmp=_.Xpm({type:t,selectors:[["repository-drivers"]],decls:7,vars:2,consts:function(){let r,e,o,i;return r=$localize`:@@repoDriverHeader␟0fb2961dd5d0938e459c98921d1effe1d21e759b␟4782277420149557084:Available Drivers`,e=$localize`:@@driverListname␟cff1428d10d59d14e45edec3c735a27b5482db59␟8953033926734869941:Name`,o=$localize`:@@driverListEmpty␟0b0bbe90203a8b9ff0681db976d02fbcd960cb85␟6121742772920538074:No drivers for repository`,i=$localize`:@@driverListLoading␟929bfd86e4829c0b7401762d92f52536a57ca6c0␟4949757592530193773:Loading driver list...`,[[1,"font-medium","text-lg","mb-2"],r,[4,"ngIf","ngIfElse"],["empty_state",""],["load_state",""],["role","table","class","overflow-x-auto",4,"ngIf","ngIfElse"],["role","table",1,"overflow-x-auto"],["table-head",""],[1,"flex-1","p-2"],e,[1,"w-12","p-2","h-10"],["body","",1,"overflow-y-auto"],["table-row","",4,"ngFor","ngForOf"],["table-row",""],[1,"flex-1","p-2",3,"innerHTML"],[1,"w-12","flex","justify-center"],["mat-icon-button","",3,"click"],["className","backoffice-plus"],[1,"flex","flex-col","p-8","items-center","justify-center"],o,["diameter","48",1,"mb-4"],i]},template:function(e,o){if(1&e&&(_.TgZ(0,"h3",0),_.SDv(1,1),_.qZA(),_.YNc(2,J,3,4,"ng-container",2),_.YNc(3,w,3,0,"ng-template",null,3,_.W1O),_.YNc(5,Q,4,0,"ng-template",null,4,_.W1O)),2&e){const i=_.MAs(6);_.xp6(2),_.Q6J("ngIf",!o.loading)("ngIfElse",i)}},dependencies:[S.sg,S.O5,u.o,d.lW,P.Ou,S.Ov,Y.X],styles:["[_nghost-%COMP%]{height:100%;width:100%}\n/*# sourceMappingURL=repository-drivers.component.ts-angular-inline--48.css.map*/"]}),t})();var V=n(9960),H=n(8537),W=n(4834),k=n(3409),q=n(3182),__=n(1535),e_=n(1551),t_=n(6896),o_=n(207);function i_(t,r){if(1&t){const e=_.EpF();_.ynx(0),_._UZ(1,"item-details",11)(2,"item-tablist",12),_.TgZ(3,"div",13,14),_.NdJ("scroll",function(){_.CHM(e);const i=_.MAs(4),s=_.oxw();return _.KtG(s.scroll=i.scrollTop)}),_._UZ(5,"router-outlet"),_.qZA(),_.BQk()}if(2&t){const e=_.oxw();_.xp6(1),_.Q6J("can_edit",!0)("item",e.item),_.xp6(1),_.Q6J("base",e.name)("tabs",e.tab_list)("scrolled",e.scroll>0)}}const n_=[{path:":id",component:(()=>{class t extends p.K{constructor(e,o){super(),this._service=e,this._item=o,this.name="repositories",this.open_menu=!1,this.driver_count=0,this.tab_list=[],this.newItem=()=>this._item.create()}get item(){return this._service.active_item}get extensions(){return(0,H.fq)(this._service.active_item,this.name)}updateTabList(){this.tab_list=(this.driver_count<0||!this.driver_count?[{id:"about",name:"About",icon:{class:"backoffice-info-with-circle"}}]:[{id:"about",name:"About",icon:{class:"backoffice-info-with-circle"}},{id:"drivers",name:"Drivers",count:this.driver_count,icon:{class:"backoffice-documents"}}]).concat(this.extensions)}ngOnInit(){var e=this;return(0,E.Z)(function*(){e.subscription("item",e._service.driver_list.subscribe(o=>{e.driver_count=o?o.length:-1,e.updateTabList()})),e.updateTabList()})()}}return t.\u0275fac=function(e){return new(e||t)(_.Y36(c),_.Y36(f.L))},t.\u0275cmp=_.Xpm({type:t,selectors:[["new-repositories-view"]],features:[_.qOj],decls:11,vars:5,consts:[[1,"absolute","inset-0","flex","items-center","divide-y","sm:divide-y-0","sm:divide-x","divide-gray-300","dark:divide-neutral-600","bg-white","dark:bg-neutral-700"],[1,"sm:h-full",3,"open","openChange"],["title","Repositories",1,"hidden","sm:block",3,"route"],[1,"flex-1","w-1/2","h-full","relative","flex","flex-col","z-0"],["title","Repositories",1,"z-20","sm:hidden",3,"route"],["mat-icon-button","",1,"sm:hidden","mr-2",3,"click"],["className","backoffice-menu"],[1,"flex","flex-col","flex-1","h-1/2"],[4,"ngIf"],["matTooltip","New repository","matTooltipPosition","right","matRipple","",1,"absolute","bottom-2","left-2","sm:-left-9","w-12","h-12","flex","items-center","justify-center","bg-primary","dark:bg-pink","rounded-lg","shadow","z-30","text-white",3,"click"],[1,"text-3xl",3,"className"],["type","Repository",3,"can_edit","item"],[1,"z-10",3,"base","tabs","scrolled"],[1,"flex-1","h-1/2","w-full","overflow-auto","p-4","z-0","relative",3,"scroll"],["el",""]],template:function(e,o){1&e&&(_.TgZ(0,"div",0)(1,"sidebar-menu",1),_.NdJ("openChange",function(s){return o.open_menu=s}),_.qZA(),_._UZ(2,"item-sidebar",2),_.TgZ(3,"div",3)(4,"item-selection",4)(5,"button",5),_.NdJ("click",function(){return o.open_menu=!0}),_._UZ(6,"app-icon",6),_.qZA()(),_.TgZ(7,"div",7),_.YNc(8,i_,6,5,"ng-container",8),_.qZA(),_.TgZ(9,"button",9),_.NdJ("click",function(){return o.newItem()}),_._UZ(10,"app-icon",10),_.qZA()()()),2&e&&(_.xp6(1),_.Q6J("open",o.open_menu),_.xp6(1),_.Q6J("route",o.name),_.xp6(2),_.Q6J("route",o.name),_.xp6(4),_.Q6J("ngIf",null==o.item?null:o.item.id),_.xp6(2),_.Q6J("className","backoffice-plus"))},dependencies:[S.O5,A.lC,u.o,W.$,k.V,q.K,__.r,e_.l,d.lW,t_.gM,o_.wG]}),t})(),children:[{path:"about",component:X},{path:"drivers",component:j},{path:"extend/:id",component:V.z},{path:"**",redirectTo:"about"}]},{path:"**",redirectTo:"-"}];var r_=n(4524);let s_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=_.oAB({type:t}),t.\u0275inj=_.cJS({imports:[S.ez,N.u5,A.Bz.forChild(n_),r_.X]}),t})()}}]);
//# sourceMappingURL=210.64e02b10b5ef0cc7.js.map