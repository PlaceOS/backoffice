<div class="module form" *ngIf="form">
    <form [formGroup]="form">
        <div class="field" *ngIf="form.controls.dependency">
            <label
                for="dependency"
                [class.error]="form.controls.dependency.invalid && form.controls.dependency.touched"
            >
                Dependency<span>*</span>:
            </label>
            <item-search-field
                [service]="driver_service"
                formControlName="dependency"
            ></item-search-field>
            <div
                class="error"
                *ngIf="form.controls.dependency.invalid && form.controls.dependency.touched"
            >
                Dependency is required
            </div>
        </div>
        <div class="field" *ngIf="form.controls.system">
            <label
                for="dependency"
                [class.error]="form.controls.system.invalid && form.controls.system.touched"
                >Control System<span>*</span>:
            </label>
            <item-search-field
                [service]="system_service"
                formControlName="system"
            ></item-search-field>
            <div class="error" *ngIf="form.controls.system.invalid && form.controls.system.touched">
                Control System is required
            </div>
        </div>
        <div class="fieldset">
            <div class="field" *ngIf="form.controls.ip">
                <label
                    for="ip"
                    [class.error]="form.controls.ip.invalid && form.controls.ip.touched"
                >
                    IP Address:
                </label>
                <mat-form-field appearance="outline">
                    <input matInput name="ip" placeholder="IP Address" formControlName="ip" />
                    <mat-error *ngIf="form.controls.ip.invalid">
                        A valid IP address is required
                    </mat-error>
                </mat-form-field>
            </div>
            <div class="field" *ngIf="form.controls.port">
                <label
                    for="system-name"
                    [class.error]="form.controls.port.invalid && form.controls.port.touched"
                >
                    Port Number:
                </label>
                <mat-form-field appearance="outline">
                    <input
                        matInput
                        name="system-name"
                        type="number"
                        placeholder="Port Number"
                        formControlName="port"
                    />
                    <mat-error *ngIf="form.controls.port.invalid">
                        A valid port number between 1 - 65535 is required
                    </mat-error>
                </mat-form-field>
            </div>
        </div>
        <div class="field" *ngIf="form.controls.tls">
            <mat-checkbox name="tls" formControlName="tls">TLS</mat-checkbox>
        </div>
        <div class="field" *ngIf="form.controls.udp">
            <mat-checkbox name="udp" formControlName="udp">UDP</mat-checkbox>
        </div>
        <div class="field" *ngIf="form.controls.makebreak">
            <mat-checkbox name="makebreak" formControlName="makebreak">Makebreak</mat-checkbox>
        </div>
        <div class="field" *ngIf="form.controls.ignore_connected">
            <mat-checkbox name="ignore-connected" formControlName="ignore_connected">
                Ignore Connected
            </mat-checkbox>
        </div>
        <div class="field" *ngIf="form.controls.uri">
            <label for="uri" [class.error]="form.controls.uri.invalid && form.controls.uri.touched">
                URI:
            </label>
            <mat-form-field appearance="outline">
                <input matInput name="uri" placeholder="Device URI" formControlName="uri" />
                <mat-error *ngIf="form.controls.uri.invalid">A valid URI is required</mat-error>
            </mat-form-field>
        </div>
        <div class="field" *ngIf="form.controls.notes">
            <label for="notes">Notes:</label>
            <mat-form-field appearance="outline">
                <textarea
                    matInput
                    name="notes"
                    placeholder="Device Notes"
                    formControlName="notes"
                ></textarea>
            </mat-form-field>
        </div>
        <div class="field" *ngIf="form.controls.settings_encryption_level">
            <label for="encryption-level">Settings Encryption Level: </label>
            <mat-form-field appearance="outline">
                <mat-select name="encryption-level" formControlName="settings_encryption_level">
                    <mat-option *ngFor="let type of encryption_levels" [value]="type.id">
                    {{type.name}}
                    </mat-option>
                </mat-select>
            </mat-form-field>
        </div>
        <div class="field" *ngIf="form.controls.settings_string">
            <label
                for="settings"
                [class.error]="
                    form.controls.settings_string.invalid && form.controls.settings_string.touched
                "
                >Settings:</label
            >
            <settings-form-field formControlName="settings_string" [readonly]="false"></settings-form-field>
            <div
                class="error"
                *ngIf="
                    form.controls.settings_string.invalid && form.controls.settings_string.touched
                "
            >
                Settings must be valid YAML
            </div>
        </div>
        <div class="field" *ngIf="form.controls.custom_name">
            <label for="uri">Custom Name:</label>
            <mat-form-field appearance="outline">
                <input
                    matInput
                    name="uri"
                    placeholder="Custom Name"
                    formControlName="custom_name"
                />
            </mat-form-field>
        </div>
    </form>
</div>
