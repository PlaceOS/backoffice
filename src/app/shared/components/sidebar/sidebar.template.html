<div class="container">
    <header>
        <div class="heading">{{heading}}</div>
        <div class="count">
            <div *ngIf="new">
                <div class="inline" tooltip name="dark" [template]="info" [hover]="true" [triangle]="false">
                    {{total || 0}}<span *ngIf="licenses"> of {{licenses || 'âˆž'}}</span>
                </div>
            </div>
            <ng-template #info>
                <div class="tooltip">
                    {{heading}} count / License count
                </div>
            </ng-template>
        </div>
        <div class="add" *ngIf="new && (total < licenses || !licenses)" (touchrelease)="event.emit({ type: 'new' })" click-responder>
            <i class="material-icons">add</i>
        </div>
        <div class="error" *ngIf="new && (total >= licenses && licenses)" tooltip name="dark" [template]="error" [hover]="true" [triangle]="false">
            <i class="material-icons">error</i>
            <ng-template #error>
                <div class="tooltip">
                    Exceeded quota! No new item can be created<br>
                    until the total is below you license count.
                </div>
            </ng-template>
        </div>
        <div class="search" (touchrelease)="close ? event.emit({ type: 'close' }) : ''">
            <i class="material-icons">{{ close ? 'close' : 'list'}}</i>
        </div>
    </header>
    <section class="search">
        <div class="input">
            <input [(ngModel)]="search" (ngModelChange)="searching()" [placeholder]="'Filter ' + model.lowercase_header">
        </div>
    </section>
    <section class="content">
        <ng-content></ng-content>
    </section>
    <section class="list" #item_list (scroll)="atBottom()">
        <div #list_item class="item" *ngFor="let item of list" [title]="item?.custom_name || item?.name || item" (touchrelease)="select(item)">
            <div class="text">{{item?.custom_name || item?.name || item}}</div>
            <div class="icon" *ngIf="active === item.id">
                <i class="material-icons">done</i>
            </div>
        </div>
        <div class="no-item" *ngIf="!loading && (!list || list.length <= 0)">
            <div class="icon">
                <i class="material-icons">close</i>
            </div>
            <div class="text">{{ !search ? 'No ' + model.lowercase_header : 'No matches found'}}</div>
            <div class="btn" *ngIf="new">
                <btn (tapped)="event.emit({ type: 'new' })">Add new {{model.lowercase_header}}</btn>
            </div>
        </div>
    </section>
    <div class="loading" *ngIf="loading">
        <spinner type="double-circle-ring" color="#F44336"></spinner>
    </div>
</div>