<section class="execute" *ngIf="system_id && modules && modules.length > 0">
    <div class="row">
        <a-dropdown
            klass="form"
            [items]="modules"
            [ngModel]="null"
            (ngModelChange)="loadFunctions($event)"
            placeholder="Select a device"
        ></a-dropdown>
    </div>
    <div class="row">
        <a-dropdown
            klass="form"
            *ngIf="methods"
            [items]="methods"
            [(ngModel)]="methods"
            (ngModelChange)="selectFunction($event)"
            placeholder="Select a function"
        ></a-dropdown>
        <div class="fn-input" *ngIf="active_method">
            <div class="bracket">(</div>
            <div
                class="arg"
                *ngFor="let arg of active_method.params; let i = index"
            >
                <span
                    class="seperator"
                    [class.solid]="arg[0] === 'req' || fields[arg[1]]"
                    >{{(i > 0 ? ',&nbsp;' : '')}}</span
                >
                <input
                    #argument
                    [(ngModel)]="fields[arg[1]]"
                    (ngModelChange)="checkFields()"
                    [class.error]="error && error[arg[1]]"
                    [style.width]="(.6 * (fields[arg[1]] || (arg[0] === 'opt' ? '[' + arg[1] + ']' : arg[1])).length + .3) + 'em'"
                    [placeholder]="arg[0] === 'opt' ? '[' + arg[1] + ']' : arg[1]"
                    (keyup.enter)="nextField($event)"
                    (keydown.,)="nextField($event)"
                    (keyup.arrowright)="nextField($event)"
                    (keyup.backspace)="previousField($event)"
                    (keyup.arrowleft)="previousField($event)"
                    (focus)="focused(i)"
                />
            </div>
            <div class="bracket">)</div>
        </div>
        <div class="send" *ngIf="active_method">
            <button widget [disabled]="!fields_valid" (tapped)="execute()">
                Send
            </button>
        </div>
    </div>
</section>
