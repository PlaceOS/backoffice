<div class="container" [class.loader]="model.loading" [class.edit]="model.item">
    <div class="header">
        <div class="text">{{model.item ? 'Edit' : 'New'}} Trigger Action</div>
        <div class="close" (touchrelease)="fn.close()">
            <i class="material-icons">close</i>
        </div>
    </div>
    <div class="body">
        <div class="form">
            <div class="field">
                <div class="label">Action<span class="orange">*</span>:</div>
                <div class="value">
                    <dropdown [list]="model.action_types" [model]="-1" (modelChange)="model.form.action_type = model.action_types[$event]"
                        placeholder="Select an action"></dropdown>
                </div>
            </div>
            <div class="fieldset" *ngIf="model.form.action_type && model.form.action_type.id === 'execute'">
                <div class="field">
                    <div class="value">
                        <system-exec [system_id]="model.system?.id"></system-exec>
                    </div>
                </div>
            </div>
            <div class="fieldset" *ngIf="model.form.action_type && model.form.action_type.id === 'email'">
                <div class="field">
                    <div class="label">Email addresses:</div>
                    <div class="value">
                        <input [(ngModel)]="model.form.emails" placeholder="user@email.com, test@email.org, ...">
                    </div>
                </div>
                <div class="field">
                    <div class="label">Email contents:</div>
                    <div class="value full">
                        <textarea [(ngModel)]="model.form.content" placeholder="Email body"></textarea>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer">
            <btn (tapped)="event('Cancel')">Cancel</btn>
            <btn name="inverse" [disabled]="model.has_errors || !model.fields_valid" (tapped)="model.item ? edit() : new()">
                Ok
            </btn>
        </div>
    </div>
    <div class="no-item">
        <div class="icon">
            <spinner type="circle-ring" color="rgba(0,0,0, .54)"></spinner>
        </div>
        <div class="text">Processing request...</div>
    </div>
</div>
