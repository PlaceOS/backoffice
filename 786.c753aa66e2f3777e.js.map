{"version":3,"file":"786.c753aa66e2f3777e.js","mappings":"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","names":["i0","_c0","item_r3","id","icon","name","PlaceComponent","AsyncHandler","extensions","extensionsForItem","this","_service","active_item","dark_mode","_users","debug_position","_debug","position","updateTabList","tab_list","class","concat","constructor","_settings","super","open_menu","ngOnInit","title","t","i1","i2","i3","i4","core","Xpm","selectors","features","decls","vars","consts","template","rf","ctx","$event","PlaceComponent_a_5_Template","PlaceComponent_app_debug_output_10_Template","PlaceComponent_app_debug_output_11_Template","PlaceDatabase","reindex","backfill","url","apiEndpoint","post","toPromise","Yz7","factory","fac","providedIn","PlaceDatabaseDetailsComponent","_engine_service","reindexing","then","err","notifyError","JSON","stringify","response","message","backfilling","PlaceDatabaseDetailsComponent_ng_container_7_Template","PlaceDatabaseDetailsComponent_ng_container_14_Template","PlaceDatabaseDetailsComponent_ng_template_15_Template","_r2","_r7","ctx_r6","changelog","backoffice_logs","ctx_r1","backend_version","_r9","ctx_r8","changelog_data","api_r11","service","commit","version","build_time","platform_version","PlaceDetailsComponent_ng_container_28_div_1_Template","ctx_r3","api_details","PlaceDetailsComponent","user","backoffice_version","VERSION","stamp","backoffice_tag","tag","backoffice_hash","hash","backoffice_build","format","time","_dialog","_cdr","loadApiDetails","loadPlatformDetails","log","open","ChangelogModalComponent","data","copy","content","copyToClipboard","notifyInfo","_this","_asyncToGenerator","details","get","catch","detectChanges","_this2","replace","fetch","text","i18n_0","$localize","PlaceDetailsComponent_button_3_Template","PlaceDetailsComponent_code_25_Template","PlaceDetailsComponent_button_26_Template","PlaceDetailsComponent_ng_container_28_Template","PlaceDetailsComponent_ng_template_29_Template","length","_r4","AdminClusterNodeComponent","points","used_memory","humanReadableByteCount","node","memory_usage","total_memory","memory_total","memory_percentage","generateCharts","ngOnChanges","changes","history","list","unshift","slice","Math","max","map","event","idx","x","y","value","viewQuery","hostname","toFixed","total_cpu","node_r1","ctx_r0","cpu_history","PlaceClusterItemComponent","cluster","cluster_nodes","edge_nodes","inputs","PlaceClusterItemComponent_ng_container_0_Template","element_r4","_r6","$implicit","ctx_r5","confirmKillProcess","cpu_usage","module_instances","PlaceClusterTaskListComponent_div_9_div_12_Template","filtered_list","PlaceClusterTaskListComponent","close","EventEmitter","column_list","filter","BehaviorSubject","_poll","process_list","pipe","loading","switchMap","queryProcesses","include_status","catchError","_","console","error","of","l","sort","a","b","tap","shareReplay","combineLatest","processes","toLowerCase","includes","next","Date","now","interval","process","ref","ConfirmModalComponent","CONFIRM_METADATA","type","subscription","componentInstance","subscribe","reason","killing","killProcess","terminateProcess","outputs","emit","PlaceClusterTaskListComponent_div_9_Template","PlaceClusterTaskListComponent_ng_template_11_Template","_c4","getValue","tmp_3_0","_r1","cluster_r7","active_cluster","_c2","PlaceClusterDetailsComponent_ng_container_1_ng_container_1_ng_container_1_Template","cluster_list","PlaceClusterDetailsComponent_ng_container_1_ng_container_1_Template","_r3","_r11","ctx_r10","ctx_r4","PlaceClusterDetailsComponent","clusters$","startWith","queryClusters","resp","date","forEach","nodes","push","core_cpu","shift","PlaceClusterDetailsComponent_ng_container_1_Template","PlaceClusterDetailsComponent_ng_template_2_Template","PlaceClusterDetailsComponent_ng_template_4_Template","item_r4","AdminInterfacesComponent_div_0_div_7_Template","interfaces","AdminInterfacesComponent","loadInterfaces","listInterfaceRepositories","Object","keys","localeCompare","AdminInterfacesComponent_div_0_Template","AdminInterfacesComponent_ng_template_1_Template","editBroker","ctx_r7","deleteBroker","description","host","port","filters","_c5","AdminBrokersComponent_div_6_div_18_Template","brokers","AdminBrokersComponent","loadBrokers","newBroker","ItemCreateUpdateModalComponent","height","width","maxHeight","maxWidth","item","PlaceMQTTBroker","save","addBroker","updateBroker","openConfirmModal","removeBroker","notifySuccess","queryBrokers","AdminBrokersComponent_div_6_Template","AdminBrokersComponent_ng_template_7_Template","type_r8","type_r11","condition_r9","_r13","ExtensionModalComponent_main_4_div_27_mat_option_7_Template","ctx_r16","removeCondition","_c19","condition_ops","_c20","ExtensionModalComponent_main_4_mat_option_8_Template","ExtensionModalComponent_main_4_label_26_Template","ExtensionModalComponent_main_4_div_27_Template","_r18","ctx_r17","addCondition","form","available_types","controls","conditions","_r20","ctx_r19","submit","ctx_r2","ExtensionModalComponent","_data","_hotkey","FormGroup","FormControl","Validators","required","listen","patchValue","condition","setValue","c","markAllAsTouched","valid","metadata","MAT_DIALOG_DATA","i18n_1","ExtensionModalComponent_button_3_Template","ExtensionModalComponent_main_4_Template","ExtensionModalComponent_footer_5_Template","ExtensionModalComponent_ng_template_6_Template","domain_r7","extension_r9","editExtension","ctx_r12","removeExtension","_c1","PlaceExtensionsComponent_div_2_div_14_div_12_Template","extension_list","_r14","ctx_r13","domain","ctx_r15","setDomain","PlaceExtensionsComponent_div_2_mat_option_6_Template","PlaceExtensionsComponent_div_2_div_14_Template","domain_list","PlaceExtensionsComponent","queryDomains","r","authority","match","find","d","config","backoffice","extend","parse","undefined","first","_ref","i","updateDomain","_x","apply","arguments","_this3","_ref2","e","_x2","_this4","ext","updated","PlaceDomain","attrs","PlaceExtensionsComponent_div_2_Template","PlaceExtensionsComponent_ng_template_3_Template","PlaceExtensionsComponent_ng_template_5_Template","BookingLimitsModalComponent","_dialog_ref","tenant","booking_limits","limits","k","amount","disableClose","BookingLimitsModalComponent_button_4_Template","BookingLimitsModalComponent_main_5_Template","BookingLimitsModalComponent_footer_6_Template","BookingLimitsModalComponent_ng_template_7_Template","item_r10","key","name_map","StaffTenantModalComponent_main_5_form_35_ng_container_1_span_4_Template","StaffTenantModalComponent_main_5_form_35_ng_container_1_input_8_Template","StaffTenantModalComponent_main_5_form_35_ng_container_1_textarea_9_Template","disabled","ctx_r9","StaffTenantModalComponent_main_5_form_35_ng_container_1_Template","credentials","_r17","show_outlook","StaffTenantModalComponent_main_5_div_31_Template","StaffTenantModalComponent_main_5_form_35_Template","StaffTenantModalComponent_main_5_div_36_Template","StaffTenantModalComponent_main_5_form_37_Template","platform","delegated","_r19","ctx_r18","FIELD_NAME_MAPPING","issuer","conference_type","signing_key","sub","client_id","client_secret","scopes","user_agent","StaffTenantModalComponent","office_form","google_form","email_domain","service_account","email","fields","handleDelegation","field","disable","setValidators","enable","updateValueAndValidity","valueChanges","removeControl","addControl","app_id","app_domain","app_resource","source_location","base_path","getInvalidFields","reduce","m","outlook_config","cleanObject","put","StaffTenantModalComponent_button_4_Template","StaffTenantModalComponent_main_5_Template","StaffTenantModalComponent_footer_6_Template","StaffTenantModalComponent_ng_template_7_Template","domain_r6","item_r9","editLimits","editTenant","removeTenant","PlaceStaffAPIComponent_ng_container_9_div_1_div_9_Template","tenants","PlaceStaffAPIComponent_ng_container_9_div_1_Template","tmp_0_0","PlaceStaffAPIComponent","afterClosed","action","system","del","statusText","PlaceStaffAPIComponent_mat_option_6_Template","PlaceStaffAPIComponent_ng_container_9_Template","PlaceStaffAPIComponent_ng_template_10_Template","PlaceStaffAPIComponent_ng_template_12_Template","EdgeModalComponent","edge","new_edge","updateEdge","addEdge","EdgeModalComponent_button_4_Template","EdgeModalComponent_main_5_Template","EdgeModalComponent_footer_6_Template","EdgeModalComponent_ng_template_7_Template","item_r8","_r10","edit","ctx_r11","remove","PlaceEdgeComponent_ng_container_2_div_1_div_10_Template","edges","PlaceEdgeComponent_ng_container_2_div_1_Template","copyKey","x_api_key","PlaceEdgeComponent","last_change","_clipboard","_change","_hide","_edge_list","debounceTime","queryEdges","hide","token","retrieveEdgeToken","sessionStorage","setItem","_ref3","removeEdge","removeItem","_x3","edge_data","getItem","PlaceEdgeComponent_ng_container_2_Template","PlaceEdgeComponent_div_3_Template","PlaceEdgeComponent_ng_template_5_Template","PlaceEdgeComponent_ng_template_7_Template","tmp_2_0","schema_r5","schema_copy","saveSchema","schema","AdminSchemasComponent","_state","schema_list","schemas","copySchema","active_schema","newSchema","AdminSchemasComponent_mat_option_6_Template","preventDefault","AdminSchemasComponent_div_13_Template","AdminSchemasComponent_ng_container_15_Template","AdminSchemasComponent_ng_template_16_Template","getUnixTime","dirtyDate","requiredArgs","floor","getTime","toDate","PlaceAPIKeyDetails","user_id","authority_id","permissions","created_at","updated_at","secret","scope_r13","_r15","ctx_r14","removeScope","option_r16","addScope","input","item_r19","_r21","ctx_r20","setSearch","APIKeyModalComponent_main_4_mat_chip_23_Template","_r23","ctx_r22","APIKeyModalComponent_main_4_mat_option_29_Template","ctx_r24","focusInput","stopPropagation","ctx_r26","APIKeyModalComponent_main_4_button_44_Template","APIKeyModalComponent_main_4_button_47_Template","scope_list","_r5","separators","_c3","users","tmp_12_0","_r28","ctx_r27","APIKeyModalComponent","minLength","search_str","available_scopes","sys_admin","support","ENTER","COMMA","SPACE","setTimeout","_input_el","nativeElement","focus","s","addChipItem","removeChipItem","join","APIKeyModalComponent_button_3_Template","APIKeyModalComponent_main_4_Template","APIKeyModalComponent_footer_5_Template","APIKeyModalComponent_ng_template_6_Template","APIKeyService","_search","_domain","_last_key","last_key","asObservable","active_domain","available_domains","limit","available_keys","query","query_params","fn","path","q","queryUsers","newKey","Promise","race","create","form_data","removeKey","domain_r5","tmp_1_0","scope_r11","AdminAPIKeysComponent_div_14_div_14_code_6_Template","deleteKey","AdminAPIKeysComponent_div_14_div_14_Template","key_list","AdminAPIKeysComponent","take","AdminAPIKeysComponent_mat_option_7_Template","AdminAPIKeysComponent_div_12_Template","AdminAPIKeysComponent_div_14_Template","AdminAPIKeysComponent_ng_template_16_Template","tmp_4_0","PATH","PlaceStorage","assign","ext_r3","mime_r4","StorageProviderModalComponent","ALLOWED_FILE_EXTENSIONS","ALLOWED_MIME_TYPES","storage","storage_type","bucket_name","region","access_key","access_secret","endpoint","ext_filter","mime_filter","invalid","saveStorage","updateStorage","method","update","addStorage","StorageProviderModalComponent_mat_option_46_Template","StorageProviderModalComponent_mat_option_52_Template","StorageProviderModalComponent_footer_53_Template","StorageComponent_ng_container_11_div_1_div_12_Template","storage_list","StorageComponent_ng_container_11_div_1_Template","ROUTES","component","canActivate","AuthorisedAdminGuard","children","StorageComponent","storage_data","queryStorage","auth_id","domains","removeStorage","StorageComponent_mat_option_7_Template","StorageComponent_ng_container_11_Template","StorageComponent_ng_template_12_Template","StorageComponent_ng_template_14_Template","ExtensionOutletComponent","redirectTo","AppPlaceModule","oAB","cJS","imports","CommonModule","FormsModule","ReactiveFormsModule","RouterModule","forChild","SharedContentModule","period","scheduler","async","isNumeric","schedule","Observable","subscriber","add","dispatch","counter","state"],"sourceRoot":"webpack:///","sources":["./apps/backoffice/src/app/admin/admin.component.ts","./apps/backoffice/src/app/common/database.service.ts","./apps/backoffice/src/app/admin/database-details.component.ts","./apps/backoffice/src/app/admin/details.component.ts","./apps/backoffice/src/app/admin/cluster-details/cluster-node.component.ts","./apps/backoffice/src/app/admin/cluster-details/cluster-item.component.ts","./apps/backoffice/src/app/admin/cluster-details/cluster-task-list.component.ts","./apps/backoffice/src/app/admin/cluster-details/cluster-details.component.ts","./apps/backoffice/src/app/admin/interfaces.component.ts","./apps/backoffice/src/app/admin/brokers.component.ts","./apps/backoffice/src/app/admin/extension-modal/extension-modal.component.html","./apps/backoffice/src/app/admin/extension-modal/extension-modal.component.ts","./apps/backoffice/src/app/admin/extensions.component.ts","./apps/backoffice/src/app/admin/booking-limits-modal.component.ts","./apps/backoffice/src/app/admin/staff-tenant-modal.component.ts","./apps/backoffice/src/app/admin/staff-api.component.ts","./apps/backoffice/src/app/admin/edge-modal.component.ts","./apps/backoffice/src/app/admin/edge.component.ts","./apps/backoffice/src/app/admin/schemas.component.ts","./node_modules/date-fns/esm/getUnixTime/index.js","./node_modules/date-fns/esm/getTime/index.js","./apps/backoffice/src/app/admin/api-keys/api-key-details.class.ts","./apps/backoffice/src/app/admin/api-keys/api-key-modal.component.ts","./apps/backoffice/src/app/admin/api-keys/api-keys.service.ts","./apps/backoffice/src/app/admin/api-keys/api-keys.component.ts","./apps/backoffice/src/app/admin/storage/storage.fn.ts","./apps/backoffice/src/app/admin/storage/storage-provider-modal.component.ts","./apps/backoffice/src/app/admin/storage/storage.component.ts","./apps/backoffice/src/app/admin/admin.routes.ts","./apps/backoffice/src/app/admin/admin.module.ts","./node_modules/rxjs/_esm2015/internal/observable/interval.js"],"sourcesContent":["import { Component } from '@angular/core';\n\nimport { AsyncHandler } from 'apps/backoffice/src/app/common/async-handler.class';\nimport { extensionsForItem } from '../common/api';\nimport { PlaceDebugService } from '../common/debug.service';\nimport { ActiveItemService } from '../common/item.service';\nimport { SettingsService } from '../common/settings.service';\nimport { BackofficeUsersService } from '../users/users.service';\n\n@Component({\n    selector: 'app-engine',\n    template: `\n        <div\n            class=\"absolute inset-0 flex items-center divide-y sm:divide-y-0 sm:divide-x divide-base-200  bg-base-100 \"\n        >\n            <sidebar-menu [(open)]=\"open_menu\" class=\"sm:h-full\"></sidebar-menu>\n            <div class=\"flex flex-col h-full flex-1 overflow-hidden w-px\">\n                <div class=\"flex flex-1 z-0 h-1/2  \">\n                    <div\n                        class=\"h-full relative sm:w-56 px-2 my-4 border-r border-base-200 z-10 pt-10 sm:pt-0\"\n                    >\n                        <a\n                            *ngFor=\"let item of tab_list\"\n                            class=\"flex items-center space-x-2 m-2 rounded h-8 px-3 hover:bg-base-200\"\n                            [routerLink]=\"['/admin', item.id]\"\n                            routerLinkActive=\"active\"\n                        >\n                            <app-icon [icon]=\"item.icon\"></app-icon>\n                            <span class=\"hidden sm:block\">{{ item.name }}</span>\n                        </a>\n                    </div>\n                    <div\n                        class=\"relative flex-1 w-1/2 h-full z-0 px-4  overflow-auto\"\n                    >\n                        <router-outlet></router-outlet>\n                    </div>\n                    <button\n                        btn\n                        icon\n                        class=\"sm:hidden mr-2 absolute top-2 left-4 z-40\"\n                        (click)=\"open_menu = true\"\n                    >\n                        <app-icon className=\"backoffice-menu\"></app-icon>\n                    </button>\n                </div>\n                <app-debug-output\n                    below\n                    *ngIf=\"debug_position === 'below'\"\n                ></app-debug-output>\n            </div>\n            <app-debug-output\n                side\n                *ngIf=\"debug_position === 'side'\"\n                class=\"h-full max-w-[30rem]\"\n            ></app-debug-output>\n        </div>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                width: 100%;\n                height: 100%;\n            }\n\n            .active {\n                background-color: var(--s) !important;\n                color: var(--sc);\n                margin-right: -1px;\n            }\n        `,\n    ],\n})\nexport class PlaceComponent extends AsyncHandler {\n    public tab_list = [];\n    public open_menu = false;\n\n    public get extensions() {\n        return extensionsForItem(this._service.active_item, 'admin');\n    }\n\n    public get dark_mode() {\n        return this._users.dark_mode;\n    }\n\n    public get debug_position() {\n        return this._debug.position;\n    }\n\n    public updateTabList() {\n        this.tab_list = [\n            { id: 'about', name: 'About', icon: { class: 'backoffice-info' } },\n            {\n                id: 'database',\n                name: 'Database',\n                icon: { class: 'backoffice-database' },\n            },\n            {\n                id: 'clusters',\n                name: 'Clusters',\n                icon: { class: 'backoffice-server' },\n            },\n            { id: 'edge', name: 'Edges', icon: { class: 'backoffice-server' } },\n            {\n                id: 'interfaces',\n                name: 'Interfaces',\n                icon: { class: 'backoffice-browser' },\n            },\n            {\n                id: 'brokers',\n                name: 'MQTT Brokers',\n                icon: { class: 'backoffice-server' },\n            },\n            {\n                id: 'staff-api',\n                name: 'Staff API',\n                icon: { class: 'backoffice-gist' },\n            },\n            {\n                id: 'extensions',\n                name: 'Extensions',\n                icon: { class: 'backoffice-gist' },\n            },\n            {\n                id: 'api-keys',\n                name: 'API Keys',\n                icon: { class: 'backoffice-key' },\n            },\n            {\n                id: 'schemas',\n                name: 'Custom Schemas',\n                icon: { class: 'backoffice-list' },\n            },\n            {\n                id: 'upload-storage',\n                name: 'Upload Storage',\n                icon: { class: 'backoffice-upload' },\n            },\n        ].concat(this.extensions);\n    }\n\n    constructor(\n        private _settings: SettingsService,\n        private _service: ActiveItemService,\n        private _users: BackofficeUsersService,\n        private _debug: PlaceDebugService\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this._settings.title = 'Admin';\n        this.updateTabList();\n    }\n}\n","import { post, apiEndpoint } from '@placeos/ts-client';\nimport { Injectable } from '@angular/core';\n\nimport { AsyncHandler } from 'apps/backoffice/src/app/common/async-handler.class';\n\n@Injectable({\n    providedIn: 'root',\n})\nexport class PlaceDatabase extends AsyncHandler {\n    public reindex(backfill: boolean = true) {\n        const url = `${apiEndpoint()}/reindex${\n            backfill ? '?backfill=true' : ''\n        }`;\n        return post(url, null).toPromise();\n    }\n\n    public backfill() {\n        const url = `${apiEndpoint()}/backfill`;\n        return post(url, null).toPromise();\n    }\n}\n","import { Component } from '@angular/core';\n\nimport { PlaceDatabase } from 'apps/backoffice/src/app/common/database.service';\nimport { notifyError } from 'apps/backoffice/src/app/common/notifications';\n\n@Component({\n    selector: 'app-database-details',\n    template: `\n        <div class=\"flex w-full p-4 space-x-4\">\n            <div\n                class=\"rounded p-2 border border-base-200  space-y-2 w-1/3 flex-1 flex flex-col\"\n            >\n                <p class=\"text-center p-2\">\n                    Re-index elasticsearch for the<br />current state of the\n                    database\n                </p>\n                <button\n                    btn\n                    class=\"w-[calc(100%-0.5rem)]\"\n                    [disabled]=\"reindexing\"\n                    (click)=\"reindex()\"\n                >\n                    <ng-container *ngIf=\"!reindexing; else spinner\">\n                        Re-index\n                    </ng-container>\n                </button>\n            </div>\n            <div\n                class=\"rounded p-2 border border-base-200  space-y-2 w-1/3 flex-1 flex flex-col\"\n            >\n                <p class=\"text-center p-2\">\n                    Backfill elasticsearch with the<br />current state of the\n                    database\n                </p>\n                <button\n                    btn\n                    class=\"w-[calc(100%-0.5rem)]\"\n                    [disabled]=\"backfilling\"\n                    (click)=\"backfill()\"\n                >\n                    <ng-container *ngIf=\"!backfilling; else spinner\">\n                        Backfill\n                    </ng-container>\n                </button>\n            </div>\n        </div>\n        <ng-template #spinner>\n            <div class=\"flex justify-center w-full my-1\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                padding-top: 1em;\n                display: flex;\n                flex-wrap: wrap;\n            }\n\n            button {\n                min-width: 10em;\n                margin: 0.25em;\n            }\n\n            mat-card {\n                margin: 0.5em;\n                text-align: center;\n            }\n        `,\n    ],\n})\nexport class PlaceDatabaseDetailsComponent {\n    /** Whether backend is reindexing the database */\n    public reindexing: boolean;\n    /** Whether backend is reindexing the database */\n    public backfilling: boolean;\n\n    constructor(private _engine_service: PlaceDatabase) {}\n\n    public reindex() {\n        this.reindexing = true;\n        this._engine_service.reindex().then(\n            () => (this.reindexing = false),\n            (err) => {\n                this.reindexing = false;\n                notifyError(\n                    `Error reindexing database. Error: ${JSON.stringify(\n                        err.response || err.message || err\n                    )}`\n                );\n            }\n        );\n    }\n\n    public backfill() {\n        this.backfilling = true;\n        this._engine_service.backfill().then(\n            () => (this.backfilling = false),\n            (err) => {\n                this.backfilling = false;\n                notifyError(\n                    `Error reindexing database. Error: ${JSON.stringify(\n                        err.response || err.message || err\n                    )}`\n                );\n            }\n        );\n    }\n}\n","import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { get, apiEndpoint } from '@placeos/ts-client';\n\nimport { VERSION } from '../../environments/version';\nimport { AsyncHandler } from 'apps/backoffice/src/app/common/async-handler.class';\nimport {\n    ChangelogModalComponent,\n    ChangelogModalData,\n} from 'apps/backoffice/src/app/overlays/changelog-modal/changelog-modal.component';\nimport { BackofficeUsersService } from 'apps/backoffice/src/app/users/users.service';\nimport {\n    notifyError,\n    notifyInfo,\n} from 'apps/backoffice/src/app/common/notifications';\n\nimport { copyToClipboard } from '../common/general';\nimport { format } from 'date-fns';\n\nexport interface PlaceServiceDetails {\n    /** Name of the service */\n    service: string;\n    /** Commit hash of the service */\n    commit: string;\n    /** Current version number of the service */\n    version: string;\n    /** Build time of the active version of the service */\n    build_time: string;\n    /** Version of the backend service platform */\n    platform_version: string;\n}\n\n@Component({\n    selector: 'app-engine-details',\n    template: `\n        <div class=\"flex items-center space-x-2\">\n            <h3 class=\"text-lg font-medium\" i18n=\"@@backoffice\">\n                Application Details (Backoffice)\n            </h3>\n            <button\n                *ngIf=\"backoffice_logs\"\n                class=\"p-2 text-xs underline\"\n                (click)=\"changelog(backoffice_logs)\"\n            >\n                View Changelog\n            </button>\n        </div>\n        <section class=\"space-y-2 mb-4 flex flex-col px-2\">\n            <div class=\"flex items-center\">\n                <label for=\"version\" class=\"w-24\" i18n=\"@@version\"\n                    >Version:</label\n                >\n                <code\n                    name=\"version\"\n                    (click)=\"copy('version', backoffice_version)\"\n                >\n                    {{ backoffice_version }}\n                </code>\n                <code\n                    name=\"tag\"\n                    class=\"ml-2\"\n                    (click)=\"copy('tag', backoffice_tag)\"\n                >\n                    {{ backoffice_tag }}\n                </code>\n            </div>\n            <div class=\"flex items-center\">\n                <label for=\"hash\" class=\"w-24\" i18n=\"@@commitHash\"\n                    >Commit Hash:</label\n                >\n                <code name=\"hash\" (click)=\"copy('hash', backoffice_hash)\">\n                    {{ backoffice_hash }}\n                </code>\n            </div>\n            <div class=\"flex items-center\">\n                <label for=\"build-time\" class=\"w-24\" i18n=\"@@buildTime\"\n                    >Build:</label\n                >\n                <div\n                    name=\"build-time\"\n                    class=\"text-sm\"\n                    (click)=\"copy('build time', backoffice_build)\"\n                >\n                    {{ backoffice_build }}\n                </div>\n            </div>\n        </section>\n        <div class=\"flex items-center space-x-2\">\n            <div class=\"text-lg font-medium\" i18n=\"@@apiHeader\">\n                API Services\n            </div>\n            <code *ngIf=\"backend_version\">{{ backend_version }}</code>\n            <button\n                *ngIf=\"changelog_data\"\n                class=\"p-2 text-xs underline\"\n                (click)=\"changelog(changelog_data)\"\n            >\n                View Changelog\n            </button>\n        </div>\n        <section class=\"flex flex-wrap py-2\">\n            <ng-container *ngIf=\"api_details.length > 0; else empty_state\">\n                <div\n                    class=\"bg-base-100  rounded border border-base-200  m-2 min-w-[40%] flex-1 overflow-hidden\"\n                    *ngFor=\"let api of api_details\"\n                >\n                    <h3\n                        class=\"w-full px-4 py-2 mb-1 border-b border-base-200  mono\"\n                    >\n                        {{ api.service }}\n                    </h3>\n                    <div\n                        class=\"flex items-center px-4 py-1 hover:bg-base-200/20\"\n                    >\n                        <label class=\"w-24\">Commit Hash</label>\n                        <code>\n                            {{ api.commit | slice: 0:8 }}\n                        </code>\n                    </div>\n                    <div\n                        class=\"flex items-center px-4 py-1 hover:bg-base-200/20\"\n                    >\n                        <label class=\"w-24\">Version</label>\n                        <code>\n                            {{ api.version }}\n                        </code>\n                    </div>\n                    <div\n                        class=\"flex items-center px-4 py-1 hover:bg-base-200/20\"\n                    >\n                        <label class=\"w-24\">Build time</label>\n                        <div class=\"text-sm\">\n                            {{ api.build_time | date: 'MMM d, y, h:mm a' }}\n                        </div>\n                    </div>\n                    <div\n                        class=\"flex items-center px-4 py-1 hover:bg-base-200/20 mb-1\"\n                    >\n                        <label class=\"w-24\">Platform</label>\n                        <code>\n                            {{ api.platform_version }}\n                        </code>\n                    </div>\n                </div>\n            </ng-container>\n        </section>\n        <ng-template #empty_state>\n            <div class=\"w-full p-24 flex flex-col items-center justify-center\">\n                <div class=\"p-4 border rounded-lg bg-base-200  opacity-60\">\n                    No API service details available.\n                </div>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                position: absolute;\n                top: 0;\n                left: 0;\n                padding: 1rem;\n                width: 100%;\n                height: 100%;\n                overflow: auto;\n            }\n        `,\n    ],\n})\nexport class PlaceDetailsComponent extends AsyncHandler implements OnInit {\n    /** Current details about the API */\n    public api_details: PlaceServiceDetails[] = [];\n    public changelog_data: string = '';\n    public backend_version = '';\n    public backoffice_logs = '';\n\n    public get user() {\n        return this._users.user;\n    }\n\n    public get backoffice_version() {\n        return VERSION?.stamp || '';\n    }\n\n    public get backoffice_tag() {\n        return VERSION?.tag || '';\n    }\n\n    public get backoffice_hash() {\n        return VERSION?.hash || '';\n    }\n\n    public get backoffice_build() {\n        return `${format(VERSION.time, 'dd MMM yyyy')} at ${format(\n            VERSION.time,\n            ' h:mma'\n        )}`;\n    }\n\n    constructor(\n        private _users: BackofficeUsersService,\n        private _dialog: MatDialog,\n        private _cdr: ChangeDetectorRef\n    ) {\n        super();\n    }\n\n    public ngOnInit(): void {\n        this.loadApiDetails();\n        this.loadPlatformDetails();\n    }\n\n    public changelog(log: string) {\n        this._dialog.open<ChangelogModalComponent, ChangelogModalData>(\n            ChangelogModalComponent,\n            {\n                data: { changelog: log },\n            }\n        );\n    }\n\n    public copy(name: string, content: string) {\n        copyToClipboard(content);\n        notifyInfo(`Copied ${name} to clipboard`);\n    }\n\n    public async loadApiDetails() {\n        const details = await get(`${apiEndpoint()}/cluster/versions`)\n            .toPromise()\n            .catch((err) =>\n                notifyError(\n                    `Error loading API details. Error: ${JSON.stringify(\n                        err.response || err.message || err\n                    )}`\n                )\n            );\n        this.api_details = (details as any) || [];\n        this._cdr.detectChanges();\n    }\n\n    public async loadPlatformDetails() {\n        const { changelog, version } = await get(`${apiEndpoint()}/platform`)\n            .toPromise()\n            .catch((err) => {\n                notifyError(\n                    `Error loading API details. Error: ${JSON.stringify(\n                        err.response || err.message || err\n                    )}`\n                );\n                throw err;\n            });\n        this.changelog_data = changelog.replace('# Changelog\\n\\n', '');\n        this.backend_version = version;\n        this.backoffice_logs = await (\n            await fetch(\n                'https://raw.githubusercontent.com/PlaceOS/backoffice/develop/CHANGELOG.md'\n            )\n        ).text();\n    }\n}\n","import {\n    Component,\n    ElementRef,\n    Input,\n    OnChanges,\n    OnInit,\n    SimpleChanges,\n    ViewChild,\n} from '@angular/core';\nimport { humanReadableByteCount } from '@placeos/ts-client';\n\nimport { differenceInSeconds } from 'date-fns';\nimport { Point } from '../../common/types';\n\ninterface PlaceClusterRunCounts {\n    modules: number;\n    drivers: number;\n}\n\nexport interface PlaceClusterNode {\n    hostname: string;\n    cpu_count: number;\n    core_cpu: number;\n    total_cpu: number;\n    memory_total: number;\n    memory_usage: number;\n    core_memory: number;\n    run_count?: PlaceClusterRunCounts;\n}\n\nexport interface PlaceClusterUsageStamp {\n    id: number;\n    value: number;\n}\n\n@Component({\n    selector: 'admin-cluster-node',\n    template: `\n        <h4>{{ node?.hostname }}</h4>\n        <div class=\"mb-2 h-40 w-64\">\n            <div basic-line-graph [points]=\"points\"></div>\n        </div>\n        <div class=\"memory-utilisation\">\n            <div\n                class=\"flex items-center justify-between space-x-2 p-2 text-left\"\n            >\n                <label i18n=\"@@cluserMemoryUsed\" class=\"w-28\">\n                    Memory Used\n                </label>\n                <div class=\"value flex-1 text-right flex space-x-2\">\n                    <code>{{ used_memory }} / {{ total_memory }}</code>\n                    <code> {{ memory_percentage.toFixed(2) }}% </code>\n                </div>\n            </div>\n            <div\n                class=\"flex items-center justify-between space-x-2 bg-base-200 rounded p-2 text-left\"\n            >\n                <label i18n=\"@@clusterCpuUsage\" class=\"w-28\">CPU Usage</label>\n                <code> {{ node?.total_cpu }}% </code>\n            </div>\n        </div>\n    `,\n    styles: [],\n})\nexport class AdminClusterNodeComponent implements OnChanges, OnInit {\n    /** Node to display on the view */\n    @Input() public node: PlaceClusterNode;\n    /** Historical data for node */\n    @Input() public history: PlaceClusterUsageStamp[];\n    /** Store for the chart data object */\n    // private _chart: Chart;\n    /**  */\n    public points: Point[] = [];\n\n    public get used_memory() {\n        return humanReadableByteCount((this.node?.memory_usage || 0) * 1024);\n    }\n\n    public get total_memory() {\n        return humanReadableByteCount((this.node?.memory_total || 0) * 1024);\n    }\n\n    public get memory_percentage() {\n        return (\n            ((this.node?.memory_usage || 0) / (this.node?.memory_total || 1)) *\n            100\n        );\n    }\n\n    @ViewChild('chart', { static: true })\n    public _chart_el: ElementRef<HTMLCanvasElement>;\n\n    public ngOnInit() {\n        this.generateCharts();\n    }\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (changes.history && this.history) {\n            this.generateCharts();\n        }\n    }\n\n    public generateCharts(): void {\n        const list = [...this.history] || [];\n        while (list.length < 12) {\n            list.unshift({} as any);\n        }\n        const data = list\n            .slice(Math.max(0, list.length - 12))\n            .map((event, idx) => ({\n                x: idx,\n                y: event.value || 0,\n            }));\n        this.points = [...data];\n    }\n}\n","import {\n    Component,\n    OnInit,\n    Input,\n    OnChanges,\n    SimpleChanges,\n} from '@angular/core';\nimport { PlaceCluster } from '@placeos/ts-client';\nimport { HashMap } from 'apps/backoffice/src/app/common/types';\nimport {\n    PlaceClusterNode,\n    PlaceClusterUsageStamp,\n} from './cluster-node.component';\n\n@Component({\n    selector: 'engine-cluster-item',\n    template: `\n        <ng-container *ngFor=\"let node of cluster_nodes\">\n            <admin-cluster-node\n                [node]=\"node\"\n                [history]=\"cpu_history[node.hostname] || []\"\n            ></admin-cluster-node>\n        </ng-container>\n    `,\n    styles: [``],\n})\nexport class PlaceClusterItemComponent implements OnChanges {\n    /** Cluster to display details for */\n    @Input() public cluster: PlaceCluster;\n    /** List of historical data for cluster's CPU usage */\n    @Input() public cpu_history: HashMap<PlaceClusterUsageStamp[]> = {};\n    /** List of nodes contained by the cluster */\n    public cluster_nodes: PlaceClusterNode[];\n\n    public ngOnChanges(changes: SimpleChanges) {\n        if (changes.cluster && this.cluster) {\n            this.cluster_nodes = [this.cluster, ...this.cluster.edge_nodes];\n            this.cpu_history = this.cpu_history || {};\n        }\n    }\n}\n","import { Component, Input, Output, EventEmitter } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport {\n    PlaceCluster,\n    PlaceProcess,\n    terminateProcess,\n    queryProcesses,\n} from '@placeos/ts-client';\n\nimport { AsyncHandler } from 'apps/backoffice/src/app/common/async-handler.class';\nimport {\n    ConfirmModalComponent,\n    CONFIRM_METADATA,\n} from 'apps/backoffice/src/app/overlays/confirm-modal.component';\nimport { notifyError } from 'apps/backoffice/src/app/common/notifications';\nimport { BehaviorSubject, combineLatest, interval, Observable, of } from 'rxjs';\nimport {\n    catchError,\n    filter,\n    map,\n    shareReplay,\n    startWith,\n    switchMap,\n    tap,\n} from 'rxjs/operators';\n\n@Component({\n    selector: 'engine-cluster-task-list',\n    template: `\n        <div class=\"flex items-center mb-4\">\n            <button btn icon (click)=\"close.emit()\">\n                <app-icon\n                    [icon]=\"{ type: 'icon', class: 'backoffice-arrow-left' }\"\n                ></app-icon>\n            </button>\n            <h3 class=\"text-lg font-medium\" i18n=\"@@clusterHeader\">\n                Cluster - {{ cluster?.hostname }}\n            </h3>\n            <div class=\"flex-1\"></div>\n            <mat-form-field appearance=\"outline\" class=\"h-12\">\n                <app-icon\n                    matPrefix\n                    className=\"backoffice-magnifying-glass\"\n                ></app-icon>\n                <input\n                    matInput\n                    [ngModel]=\"filter.getValue()\"\n                    (ngModelChange)=\"filter.next($event)\"\n                    placeholder=\"Filter processes...\"\n                />\n            </mat-form-field>\n        </div>\n        <div\n            role=\"table\"\n            class=\"h-1/2 flex-1\"\n            *ngIf=\"(filtered_list | async)?.length; else empty_state\"\n        >\n            <div table-head>\n                <div class=\"flex-1 p-2\">Name</div>\n                <div class=\"w-24 p-2\">CPU %</div>\n                <div class=\"w-24 p-2\">Memory</div>\n                <div class=\"w-24 p-2\">Instances</div>\n                <div class=\"w-12 p-2\"></div>\n            </div>\n            <div table-body>\n                <div table-row *ngFor=\"let element of filtered_list | async\">\n                    <div class=\"flex-1 p-2\" [title]=\"element.id\">\n                        <code\n                            class=\"truncate\"\n                            [innerHTML]=\"element.id | driverFormat\"\n                        ></code>\n                    </div>\n                    <div class=\"w-24 p-2 text-right justify-end\">\n                        {{ element.cpu_usage.toFixed(2) }}%\n                    </div>\n                    <div class=\"w-24 p-2 text-right justify-end\">\n                        {{ element.used_memory }}\n                    </div>\n                    <div class=\"w-24 p-2 text-right justify-end\">\n                        {{ element.module_instances }}\n                    </div>\n                    <div class=\"w-12 flex items-center justify-center\">\n                        <button btn icon (click)=\"confirmKillProcess(element)\">\n                            <app-icon className=\"backoffice-trash\"></app-icon>\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <ng-template #empty_state>\n            <div class=\"flex flex-col items-center p-8\">\n                <p i18n=\"@@processTableEmpty\">No tasks running on cluster</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                display: flex;\n                flex-direction: column;\n                padding: 1rem;\n                height: 100%;\n                width: 100%;\n            }\n        `,\n    ],\n})\nexport class PlaceClusterTaskListComponent extends AsyncHandler {\n    /** Cluster to display tasks details for */\n    @Input() public cluster: PlaceCluster;\n    /** Emitter for close events */\n    @Output() public close = new EventEmitter<void>();\n    /** Whether the task list is updating */\n    public loading: boolean;\n    /** ID of the process being killed */\n    public killing: string;\n\n    public column_list: string[] = [\n        'id',\n        'cpu_usage',\n        'memory_usage',\n        'module_instances',\n        'running',\n    ];\n\n    public filter = new BehaviorSubject('');\n\n    private _poll = new BehaviorSubject(0);\n\n    public readonly process_list: Observable<PlaceProcess[]> = this._poll.pipe(\n        filter(() => !this.loading),\n        switchMap(() => {\n            this.loading = true;\n            return queryProcesses(this.cluster.id, {\n                include_status: true,\n            } as any).pipe(\n                catchError((_) => {\n                    console.error(_);\n                    return of([]);\n                })\n            );\n        }),\n        map((l) =>\n            (l || []).sort((a, b) => b.module_instances - a.module_instances)\n        ),\n        tap(() => (this.loading = false)),\n        shareReplay(1)\n    );\n\n    public readonly filtered_list = combineLatest([\n        this.filter,\n        this.process_list,\n    ]).pipe(\n        map(([filter, processes]) => {\n            return processes.filter((_) =>\n                _.id.toLowerCase().includes(filter.toLowerCase())\n            );\n        }),\n        shareReplay(1)\n    );\n\n    constructor(private _dialog: MatDialog) {\n        super();\n    }\n\n    public ngOnInit() {\n        this._poll.next(Date.now());\n        this.interval('poll', () => this._poll.next(Date.now()), 5000);\n    }\n\n    public confirmKillProcess(process: PlaceProcess): void {\n        const ref = this._dialog.open(ConfirmModalComponent, {\n            ...CONFIRM_METADATA,\n            data: {\n                title: `Kill process`,\n                content: `\n                    <p>Are you sure you want kill the process for \"${process.id}\"?</p>\n                    <p>The process will be terminated <strong>immediately</strong>.\n                    The process may be restarted after a short while.</p>\n                `,\n                icon: { type: 'icon', class: 'backoffice-trash' },\n            },\n        });\n        this.subscription(\n            'confirm_kill',\n            ref.componentInstance.event.subscribe((event) => {\n                if (event.reason === 'done') {\n                    this.killing = process.id;\n                    ref.componentInstance.loading = 'Processing request...';\n                    this.killProcess(process).then(\n                        () => {\n                            this.killing = null;\n                            ref.close();\n                        },\n                        (err) => {\n                            ref.componentInstance.loading = null;\n                            this.killing = null;\n                            notifyError(\n                                `Error killing process. Error: ${JSON.stringify(\n                                    err.response || err.message || err\n                                )}`\n                            );\n                            ref.close();\n                        }\n                    );\n                }\n            })\n        );\n    }\n\n    public killProcess(process: PlaceProcess) {\n        return terminateProcess(this.cluster.id, process.id).toPromise();\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport {\n    map,\n    catchError,\n    switchMap,\n    tap,\n    filter,\n    startWith,\n} from 'rxjs/operators';\n\nimport { PlaceCluster, queryClusters } from '@placeos/ts-client';\nimport { AsyncHandler } from 'apps/backoffice/src/app/common/async-handler.class';\nimport { HashMap } from 'apps/backoffice/src/app/common/types';\n\nimport { PlaceClusterUsageStamp } from './cluster-node.component';\nimport { interval } from 'rxjs';\n\n@Component({\n    selector: 'engine-cluster-details',\n    template: `\n        <div class=\"flex flex-wrap overflow-auto max-h-full\">\n            <ng-container\n                *ngIf=\"cluster_list && cluster_list.length; else empty_state\"\n            >\n                <ng-container *ngIf=\"!active_cluster; else process_state\">\n                    <ng-container *ngFor=\"let cluster of cluster_list\">\n                        <mat-card class=\"m-2 text-center\">\n                            <mat-card-header>\n                                <mat-card-title clas=\"capitalize\"\n                                    >{{\n                                        cluster.hostname || 'Undefined Cluster'\n                                    }}\n                                </mat-card-title>\n                            </mat-card-header>\n                            <mat-card-content>\n                                <engine-cluster-item\n                                    [cluster]=\"cluster\"\n                                    [cpu_history]=\"\n                                        cpu_history[cluster.id] || []\n                                    \"\n                                ></engine-cluster-item>\n                            </mat-card-content>\n                            <mat-card-actions>\n                                <button\n                                    btn\n                                    matRipple\n                                    (click)=\"active_cluster = cluster\"\n                                    i18n=\"@@viewClusterProcesses\"\n                                    class=\"mx-2\"\n                                >\n                                    View Processes\n                                </button>\n                            </mat-card-actions>\n                        </mat-card>\n                    </ng-container>\n                </ng-container>\n            </ng-container>\n        </div>\n        <ng-template #empty_state>\n            <div\n                class=\"absolute inset-0 flex flex-col items-center p-8 space-y-2\"\n            >\n                <app-icon class=\"text-3xl\">close</app-icon>\n                <div class=\"text\" i18n=\"@@clusterListEmpty\">\n                    No Cluster details to show\n                </div>\n            </div>\n        </ng-template>\n        <ng-template #process_state>\n            <engine-cluster-task-list\n                [cluster]=\"active_cluster\"\n                (close)=\"active_cluster = null\"\n            ></engine-cluster-task-list>\n        </ng-template>\n    `,\n    styles: [``],\n})\nexport class PlaceClusterDetailsComponent\n    extends AsyncHandler\n    implements OnInit\n{\n    /** List of available clusters on this instance of engine */\n    public cluster_list: PlaceCluster[] = [];\n    /** Map of clusters to CPU usage history */\n    public cpu_history: HashMap<HashMap<PlaceClusterUsageStamp[]>> = {};\n    /** Active cluster to show details for */\n    public active_cluster: PlaceCluster;\n    /** Whether cluster details are being loaded */\n    public loading: boolean;\n\n    public readonly clusters$ = interval(2000).pipe(\n        startWith(0),\n        filter(() => !this.active_cluster && !this.loading),\n        switchMap(() => {\n            this.loading = true;\n            return queryClusters({ include_status: true } as any).pipe(\n                catchError((_) => ({ data: [] } as any))\n            );\n        }),\n        map((resp: { data: any[] }) => resp.data),\n        map((list) => {\n            this.cluster_list = list || [];\n            const date = Date.now();\n            this.cluster_list.forEach((cluster) => {\n                if (!this.cpu_history[cluster.id]) {\n                    this.cpu_history[cluster.id] = {};\n                }\n                const nodes = [cluster, ...cluster.edge_nodes] as any;\n                for (const node of nodes) {\n                    if (!this.cpu_history[cluster.id][node.hostname]) {\n                        this.cpu_history[cluster.id][node.hostname] = [];\n                    }\n                    this.cpu_history[cluster.id][node.hostname].push({\n                        id: date,\n                        value: node.core_cpu,\n                    });\n                    if (\n                        this.cpu_history[cluster.id][node.hostname].length > 120\n                    ) {\n                        this.cpu_history[cluster.id][node.hostname].shift();\n                    }\n                }\n            });\n        }),\n        tap(() => (this.loading = false))\n    );\n\n    public ngOnInit(): void {\n        this.subscription('load_cluster', this.clusters$.subscribe());\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { listInterfaceRepositories } from '@placeos/ts-client';\n\nimport { Identity } from 'apps/backoffice/src/app/common/types';\n\n@Component({\n    selector: 'app-interfaces',\n    template: `\n        <div\n            role=\"table\"\n            class=\"pt-4\"\n            *ngIf=\"interfaces && interfaces.length; else load_state\"\n        >\n            <div table-head>\n                <div class=\"flex-1 p-2\">Repository</div>\n                <div class=\"w-[20rem] p-2\">Commit Hash</div>\n            </div>\n            <div table-body>\n                <div table-row *ngFor=\"let item of interfaces\">\n                    <div class=\"flex-1 p-2\">{{ item.id }}</div>\n                    <div class=\"w-[20rem] p-2\">\n                        <code>\n                            {{ item.name || '~No Commit Hash~' }}\n                        </code>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <ng-template #load_state>\n            <div class=\"flex flex-col items-center p-8\">\n                <app-icon class=\"mb-4\" className=\"backoffice-cross\"></app-icon>\n                <p>No interfaces</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                width: 100%;\n                height: 100%;\n            }\n        `,\n    ],\n})\nexport class AdminInterfacesComponent implements OnInit {\n    /** List of interfaces */\n    public interfaces: Identity[] = [];\n\n    ngOnInit() {\n        this.loadInterfaces();\n    }\n\n    private async loadInterfaces() {\n        const interfaces = await listInterfaceRepositories().toPromise();\n        this.interfaces = Object.keys(interfaces).map((id) => ({\n            id,\n            name: interfaces[id],\n        }));\n        this.interfaces.sort((a, b) => `${a.id}`?.localeCompare(`${b.id}`));\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\n\nimport {\n    PlaceMQTTBroker,\n    updateBroker,\n    addBroker,\n    queryBrokers,\n    removeBroker,\n} from '@placeos/ts-client';\nimport { map } from 'rxjs/operators';\n\nimport { ItemCreateUpdateModalComponent } from 'apps/backoffice/src/app/overlays/item-modal/item-modal.component';\nimport { AsyncHandler } from 'apps/backoffice/src/app/common/async-handler.class';\nimport {\n    notifySuccess,\n    notifyError,\n} from 'apps/backoffice/src/app/common/notifications';\nimport { openConfirmModal } from 'apps/backoffice/src/app/common/general';\n\n@Component({\n    selector: 'app-brokers',\n    template: `\n        <button btn class=\"my-4\" (click)=\"newBroker()\">\n            <div class=\"flex items-center\">\n                <app-icon className=\"backoffice-plus\"></app-icon>\n                <div class=\"text\">Add Broker</div>\n            </div>\n        </button>\n        <div class=\"overflow-auto\">\n            <div\n                role=\"table\"\n                *ngIf=\"brokers && brokers.length; else load_state\"\n                class=\"min-w-[52rem]\"\n            >\n                <div table-head>\n                    <div class=\"w-32 p-2\">Name</div>\n                    <div class=\"w-24 p-2\">Auth Type</div>\n                    <div class=\"flex-1 p-2\">Description</div>\n                    <div class=\"w-32 p-2 truncate\">Host</div>\n                    <div class=\"w-16 p-2\">Port</div>\n                    <div class=\"w-16 p-2\">TLS</div>\n                    <div class=\"w-32 p-2\">Filters</div>\n                    <div class=\"w-24 p-2\"></div>\n                </div>\n                <div table-body>\n                    <div table-row *ngFor=\"let item of brokers\">\n                        <div class=\"w-32 p-2\">{{ item.name }}</div>\n                        <div class=\"w-24 p-2\">\n                            { item.auth_type, select, 0 { Certificate }, 2 {\n                            User Password }, other { No Auth }}\n                        </div>\n                        <div class=\"flex-1 p-2\">{{ item.description }}</div>\n                        <div class=\"w-32 p-2 truncate\">{{ item.host }}</div>\n                        <div class=\"w-16 p-2\">{{ item.port }}</div>\n                        <div class=\"w-16 p-2\">\n                            { item.tls, select, true { Yes }, false { No } }\n                        </div>\n                        <div class=\"w-32 p-2\">{{ item.filters | json }}</div>\n                        <div class=\"w-24 p-2 flex items-center\">\n                            <button btn icon (click)=\"editBroker(item)\">\n                                <app-icon\n                                    [icon]=\"{ class: 'backoffice-edit' }\"\n                                ></app-icon>\n                            </button>\n                            <button btn icon (click)=\"deleteBroker(item)\">\n                                <app-icon\n                                    [icon]=\"{ class: 'backoffice-trash' }\"\n                                ></app-icon>\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <ng-template #load_state>\n            <div class=\"flex flex-col items-center\">\n                <p>No Brokers</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n            }\n        `,\n    ],\n})\nexport class AdminBrokersComponent extends AsyncHandler implements OnInit {\n    public brokers: PlaceMQTTBroker[] = [];\n\n    constructor(private _dialog: MatDialog) {\n        super();\n    }\n\n    public ngOnInit() {\n        this.loadBrokers();\n    }\n\n    public newBroker(): void {\n        const ref = this._dialog.open(ItemCreateUpdateModalComponent, {\n            height: 'auto',\n            width: 'auto',\n            maxHeight: 'calc(100vh - 2em)',\n            maxWidth: 'calc(100vw - 2em)',\n            data: {\n                item: new PlaceMQTTBroker(),\n                name: 'Broker',\n                save: (item) => addBroker(item),\n            },\n        });\n        this.subscription(\n            'modal_events',\n            ref.componentInstance.event.subscribe((event) => {\n                if (event.reason === 'done') {\n                    this.loadBrokers();\n                }\n            })\n        );\n    }\n\n    public editBroker(item: PlaceMQTTBroker): void {\n        const ref = this._dialog.open(ItemCreateUpdateModalComponent, {\n            height: 'auto',\n            width: 'auto',\n            maxHeight: 'calc(100vh - 2em)',\n            maxWidth: 'calc(100vw - 2em)',\n            data: {\n                item,\n                name: 'Broker',\n                save: (item) => updateBroker(item.id, item),\n            },\n        });\n        this.subscription(\n            'modal_events',\n            ref.componentInstance.event.subscribe((event) => {\n                if (event.reason === 'done') {\n                    this.loadBrokers();\n                }\n            })\n        );\n    }\n\n    public async deleteBroker(item: PlaceMQTTBroker): Promise<void> {\n        if (item) {\n            const details = await openConfirmModal(\n                {\n                    title: `Delete MQTT Broker`,\n                    content: `<p>Are you sure you want delete this boker?</p><p>The broker will be deleted <strong>immediately.</strong></p>`,\n                    icon: { type: 'icon', class: 'backoffice-trash' },\n                },\n                this._dialog\n            );\n            if (!details) return;\n            details.loading('Deleting broker...');\n            const err = await removeBroker(item.id)\n                .toPromise()\n                .catch((_) => _);\n            details.close();\n            if (err)\n                return notifyError(\n                    `Error deleting broker. Error: ${JSON.stringify(\n                        err.response || err.message || err\n                    )}`\n                );\n            notifySuccess(`Successfully deleted broker \"${item.name}\".`);\n            this.loadBrokers();\n        }\n    }\n\n    private async loadBrokers() {\n        const brokers = await queryBrokers()\n            .pipe(map((resp) => resp.data))\n            .toPromise();\n        this.brokers = brokers;\n    }\n}\n","<header>\n    <h3>{{ item ? 'Edit' : 'New' }} Extension</h3>\n    <button btn icon mat-dialog-close *ngIf=\"!loading\">\n        <app-icon\n            [icon]=\"{ type: 'icon', class: 'backoffice-cross' }\"\n        ></app-icon>\n    </button>\n</header>\n<main\n    class=\"max-h-[65vh] overflow-auto p-4\"\n    *ngIf=\"!loading; else load_state\"\n    [formGroup]=\"form\"\n>\n    <div class=\"fieldset\">\n        <div class=\"field\">\n            <label for=\"type\" i18n=\"@@typeLabel\">Type<span>*</span>: </label>\n            <mat-form-field appearance=\"outline\">\n                <mat-select formControlName=\"type\">\n                    <mat-option\n                        *ngFor=\"let type of available_types\"\n                        [value]=\"type\"\n                    >\n                        <span class=\"capitalize\">{{ type }}</span>\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n        </div>\n        <div class=\"field\">\n            <label for=\"name\" i18n=\"@@nameLabel\">Name<span>*</span>: </label>\n            <mat-form-field appearance=\"outline\">\n                <input\n                    matInput\n                    name=\"name\"\n                    placeholder=\"Extension Display Name\"\n                    i18n-placeholder=\"@@extensionNamePlaceholder\"\n                    formControlName=\"name\"\n                />\n                <mat-error i18n=\"@@nameError\"\n                    >A valid name is required</mat-error\n                >\n            </mat-form-field>\n        </div>\n    </div>\n    <div class=\"field\">\n        <label for=\"url\" i18n=\"@@urlLabel\">URL<span>*</span>: </label>\n        <mat-form-field appearance=\"outline\">\n            <input\n                matInput\n                name=\"url\"\n                placeholder=\"Extension URL\"\n                i18n-placeholder=\"@@extensionUrlPlaceholder\"\n                formControlName=\"url\"\n            />\n            <mat-error i18n=\"@@urlError\">A valid URL is required</mat-error>\n        </mat-form-field>\n    </div>\n    <div class=\"w-full\">\n        <label *ngIf=\"form.controls.conditions.value?.length\">Conditions</label>\n        <div\n            class=\"fieldset\"\n            *ngFor=\"let condition of form.controls.conditions.value\"\n        >\n            <div class=\"field\">\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"url\"\n                        [(ngModel)]=\"condition[0]\"\n                        [ngModelOptions]=\"{ standalone: true }\"\n                        placeholder=\"Condition Field\"\n                        i18n-placeholder=\"@@conditionPlaceholder\"\n                    />\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <mat-form-field appearance=\"outline\">\n                    <mat-select\n                        [(ngModel)]=\"condition[1]\"\n                        [ngModelOptions]=\"{ standalone: true }\"\n                        placeholder=\"Operation\"\n                    >\n                        <mat-option\n                            *ngFor=\"let type of condition_ops\"\n                            [value]=\"type\"\n                        >\n                            <span class=\"capitalize\">{{ type }}</span>\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n            <div class=\"field\">\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"value\"\n                        [disabled]=\"\n                            condition[1] === 'truthy' ||\n                            condition[1] === 'falsy'\n                        \"\n                        [(ngModel)]=\"condition[2]\"\n                        [ngModelOptions]=\"{ standalone: true }\"\n                        placeholder=\"Condition Value\"\n                        i18n-placeholder=\"@@conditionValuePlaceholder\"\n                    />\n                </mat-form-field>\n            </div>\n            <button btn icon (click)=\"removeCondition(condition)\">\n                <app-icon [icon]=\"{ class: 'backoffice-cross' }\"></app-icon>\n            </button>\n        </div>\n        <button btn class=\"w-full\" (click)=\"addCondition()\">\n            Add Condition\n        </button>\n    </div>\n</main>\n<footer\n    class=\"border-t border-base-200 flex items-center justify-end space-x-2 p-4\"\n    *ngIf=\"!loading\"\n>\n    <button btn class=\"w-32 inverse\" mat-dialog-close>Cancel</button>\n    <button btn class=\"w-32\" type=\"submit\" (click)=\"submit()\">\n        {{ item ? 'Save' : 'Add' }} [S]\n    </button>\n</footer>\n<ng-template #load_state>\n    <div class=\"body\">\n        <div class=\"info-block\">\n            <div class=\"icon\">\n                <mat-spinner diameter=\"32\"></mat-spinner>\n            </div>\n            <div class=\"text\">Processing request...</div>\n        </div>\n    </div>\n</ng-template>\n","import { Component, EventEmitter, Inject, OnInit, Output } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { AsyncHandler } from 'apps/backoffice/src/app/common/async-handler.class';\nimport { HotkeysService } from 'apps/backoffice/src/app/common/hotkeys.service';\nimport { DialogEvent } from 'apps/backoffice/src/app/common/types';\n\nimport { BackofficeExtension } from '../extensions.component';\n\n@Component({\n    selector: 'extension-modal',\n    templateUrl: './extension-modal.component.html',\n    styleUrls: ['./extension-modal.component.scss'],\n})\nexport class ExtensionModalComponent extends AsyncHandler implements OnInit {\n    /** Emitter for user action on the modal */\n    @Output() public event = new EventEmitter<DialogEvent>();\n\n    public readonly available_types = [\n        'admin',\n        'systems',\n        'modules',\n        'zones',\n        'drivers',\n        'repositories',\n        'triggers',\n        'users',\n        'domains',\n    ];\n    public readonly condition_ops = ['includes', 'equals', 'truthy', 'falsy'];\n    public readonly item = this._data.item;\n    public loading = false;\n    public form = new FormGroup({\n        type: new FormControl('systems', [Validators.required]),\n        name: new FormControl('', [Validators.required]),\n        url: new FormControl('', [Validators.required]),\n        conditions: new FormControl([]),\n    });\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA) private _data: { item: BackofficeExtension },\n        private _hotkey: HotkeysService\n    ) {\n        super();\n    }\n\n    public ngOnInit() {\n        this.subscription(\n            'save',\n            this._hotkey.listen(['KeyS'], () => this.submit())\n        );\n        this.form.patchValue(this.item);\n    }\n\n    public addCondition() {\n        const conditions = this.form.controls.conditions.value;\n        conditions.push(['', '', '']);\n    }\n\n    public removeCondition(condition: [string, string, any]) {\n        this.form.controls.conditions.setValue(\n            this.form.controls.conditions.value.filter((c) => c !== condition)\n        );\n    }\n\n    public submit() {\n        this.form.markAllAsTouched();\n        if (!this.form.valid) {\n            return;\n        }\n        const value = this.form.value;\n        value.conditions = value.conditions.filter((c) => c[0] && c[1]);\n        this.event.emit({ reason: 'done', metadata: value });\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport {\n    PlaceDomain,\n    authority,\n    queryDomains,\n    updateDomain,\n} from '@placeos/ts-client';\nimport { first, map } from 'rxjs/operators';\nimport { notifyError } from 'apps/backoffice/src/app/common/notifications';\nimport { ApplicationIcon } from 'apps/backoffice/src/app/common/types';\nimport {\n    ConfirmModalComponent,\n    ConfirmModalData,\n} from 'apps/backoffice/src/app/overlays/confirm-modal.component';\nimport { ExtensionModalComponent } from './extension-modal/extension-modal.component';\n\nexport interface BackofficeExtension {\n    /** Section of backoffice to extend */\n    type:\n        | 'admin'\n        | 'systems'\n        | 'modules'\n        | 'zones'\n        | 'drivers'\n        | 'repositories'\n        | 'triggers'\n        | 'users'\n        | 'domains';\n    /** Display name of the extension */\n    name: string;\n    /** URL to the application to embed */\n    url: string;\n    /** Conditions for showing the extension */\n    conditions: [string, string, any][];\n    /** Icon to display next to the name */\n    icon: ApplicationIcon;\n}\n\n@Component({\n    selector: '[app-extensions]',\n    template: `\n        <h2 class=\"text-lg font-medium mb-4 mt-4\">Backoffice extensions</h2>\n        <div *ngIf=\"!loading; else load_state\">\n            <div class=\"flex items-center space-x-2 mb-4\">\n                <label for=\"type\">Domain: </label>\n                <mat-form-field appearance=\"outline\" class=\"h-12\">\n                    <mat-select\n                        name=\"type\"\n                        [(ngModel)]=\"domain\"\n                        (ngModelChange)=\"setDomain($event)\"\n                        placeholder=\"Select Domain...\"\n                    >\n                        <mat-option\n                            *ngFor=\"let domain of domain_list\"\n                            [value]=\"domain\"\n                        >\n                            {{ domain.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n                <button btn (click)=\"editExtension()\">Add Extension</button>\n            </div>\n            <div\n                class=\"bg-info my-4 p-4 flex items-center rounded shadow space-x-4 text-sm text-info-content\"\n            >\n                <p>\n                    <strong>Note:</strong> Backoffice requires a full page\n                    refresh for extension changes and additions to apply\n                </p>\n            </div>\n            <div role=\"table\" *ngIf=\"extension_list.length; else empty_state\">\n                <div table-head>\n                    <div class=\"w-24 p-2\">Type</div>\n                    <div class=\"w-40 p-2\">Name</div>\n                    <div class=\"flex-1 p-2\">URL</div>\n                    <div class=\"w-28 p-2\">Conditions</div>\n                    <div class=\"w-24 p-2\"></div>\n                </div>\n                <div table-body>\n                    <div table-row *ngFor=\"let extension of extension_list\">\n                        <div class=\"w-24 p-2 capitalize\">\n                            {{ extension.type }}\n                        </div>\n                        <div class=\"w-40 p-2\">{{ extension.name }}</div>\n                        <div class=\"flex-1 p-2\">{{ extension.url }}</div>\n                        <div class=\"w-28 p-2\">\n                            {{ extension.conditions.length }}\n                        </div>\n                        <div class=\"w-24 flex items-center justify-center\">\n                            <button btn icon (click)=\"editExtension(extension)\">\n                                <app-icon\n                                    [icon]=\"{ class: 'backoffice-edit' }\"\n                                ></app-icon>\n                            </button>\n                            <button\n                                btn\n                                icon\n                                (click)=\"removeExtension(extension)\"\n                            >\n                                <app-icon\n                                    [icon]=\"{ class: 'backoffice-trash' }\"\n                                ></app-icon>\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <ng-template #load_state>\n            <div class=\"info-block\">\n                <div class=\"icon\">\n                    <mat-spinner [diameter]=\"32\"></mat-spinner>\n                </div>\n                <div class=\"text\">{{ loading }}</div>\n            </div>\n        </ng-template>\n        <ng-template #empty_state>\n            <div class=\"info-block\">\n                <app-icon class=\"text-3xl\">close</app-icon>\n                <p>No extensions configured for this domain</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                width: 100%;\n                height: 100%;\n            }\n        `,\n    ],\n})\nexport class PlaceExtensionsComponent implements OnInit {\n    /** Loading state */\n    public loading: string = '';\n    /** List of available domains */\n    public domain_list: PlaceDomain[];\n    /** Currently active domain */\n    public domain: PlaceDomain;\n    /** List of extension available on the current domain */\n    public extension_list: BackofficeExtension[] = [];\n\n    constructor(private _dialog: MatDialog) {}\n\n    public async ngOnInit() {\n        this.loading = 'Loading domains...';\n        this.domain_list = await queryDomains()\n            .pipe(map((r) => r.data))\n            .toPromise();\n        const domain = authority();\n        if (!this.domain_list?.length) return;\n        const match = this.domain_list.find((d) => d.id === domain.id);\n        if (match) this.setDomain(match);\n        this.loading = '';\n    }\n\n    public setDomain(domain: PlaceDomain) {\n        this.domain = domain;\n        const config = this.domain.config?.backoffice?.extend || {};\n        const extensions: BackofficeExtension[] = [];\n        for (const type in config) {\n            if (!config[type]) {\n                continue;\n            }\n            for (const name in config[type]) {\n                if (!config[type][name]) {\n                    continue;\n                }\n                extensions.push({\n                    ...config[type][name],\n                    name,\n                    type,\n                });\n            }\n        }\n        this.extension_list = extensions;\n        this.extension_list.sort(\n            (a, b) =>\n                a.type.localeCompare(b.type) || a.name.localeCompare(b.name)\n        );\n    }\n\n    public editExtension(item?: BackofficeExtension) {\n        const ref = this._dialog.open(ExtensionModalComponent, {\n            data: { item: item ? JSON.parse(JSON.stringify(item)) : undefined },\n        });\n        ref.componentInstance.event\n            .pipe(first((_) => _.reason === 'done'))\n            .subscribe(async (event) => {\n                ref.componentInstance.loading = true;\n                if (item) {\n                    this.extension_list = this.extension_list.filter(\n                        (i) => i !== item\n                    );\n                }\n                this.extension_list.push(event.metadata);\n                await this.updateDomain();\n                ref.componentInstance.loading = false;\n                ref.close();\n            });\n    }\n\n    public async removeExtension(item: BackofficeExtension) {\n        const ref = this._dialog.open<ConfirmModalComponent, ConfirmModalData>(\n            ConfirmModalComponent,\n            {\n                data: {\n                    title: 'Remove extension',\n                    content: `Are you sure you want to remove the extension \"${item.name}\" from ${item.type}?`,\n                    icon: { class: 'backoffice-trash' },\n                },\n            }\n        );\n        ref.componentInstance.event\n            .pipe(first((_) => _.reason === 'done'))\n            .subscribe(async (_) => {\n                ref.componentInstance.loading = 'Removing extension...';\n                this.extension_list = this.extension_list.filter(\n                    (i) => i !== item\n                );\n                await this.updateDomain().catch((e) =>\n                    notifyError(`Error removing extension: ${e}`)\n                );\n                ref.componentInstance.loading = '';\n                ref.close();\n            });\n    }\n\n    public async updateDomain() {\n        const extensions = {};\n        for (const ext of this.extension_list) {\n            if (!extensions[ext.type]) {\n                extensions[ext.type] = {};\n            }\n            const data = { ...ext };\n            delete data.type;\n            delete data.name;\n            extensions[ext.type][ext.name] = data;\n        }\n        const updated = new PlaceDomain({\n            ...this.domain,\n            config: {\n                ...this.domain.config,\n                backoffice: {\n                    ...(this.domain.config.backoffice || {}),\n                    extend: extensions,\n                },\n            },\n        });\n        const domain = await updateDomain(this.domain.id, updated).toPromise();\n        this.setDomain(domain);\n    }\n}\n","import { Component, Inject } from '@angular/core';\nimport { FormControl, FormGroup } from '@angular/forms';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { post } from '@placeos/ts-client';\nimport { notifyError, notifySuccess } from '../common/notifications';\nimport { StaffTenantModalData } from './staff-tenant-modal.component';\n\n@Component({\n    selector: 'booking-limits-modal',\n    template: ` <header>\n            <h3>Edit Tenant Booking Limits</h3>\n            <div class=\"flex-1\"></div>\n            <button *ngIf=\"!loading\" btn icon mat-dialog-close>\n                <app-icon className=\"backoffice-cross\"></app-icon>\n            </button>\n        </header>\n        <main\n            [formGroup]=\"form\"\n            *ngIf=\"!loading; else load_state\"\n            class=\"overflow-auto w-[512px] max-w-[100vw]\"\n        >\n            <div class=\"flex flex-col\">\n                <object-list-field\n                    formControlName=\"booking_limits\"\n                    [fields]=\"['type', 'amount']\"\n                ></object-list-field>\n            </div>\n        </main>\n        <footer\n            *ngIf=\"!loading\"\n            class=\"p-2 border-t border-base-200 flex justify-center\"\n        >\n            <button btn class=\"w-32\" (click)=\"save()\">Save</button>\n        </footer>\n        <ng-template #load_state>\n            <main class=\"flex flex-col p-8 items-center justify-center\">\n                <mat-spinner class=\"mb-4\" [diameter]=\"48\"></mat-spinner>\n                <p>Saving booking limits for Staff API tenant...</p>\n            </main>\n        </ng-template>`,\n    styles: [``],\n})\nexport class BookingLimitsModalComponent {\n    public readonly tenant = this._data.tenant;\n    public readonly domain = this._data.domain;\n\n    public form = new FormGroup({\n        booking_limits: new FormControl<{ type: string; amount: string }[]>([]),\n    });\n\n    public loading = false;\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA) private _data: StaffTenantModalData,\n        private _dialog_ref: MatDialogRef<BookingLimitsModalComponent>\n    ) {\n        const limits = this.tenant?.booking_limits || {};\n        this.form.patchValue({\n            booking_limits: Object.keys(limits).map((k) => ({\n                type: k,\n                amount: `${limits[k]}`,\n            })),\n        });\n    }\n\n    public async save() {\n        this.form.markAllAsTouched();\n        if (!this.form.valid) return;\n        this._dialog_ref.disableClose = true;\n        this.loading = true;\n        const limits: { type: string; amount: string }[] =\n            this.form.value.booking_limits || [];\n        const booking_limits = {};\n        for (const { type, amount } of limits) {\n            booking_limits[type] = +amount || 0;\n        }\n        const call = post(\n            `/api/staff/v1/tenants/${this.tenant.id}/limits`,\n            booking_limits\n        );\n        const resp = await call.toPromise().catch((_) => null);\n        this.loading = false;\n        this._dialog_ref.disableClose = false;\n        if (!resp) return notifyError('Error adding new tenant.');\n        notifySuccess('Successfully added new tenant.');\n        this._dialog_ref.close({ ...this.tenant, booking_limits: resp });\n    }\n}\n","import { Component, EventEmitter, Inject, OnInit, Output } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { cleanObject, PlaceDomain, post, put } from '@placeos/ts-client';\nimport { getInvalidFields } from '../common/general';\nimport { notifyError, notifySuccess } from '../common/notifications';\nimport { DialogEvent, HashMap } from '../common/types';\nimport { PlaceTenant } from './staff-api.component';\n\nconst FIELD_NAME_MAPPING: HashMap<string> = {\n    issuer: 'Service Account Email',\n    conference_type: 'Conference Type',\n    signing_key: 'Private Key',\n    sub: 'Service User',\n    client_id: 'Client ID',\n    client_secret: 'Client Secret',\n    domain: 'Domain',\n    scopes: 'Scopes',\n    user_agent: 'User Agent',\n};\n\nexport interface StaffTenantModalData {\n    tenant?: PlaceTenant;\n    domain?: PlaceDomain;\n}\n\n@Component({\n    selector: 'staff-tenant-modal',\n    template: `\n        <header>\n            <h3>{{ tenant ? 'Edit' : 'New' }} Tenant</h3>\n            <div class=\"flex-1\"></div>\n            <button *ngIf=\"!loading\" btn icon mat-dialog-close>\n                <app-icon className=\"backoffice-cross\"></app-icon>\n            </button>\n        </header>\n        <main\n            [formGroup]=\"form\"\n            *ngIf=\"!loading; else load_state\"\n            class=\"overflow-auto p-4\"\n        >\n            <div class=\"flex items-center flex-wrap space-x-0 sm:space-x-2\">\n                <div class=\"flex flex-col flex-1\">\n                    <label>Name<span>*</span>:</label>\n                    <mat-form-field appearance=\"outline\">\n                        <input\n                            matInput\n                            formControlName=\"name\"\n                            placeholder=\"Tenant Name\"\n                        />\n                        <mat-error>A tenant name is required</mat-error>\n                    </mat-form-field>\n                </div>\n                <div class=\"flex flex-col flex-1\">\n                    <label>Platform<span>*</span>:</label>\n                    <mat-form-field appearance=\"outline\">\n                        <mat-select formControlName=\"platform\">\n                            <mat-option value=\"google\">Google</mat-option>\n                            <mat-option value=\"office365\">Office365</mat-option>\n                        </mat-select>\n                    </mat-form-field>\n                </div>\n            </div>\n            <div class=\"flex flex-col flex-1\">\n                <label>Email Domain:</label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        formControlName=\"email_domain\"\n                        placeholder=\"Domain of user's email for this tenant\"\n                    />\n                    <mat-error>A domain is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div\n                class=\"flex items-center flex-wrap space-x-0 sm:space-x-2\"\n                *ngIf=\"\n                    form.value.platform !== 'google' && !form.value.delegated\n                \"\n            >\n                <div class=\"flex flex-col flex-1\">\n                    <label>Service Account:</label>\n                    <mat-form-field appearance=\"outline\">\n                        <input\n                            matInput\n                            formControlName=\"service_account\"\n                            placeholder=\"Service Account\"\n                        />\n                        <mat-error>\n                            Service account should be a valid email address\n                        </mat-error>\n                    </mat-form-field>\n                </div>\n            </div>\n            <div class=\"flex items-center mb-4\">\n                <mat-checkbox formControlName=\"delegated\">\n                    Delegated\n                </mat-checkbox>\n            </div>\n            <form *ngIf=\"credentials\" [formGroup]=\"credentials\">\n                <ng-container\n                    *ngFor=\"let item of credentials.controls | keyvalue\"\n                >\n                    <div\n                        class=\"flex flex-col\"\n                        [class.hidden]=\"item.value?.disabled\"\n                    >\n                        <label class=\"capitalize\">\n                            {{ name_map[item.key] || item.key }}\n                            <span\n                                *ngIf=\"\n                                    item.key !== 'conference_type' &&\n                                    !form.value.id\n                                \"\n                                >*</span\n                            >:\n                        </label>\n                        <mat-form-field appearance=\"outline\">\n                            <ng-container [ngSwitch]=\"item.key\">\n                                <input\n                                    matInput\n                                    *ngSwitchDefault\n                                    [formControlName]=\"item.key\"\n                                    [placeholder]=\"\n                                        name_map[item.key] || item.key\n                                    \"\n                                />\n                                <textarea\n                                    matInput\n                                    *ngSwitchCase=\"'signing_key'\"\n                                    [formControlName]=\"item.key\"\n                                    [placeholder]=\"\n                                        name_map[item.key] || item.key\n                                    \"\n                                ></textarea>\n                            </ng-container>\n                            <mat-error>A {{ item.key }} is required</mat-error>\n                        </mat-form-field>\n                    </div>\n                </ng-container>\n            </form>\n            <div\n                class=\"flex items-center mb-4\"\n                *ngIf=\"form.value.platform === 'office365'\"\n            >\n                <mat-checkbox\n                    [(ngModel)]=\"show_outlook\"\n                    [ngModelOptions]=\"{ standalone: true }\"\n                >\n                    Configure Outlook Plugin\n                </mat-checkbox>\n            </div>\n            <form\n                *ngIf=\"show_outlook && form.get('outlook_config')\"\n                formGroupName=\"outlook_config\"\n            >\n                <div class=\"flex items-center flex-wrap space-x-0 sm:space-x-2\">\n                    <div class=\"flex flex-col flex-1\">\n                        <label>Outlook App ID<span>*</span>:</label>\n                        <mat-form-field appearance=\"outline\">\n                            <input\n                                matInput\n                                formControlName=\"app_id\"\n                                placeholder=\"Application ID\"\n                            />\n                            <mat-error>An application ID is required</mat-error>\n                        </mat-form-field>\n                    </div>\n                    <div class=\"flex flex-col flex-1\">\n                        <label>Outlook App Domain:</label>\n                        <mat-form-field appearance=\"outline\">\n                            <input\n                                matInput\n                                formControlName=\"app_domain\"\n                                placeholder=\"Application Domain\"\n                            />\n                            <mat-error>\n                                An application domain is required\n                            </mat-error>\n                        </mat-form-field>\n                    </div>\n                </div>\n                <div class=\"flex items-center flex-wrap space-x-0 sm:space-x-2\">\n                    <div class=\"flex flex-col flex-1\">\n                        <label>Outlook App Resource:</label>\n                        <mat-form-field appearance=\"outline\">\n                            <input\n                                matInput\n                                formControlName=\"app_resource\"\n                                placeholder=\"Application ID\"\n                            />\n                            <mat-error>\n                                An application resource is required\n                            </mat-error>\n                        </mat-form-field>\n                    </div>\n                    <div class=\"flex flex-col flex-1\">\n                        <label>Outlook Source Location:</label>\n                        <mat-form-field appearance=\"outline\">\n                            <input\n                                matInput\n                                formControlName=\"source_location\"\n                                placeholder=\"Source Location\"\n                            />\n                            <mat-error>A source location is required</mat-error>\n                        </mat-form-field>\n                    </div>\n                </div>\n                <div class=\"flex items-center flex-wrap space-x-0 sm:space-x-2\">\n                    <div class=\"flex flex-col flex-1\">\n                        <label>Outlook Base Path:</label>\n                        <mat-form-field appearance=\"outline\">\n                            <input\n                                matInput\n                                formControlName=\"base_path\"\n                                placeholder=\"outlook\"\n                            />\n                            <mat-error>\n                                Base path to the application root folder is\n                                required\n                            </mat-error>\n                        </mat-form-field>\n                    </div>\n                </div>\n            </form>\n            <div class=\"flex flex-col space-y-2\">\n                <label>Booking Limits</label>\n                <object-list-field\n                    formControlName=\"booking_limits\"\n                    [fields]=\"['type', 'amount']\"\n                ></object-list-field>\n            </div>\n        </main>\n        <footer\n            *ngIf=\"!loading\"\n            class=\"p-2 border-t border-base-200 flex justify-center\"\n        >\n            <button btn class=\"w-32\" (click)=\"save()\">Save</button>\n        </footer>\n        <ng-template #load_state>\n            <main class=\"flex flex-col p-8 items-center justify-center\">\n                <mat-spinner class=\"mb-4\" [diameter]=\"48\"></mat-spinner>\n                <p>Saving staff API tenant...</p>\n            </main>\n        </ng-template>\n    `,\n    styles: [\n        `\n            main {\n                width: 32rem;\n                max-width: calc(100vw - 5rem);\n                max-height: 65vh;\n            }\n        `,\n    ],\n})\nexport class StaffTenantModalComponent implements OnInit {\n    @Output() public readonly event = new EventEmitter<DialogEvent>();\n\n    public readonly tenant = this._data.tenant;\n    public readonly domain = this._data.domain;\n\n    public show_outlook = false;\n\n    public form = new FormGroup({\n        id: new FormControl(this.tenant?.id || ''),\n        domain: new FormControl(\n            this.domain?.domain || this.tenant?.domain || 'localhost'\n        ),\n        name: new FormControl(this.tenant?.name || '', [Validators.required]),\n        email_domain: new FormControl(this.tenant?.email_domain || ''),\n        delegated: new FormControl(this.tenant?.delegated ?? false),\n        platform: new FormControl(this.tenant?.platform || 'google', [\n            Validators.required,\n        ]),\n        service_account: new FormControl(this.tenant?.service_account, [\n            Validators.email,\n        ]),\n        booking_limits: new FormControl([]),\n        credentials:\n            this.tenant?.platform === 'office365'\n                ? this.office_form\n                : this.google_form,\n    });\n\n    public loading = false;\n\n    public readonly name_map = FIELD_NAME_MAPPING;\n\n    public get office_form() {\n        return new FormGroup({\n            tenant: new FormControl('', [Validators.required]),\n            client_id: new FormControl('', [Validators.required]),\n            client_secret: new FormControl('', [Validators.required]),\n            conference_type: new FormControl(''),\n        });\n    }\n\n    public get google_form() {\n        return new FormGroup({\n            issuer: new FormControl('', [Validators.required]),\n            signing_key: new FormControl('', [Validators.required]),\n            scopes: new FormControl('', [Validators.required]),\n            domain: new FormControl('', [Validators.required]),\n            sub: new FormControl('', [Validators.required]),\n            user_agent: new FormControl('PlaceOS', [Validators.required]),\n            conference_type: new FormControl(''),\n        });\n    }\n\n    public get credentials(): FormGroup {\n        return this.form?.controls.credentials as any;\n    }\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA) private _data: StaffTenantModalData,\n        private _dialog_ref: MatDialogRef<StaffTenantModalComponent>\n    ) {}\n\n    public ngOnInit() {\n        const limits = this.tenant?.booking_limits || {};\n        const fields = [\n            'tenant',\n            'client_id',\n            'client_secret',\n            'issuer',\n            'signing_key',\n            'scopes',\n            'sub',\n            'domain',\n            'user_agent',\n        ];\n        const handleDelegation = (delegated) => {\n            if (delegated) {\n                for (const field of fields) {\n                    this.form.get('credentials')?.get(field)?.disable();\n                    this.form.get('credentials')?.get(field)?.setValidators([]);\n                }\n            } else {\n                const id = this.form.value.id;\n                for (const field of fields) {\n                    this.form.get('credentials')?.get(field)?.enable();\n                    this.form\n                        .get('credentials')\n                        ?.get(field)\n                        ?.setValidators(id ? [] : [Validators.required]);\n                }\n            }\n            this.form.updateValueAndValidity();\n        };\n        this.form.controls.platform.valueChanges.subscribe((platform) => {\n            const credentials = this.form.value.credentials;\n            this.form.removeControl('credentials');\n            this.form.addControl(\n                'credentials',\n                platform === 'office365' ? this.office_form : this.google_form\n            );\n            if (platform === 'office365') {\n                (this.form as any).addControl(\n                    'outlook_config',\n                    new FormGroup({\n                        app_id: new FormControl(''),\n                        app_domain: new FormControl(''),\n                        app_resource: new FormControl(''),\n                        source_location: new FormControl(''),\n                        base_path: new FormControl(''),\n                    })\n                );\n            } else {\n                (this.form as any).removeControl('outlook_config');\n            }\n            handleDelegation(this.form.value.delegated);\n            this.form.patchValue({ credentials });\n        });\n        handleDelegation(this.form.value.delegated);\n        this.form.controls.delegated.valueChanges.subscribe(handleDelegation);\n        this.form.patchValue({\n            ...(this.tenant || {}),\n            domain: this.tenant?.domain || this._data.domain?.domain,\n            booking_limits: Object.keys(limits).map((k) => ({\n                type: k,\n                amount: limits[k],\n            })),\n        });\n    }\n\n    public async save() {\n        this.form.markAllAsTouched();\n        if (!this.form.valid) {\n            return notifyError(\n                `Some fields are invalid. [${getInvalidFields(this.form)}]`\n            );\n        }\n        this._dialog_ref.disableClose = true;\n        this.loading = true;\n        const limits: { type: string; amount: string }[] =\n            this.form.value.booking_limits || [];\n        const booking_limits = limits.reduce((m, { type, amount }) => {\n            m[type] = +amount;\n            return m;\n        }, {});\n        const value = this.form.value;\n        if (!value.credentials.conference_type)\n            delete value.credentials.conference_type;\n        if (!this.show_outlook) {\n            delete (value as any).outlook_config;\n        } else {\n            for (const key in (value as any).outlook_config) {\n                if ((value as any).outlook_config[key] == null) {\n                    delete (value as any).outlook_config[key];\n                }\n            }\n        }\n        for (const key in (value as any).credentials) {\n            if ((value as any).credentials[key] == null) {\n                delete (value as any).credentials[key];\n            }\n        }\n        if (!Object.keys(value.credentials).length) {\n            delete value.credentials;\n        }\n        const data = cleanObject(\n            {\n                ...(this.tenant || {}),\n                ...value,\n                booking_limits,\n            },\n            ['', null, undefined]\n        );\n        const call = this.tenant?.id\n            ? put(`/api/staff/v1/tenants/${this.tenant.id}`, data)\n            : post('/api/staff/v1/tenants', data);\n        const tenant = await call.toPromise().catch((_) => null);\n        this.loading = false;\n        this._dialog_ref.disableClose = false;\n        if (!tenant) return notifyError('Error adding new tenant.');\n        notifySuccess('Successfully added new tenant.');\n        this._dialog_ref.close();\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport {\n    authority,\n    del,\n    get,\n    PlaceDomain,\n    queryDomains,\n} from '@placeos/ts-client';\nimport { BehaviorSubject } from 'rxjs';\nimport { catchError, map, shareReplay, switchMap } from 'rxjs/operators';\nimport { openConfirmModal } from '../common/general';\nimport { notifyError, notifySuccess } from '../common/notifications';\nimport { HashMap } from '../common/types';\nimport { BookingLimitsModalComponent } from './booking-limits-modal.component';\nimport { StaffTenantModalComponent } from './staff-tenant-modal.component';\n\nexport interface PlaceTenant {\n    id: string;\n    name: string;\n    domain: string;\n    email_domain: string;\n    platform: string;\n    delegated?: boolean;\n    service_account?: string;\n    booking_limits: Record<string, number>;\n    credentials?: HashMap<string>;\n}\n\n@Component({\n    selector: 'staff-api',\n    template: `\n        <div class=\"flex items-center space-x-2 my-4\">\n            <label for=\"type\">Domain: </label>\n            <mat-form-field class=\"h-12\" appearance=\"outline\">\n                <mat-select\n                    name=\"type\"\n                    [ngModel]=\"domain | async\"\n                    (ngModelChange)=\"domain.next($event)\"\n                    placeholder=\"Select Domain...\"\n                >\n                    <mat-option\n                        *ngFor=\"let domain of domain_list\"\n                        [value]=\"domain\"\n                    >\n                        {{ domain.name }}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n            <button btn (click)=\"editTenant()\">Add Tenant</button>\n        </div>\n        <ng-container *ngIf=\"!loading; else load_state\">\n            <div\n                class=\"w-full\"\n                *ngIf=\"(tenants | async)?.length; else empty_state\"\n            >\n                <div table-head>\n                    <div class=\"w-1/2 p-2\">Name</div>\n                    <div class=\"flex-1 p-2\">Platform</div>\n                    <div class=\"w-24 p-2 h-10\"></div>\n                    <div class=\"w-24 p-2 h-10\"></div>\n                </div>\n                <div table-body>\n                    <div table-row *ngFor=\"let item of tenants | async\">\n                        <div class=\"w-1/2 p-2 truncate\">{{ item.name }}</div>\n                        <div class=\"flex-1 p-2 truncate\">\n                            {{ item.platform }}\n                        </div>\n                        <div class=\"w-24 p-2 truncate\">\n                            <button\n                                btn\n                                class=\"clear underline\"\n                                (click)=\"editLimits(item)\"\n                            >\n                                Edit Limits\n                            </button>\n                        </div>\n                        <div class=\"w-24 px-2 flex items-center justify-end \">\n                            <button\n                                btn\n                                icon\n                                class=\"h-10 w-10\"\n                                (click)=\"editTenant(item)\"\n                            >\n                                <app-icon\n                                    className=\"backoffice-edit\"\n                                ></app-icon>\n                            </button>\n                            <button\n                                btn\n                                icon\n                                class=\"h-10 w-10\"\n                                (click)=\"removeTenant(item)\"\n                            >\n                                <app-icon\n                                    className=\"backoffice-trash\"\n                                ></app-icon>\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </ng-container>\n        <ng-template #empty_state>\n            <div class=\"flex flex-col items-center justify-center\">\n                <p>No tenants for selected domain</p>\n            </div>\n        </ng-template>\n        <ng-template #load_state>\n            <div class=\"w-full flex flex-col items-center justify-center\">\n                <mat-spinner class=\"mb-4\" [diameter]=\"48\"></mat-spinner>\n                <p>{{ loading }}</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                position: relative;\n                height: 100%;\n                width: 100%;\n            }\n        `,\n    ],\n})\nexport class PlaceStaffAPIComponent implements OnInit {\n    /** Loading state */\n    public loading: string = '';\n    /** List of available domains */\n    public domain_list: PlaceDomain[];\n    /** Currently active domain */\n    public readonly domain = new BehaviorSubject<PlaceDomain>(null);\n\n    public readonly tenants = this.domain.pipe(\n        switchMap(() => {\n            this.loading = 'Loading tenants for domain...';\n            return get('/api/staff/v1/tenants');\n        }),\n        catchError((_) => []),\n        map((tenants) => {\n            this.loading = '';\n            return tenants.filter(\n                (t) => t.domain === this.domain.getValue().domain\n            );\n        }),\n        shareReplay()\n    );\n\n    constructor(private _dialog: MatDialog) {}\n\n    public async ngOnInit() {\n        this.loading = 'Loading domains...';\n        this.domain_list = await queryDomains()\n            .pipe(map((r) => r.data))\n            .toPromise();\n        const domain = authority();\n        if (!this.domain_list?.length) return;\n        const match = this.domain_list.find((d) => d.id === domain.id);\n        if (match) this.domain.next(match);\n        this.loading = '';\n    }\n\n    public editTenant(tenant?: PlaceTenant) {\n        const ref = this._dialog.open(StaffTenantModalComponent, {\n            data: { tenant, domain: this.domain.getValue() },\n        });\n        ref.afterClosed().subscribe((_) =>\n            this.domain.next(this.domain.getValue())\n        );\n    }\n\n    public editLimits(tenant: PlaceTenant) {\n        const ref = this._dialog.open(BookingLimitsModalComponent, {\n            data: { tenant, domain: this.domain.getValue() },\n        });\n        ref.afterClosed().subscribe((_) =>\n            this.domain.next(this.domain.getValue())\n        );\n    }\n\n    public async removeTenant(tenant: PlaceTenant) {\n        const details = await openConfirmModal(\n            {\n                title: 'Remove tenant?',\n                content: `Remove <strong>${tenant.name}</strong> from this domain?<br>\n                <p style=\"text-align: left; width: 100%;\">This will remove all related:</p><br>\n                <ul style=\"list-style: disc;text-align: left;padding-left: 2rem\">\n                <li>bookings (such as desk bookings)</li>\n                <li>event metadata (such as catering)</li>\n                <li>guest information</li>\n                <li>survey data</li>\n                </ul>`,\n                icon: { type: 'icon', class: 'backoffice-trash' },\n                action: 'Delete',\n            },\n            this._dialog\n        );\n        if (!details || !details.reason) return;\n        details.loading('Removing tenant from domain...');\n        const system = await del(`/api/staff/v1/tenants/${tenant.id}`)\n            .toPromise()\n            .catch((err) => {\n                notifyError(\n                    `Error removing module ${tenant.id} from domain. Error: ${\n                        err.statusText || err.message || err\n                    }`\n                );\n                return true;\n            });\n        details.close();\n        if (system) return;\n        notifySuccess(`Successfully removed tenant from domain.`);\n        this.domain.next(this.domain.getValue());\n    }\n}\n","import { Component, EventEmitter, Inject, Output } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { addEdge, PlaceEdge, updateEdge } from '@placeos/ts-client';\nimport { notifyError, notifySuccess } from '../common/notifications';\nimport { DialogEvent } from '../common/types';\n\nexport interface EdgeModalData {\n    edge: PlaceEdge;\n}\n\n@Component({\n    selector: 'edge-modal',\n    template: `\n        <header>\n            <h3>{{ edge ? 'Edit' : 'New' }} Edge</h3>\n            <div class=\"flex-1\"></div>\n            <button *ngIf=\"!loading\" btn icon mat-dialog-close>\n                <app-icon className=\"backoffice-cross\"></app-icon>\n            </button>\n        </header>\n        <main\n            [formGroup]=\"form\"\n            *ngIf=\"!loading && form; else load_state\"\n            class=\"overflow-auto p-4\"\n        >\n            <div class=\"flex flex-col flex-1\">\n                <label>Name<span>*</span>:</label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        formControlName=\"name\"\n                        placeholder=\"Edge Name\"\n                    />\n                    <mat-error>A edge name is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"flex flex-col flex-1\">\n                <label>Description:</label>\n                <mat-form-field appearance=\"outline\">\n                    <textarea\n                        matInput\n                        formControlName=\"description\"\n                        placeholder=\"Edge description...\"\n                    ></textarea>\n                </mat-form-field>\n            </div>\n        </main>\n        <footer\n            *ngIf=\"!loading\"\n            class=\"p-2 border-t border-base-200 flex justify-center\"\n        >\n            <button btn class=\"w-32\" (click)=\"save()\">Save</button>\n        </footer>\n        <ng-template #load_state>\n            <main class=\"flex flex-col p-8 items-center justify-center\">\n                <mat-spinner class=\"mb-4\" [diameter]=\"48\"></mat-spinner>\n                <p>Saving edge...</p>\n            </main>\n        </ng-template>\n    `,\n    styles: [\n        `\n            main {\n                width: 32rem;\n                max-width: calc(100vw - 5rem);\n                max-height: 65vh;\n            }\n        `,\n    ],\n})\nexport class EdgeModalComponent {\n    @Output() public readonly event = new EventEmitter<DialogEvent>();\n\n    public readonly edge = this._data.edge;\n\n    public form = new FormGroup({\n        name: new FormControl('', [Validators.required]),\n        description: new FormControl(''),\n    });\n\n    public loading = false;\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA) private _data: EdgeModalData,\n        private _dialog_ref: MatDialogRef<EdgeModalComponent>\n    ) {}\n\n    public ngOnInit() {\n        this.form.patchValue(this.edge);\n    }\n\n    public async save() {\n        this.form.markAllAsTouched();\n        if (!this.form.valid) return;\n        this._dialog_ref.disableClose = true;\n        this.loading = true;\n        const edge = { ...this.edge, ...this.form.value };\n        const method = edge.id ? updateEdge(edge.id, edge) : addEdge(edge);\n        const new_edge = await method.toPromise().catch((_) => null);\n        this.loading = false;\n        this._dialog_ref.disableClose = false;\n        if (!new_edge) return notifyError('Error adding new edge.');\n        edge.id\n            ? notifySuccess('Successfully updated edge.')\n            : notifySuccess(\n                  'Successfully added new edge. Please make sure to save the API key as you will not be able to view it again in the future.'\n              );\n        this._dialog_ref.close(new_edge);\n    }\n}\n","import { Clipboard } from '@angular/cdk/clipboard';\nimport { Component } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport {\n    PlaceEdge,\n    queryEdges,\n    removeEdge,\n    retrieveEdgeToken,\n} from '@placeos/ts-client';\nimport { BehaviorSubject, combineLatest, Observable, of } from 'rxjs';\nimport {\n    catchError,\n    debounceTime,\n    map,\n    shareReplay,\n    switchMap,\n} from 'rxjs/operators';\nimport { copyToClipboard, openConfirmModal } from '../common/general';\nimport {\n    notifyError,\n    notifyInfo,\n    notifySuccess,\n} from '../common/notifications';\nimport { EdgeModalComponent } from './edge-modal.component';\n\n@Component({\n    selector: '[admin-edge]',\n    template: `\n        <button btn class=\"w-full sm:w-40 my-4\" (click)=\"edit()\">\n            Add New Edge\n        </button>\n        <ng-container *ngIf=\"!loading; else load_state\">\n            <div\n                table\n                class=\"w-full min-w-[52rem]\"\n                *ngIf=\"(edges | async)?.length; else empty_state\"\n            >\n                <div table-head>\n                    <div class=\"w-32 p-2\">ID</div>\n                    <div class=\"w-40 p-2\">Name</div>\n                    <div class=\"flex-1 p-2\">Description</div>\n                    <div class=\"w-24 p-2 h-10\"></div>\n                </div>\n                <div table-body>\n                    <div table-row *ngFor=\"let item of edges | async\">\n                        <div class=\"w-32 p-2 truncate text-xs font-mono\">\n                            {{ item.id }}\n                        </div>\n                        <div class=\"w-40 p-2 truncate text-sm\">\n                            {{ item.name }}\n                        </div>\n                        <div class=\"flex-1 w-1/4 p-2 truncate text-xs\">\n                            {{ item.description }}\n                        </div>\n                        <div class=\"w-24 px-2 flex items-center justify-end \">\n                            <button\n                                btn\n                                icon\n                                class=\"h-10 w-10\"\n                                (click)=\"edit(item)\"\n                            >\n                                <app-icon\n                                    className=\"backoffice-edit\"\n                                ></app-icon>\n                            </button>\n                            <button\n                                btn\n                                icon\n                                class=\"h-10 w-10\"\n                                (click)=\"remove(item)\"\n                            >\n                                <app-icon\n                                    className=\"backoffice-trash\"\n                                ></app-icon>\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </ng-container>\n        <div\n            *ngIf=\"(last_change | async)?.x_api_key\"\n            (click)=\"copyKey(item.x_api_key)\"\n            matRipple\n            [matTooltip]=\"'Copy API Key for ' + item.name\"\n            class=\"absolute flex rounded cursor-pointer items-center right-4 top-4 bg-base-100  shadow border border-base-200  max-w-[calc(100%-11rem)] overflow-hidden\"\n        >\n            <div\n                class=\"p-2 flex-1 w-1/2 flex h-full items-center border-r border-base-200  \"\n            >\n                <code class=\"flex-1 truncate\">{{ item.x_api_key }}</code>\n            </div>\n            <button btn icon class=\"rounded-none\">\n                <app-icon className=\"backoffice-copy\"></app-icon>\n            </button>\n        </div>\n        <ng-template #empty_state>\n            <div class=\"flex flex-col items-center justify-center\">\n                <p>No edges</p>\n            </div>\n        </ng-template>\n        <ng-template #load_state>\n            <div class=\"w-full flex flex-col items-center justify-center\">\n                <mat-spinner class=\"mb-4\" [diameter]=\"48\"></mat-spinner>\n                <p>{{ loading }}</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                height: 100%;\n                width: 100%;\n                min-height: 10rem;\n            }\n        `,\n    ],\n})\nexport class PlaceEdgeComponent {\n    public loading: string = '';\n\n    private _change = new BehaviorSubject<number>(0);\n    private _hide = new BehaviorSubject<string>('');\n    public last_change = new BehaviorSubject<PlaceEdge>(null);\n\n    public get item() {\n        return this.last_change.getValue();\n    }\n\n    private _edge_list: Observable<PlaceEdge[]> = this._change.pipe(\n        debounceTime(300),\n        switchMap((_) => {\n            this.loading = 'Loading Edges...';\n            return queryEdges();\n        }),\n        catchError((_) => of({})),\n        map((details?: { data: PlaceEdge[] }) => {\n            this.loading = '';\n            return (details?.data || []).sort((a, b) =>\n                a.id?.localeCompare(b.id)\n            );\n        }),\n        shareReplay()\n    );\n\n    public readonly edges = combineLatest([this._edge_list, this._hide]).pipe(\n        debounceTime(500),\n        map(([list, hide]) => {\n            if (!hide) return list;\n            const edges = list.filter((_) => _.id !== hide);\n            return edges.sort((a, b) => a.id?.localeCompare(b.id));\n        })\n    );\n\n    public readonly token = async (edge: PlaceEdge) => {\n        const details = await retrieveEdgeToken(edge.id).toPromise();\n        copyToClipboard(details.token);\n        notifyInfo(`Token copied to clickboard.`);\n    };\n\n    public readonly edit = async (edge?: PlaceEdge) => {\n        const ref = this._dialog.open(EdgeModalComponent, { data: { edge } });\n        ref.afterClosed().subscribe((_) => {\n            sessionStorage.setItem('BACKOFFICE.last_edge', JSON.stringify(_));\n            this.last_change.next(_);\n            this._change.next(Date.now());\n        });\n    };\n\n    public readonly remove = async (i: PlaceEdge) => {\n        const details = await openConfirmModal(\n            {\n                title: 'Remove edge?',\n                content: `Remove <strong>${i.name}</strong>?<br>You or your users may lose access to some data.`,\n                icon: { type: 'icon', class: 'backoffice-trash' },\n            },\n            this._dialog\n        );\n        if (!details) return;\n        details.loading('Removing edge...');\n        const err = await removeEdge(i.id)\n            .toPromise()\n            .catch((_) => _);\n        details.close();\n        if (err)\n            return notifyError(\n                `Error removing edge. Error: ${\n                    err.statusText || err.message || err\n                }`\n            );\n        sessionStorage.removeItem('BACKOFFICE.last_edge');\n        this.last_change.next(null);\n        notifySuccess('Successfully removed Edge.');\n        this._hide.next(i.id);\n    };\n\n    constructor(private _dialog: MatDialog, private _clipboard: Clipboard) {}\n\n    public ngOnInit() {\n        const edge_data = sessionStorage.getItem('BACKOFFICE.last_edge');\n        try {\n            this.last_change.next(JSON.parse(edge_data) || null);\n        } catch {}\n    }\n\n    public copyKey(key: string) {\n        if (key && this._clipboard.copy(key)) {\n            notifySuccess('Edge API Key copied to clipboard.');\n        }\n    }\n}\n","import { Component } from '@angular/core';\nimport { map, shareReplay, take } from 'rxjs/operators';\nimport { randomInt } from '../common/general';\nimport { JsonSchema, SchemaStateService } from './schema-state.service';\n\n@Component({\n    selector: 'admin-schemas',\n    template: `\n        <div class=\"flex items-center space-x-2 my-4\">\n            <div class=\"flex flex-col\">\n                <label for=\"type\">Schema: </label>\n                <mat-form-field class=\"h-12\" appearance=\"outline\">\n                    <mat-select\n                        name=\"type\"\n                        [(ngModel)]=\"active_schema\"\n                        (ngModelChange)=\"copySchema()\"\n                        placeholder=\"Select Schema...\"\n                    >\n                        <mat-option\n                            *ngFor=\"let schema of schema_list | async\"\n                            [value]=\"schema\"\n                        >\n                            {{ schema.name }}\n                        </mat-option>\n                        <mat-option\n                            (click)=\"newSchema(); $event.preventDefault()\"\n                        >\n                            <span class=\"italic font-sans\">New Schema</span>\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n            <button btn class=\"mt-6\" (click)=\"newSchema()\">Add Schema</button>\n        </div>\n        <div class=\"flex items-center space-x-2 mb-4\" *ngIf=\"schema_copy\">\n            <div class=\"flex flex-col\">\n                <label for=\"type\">Schema Name: </label>\n                <mat-form-field class=\"h-12\" appearance=\"outline\">\n                    <input matInput [(ngModel)]=\"schema_copy.name\" />\n                </mat-form-field>\n            </div>\n            <button btn class=\"mt-6\" (click)=\"saveSchema()\">Save Schema</button>\n        </div>\n        <div class=\"relative flex-1 h-1/2\">\n            <ng-container *ngIf=\"schema_copy; else empty_state\">\n                <settings-form-field\n                    [(ngModel)]=\"schema_copy.schema\"\n                    lang=\"json\"\n                    [readonly]=\"false\"\n                ></settings-form-field>\n            </ng-container>\n        </div>\n        <ng-template #empty_state>\n            <div class=\"absolute inset-0 flex items-center justify-center\">\n                <p class=\"p-8\">Select a schema to edit</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [\n        `\n            :host {\n                position: absolute;\n                top: 0;\n                left: 1rem;\n                right: 1rem;\n                bottom: 0;\n                display: flex;\n                flex-direction: column;\n            }\n        `,\n    ],\n})\nexport class AdminSchemasComponent {\n    public active_schema: JsonSchema;\n    public schema_copy: JsonSchema;\n\n    public readonly schema_list = this._state.schemas.pipe(shareReplay(1));\n    constructor(private _state: SchemaStateService) {}\n\n    public copySchema() {\n        if (!this.active_schema) return;\n        this.schema_copy = JSON.parse(JSON.stringify(this.active_schema));\n    }\n\n    public async newSchema() {\n        this.active_schema = {\n            name: 'New Schema',\n            schema: '{}',\n        };\n        this.copySchema();\n    }\n\n    public saveSchema() {\n        this._state.saveSchema(this.schema_copy);\n        this.active_schema = null;\n        this.schema_copy = null;\n    }\n}\n","import getTime from \"../getTime/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\n/**\n * @name getUnixTime\n * @category Timestamp Helpers\n * @summary Get the seconds timestamp of the given date.\n *\n * @description\n * Get the seconds timestamp of the given date.\n *\n * @param {Date|Number} date - the given date\n * @returns {Number} the timestamp\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // Get the timestamp of 29 February 2012 11:45:05 CET:\n * const result = getUnixTime(new Date(2012, 1, 29, 11, 45, 5))\n * //=> 1330512305\n */\nexport default function getUnixTime(dirtyDate) {\n  requiredArgs(1, arguments);\n  return Math.floor(getTime(dirtyDate) / 1000);\n}","import toDate from \"../toDate/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\n/**\n * @name getTime\n * @category Timestamp Helpers\n * @summary Get the milliseconds timestamp of the given date.\n *\n * @description\n * Get the milliseconds timestamp of the given date.\n *\n * @param {Date|Number} date - the given date\n * @returns {Number} the timestamp\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // Get the timestamp of 29 February 2012 11:45:05.123:\n * const result = getTime(new Date(2012, 1, 29, 11, 45, 5, 123))\n * //=> 1330515905123\n */\nexport default function getTime(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  var timestamp = date.getTime();\n  return timestamp;\n}","import { getUnixTime } from 'date-fns';\n\nexport class PlaceAPIKeyDetails {\n    public readonly id: string;\n    public readonly name: string;\n    public readonly user_id: string;\n    public readonly authority_id: string;\n    public readonly description: string;\n    public readonly scopes: string[];\n    public readonly permissions: null | 'user' | 'support' | 'admin';\n    public readonly created_at: number;\n    public readonly updated_at: number;\n    public readonly secret?: string;\n    public readonly x_api_key?: string;\n\n    constructor(_data: Partial<PlaceAPIKeyDetails>) {\n        this.id = _data.id || '';\n        this.name = _data.name || '';\n        this.user_id = _data.user_id || '';\n        this.authority_id = _data.authority_id || '';\n        this.description = _data.description || '';\n        this.permissions = _data.permissions || 'user';\n        this.created_at = _data.created_at || getUnixTime(new Date());\n        this.updated_at = _data.updated_at || getUnixTime(new Date());\n        this.secret = _data.secret;\n        this.x_api_key = _data.x_api_key || '';\n        this.scopes = _data.scopes || [];\n    }\n}\n","import { COMMA, ENTER, SPACE } from '@angular/cdk/keycodes';\nimport {\n    Component,\n    ElementRef,\n    EventEmitter,\n    Output,\n    ViewChild,\n} from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { BehaviorSubject, combineLatest } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { addChipItem, removeChipItem } from '../../common/forms';\nimport { getInvalidFields } from '../../common/general';\nimport { notifyError } from '../../common/notifications';\nimport { DialogEvent } from '../../common/types';\nimport { APIKeyService } from './api-keys.service';\n\n@Component({\n    selector: 'api-key-modal',\n    template: `\n        <header class=\"h-12 flex items-center justify-between p-4\">\n            <h2>New API Key</h2>\n            <button btn icon mat-dialog-close *ngIf=\"!loading\">\n                <app-icon className=\"backoffice-cross\"></app-icon>\n            </button>\n        </header>\n        <main\n            class=\"w-[32rem] max-w-[calc(100vw-2rem)] p-4\"\n            *ngIf=\"!loading && form; else load_state\"\n            [formGroup]=\"form\"\n        >\n            <div class=\"flex flex-col\">\n                <label for=\"name\">Name<span>*</span></label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        name=\"name\"\n                        formControlName=\"name\"\n                        placeholder=\"Name\"\n                        matInput\n                    />\n                    <mat-error>Name is required</mat-error>\n                </mat-form-field>\n            </div>\n            <div class=\"flex flex-col\">\n                <label for=\"name\">Description</label>\n                <mat-form-field appearance=\"outline\">\n                    <textarea\n                        name=\"description\"\n                        formControlName=\"description\"\n                        placeholder=\"Description\"\n                        matInput\n                    ></textarea>\n                </mat-form-field>\n            </div>\n            <div class=\"flex flex-col\">\n                <label for=\"scope\">Scopes<span>*</span></label>\n                <mat-form-field appearance=\"outline\">\n                    <mat-chip-grid #chipList aria-label=\"Scopes\">\n                        <mat-chip\n                            *ngFor=\"let scope of scope_list\"\n                            [selectable]=\"true\"\n                            [removable]=\"true\"\n                            (removed)=\"removeScope(scope)\"\n                        >\n                            {{ scope }}\n                            <app-icon\n                                matChipRemove\n                                class=\"\"\n                                className=\"backoffice-cross\"\n                            ></app-icon>\n                        </mat-chip>\n                        <input\n                            matInput\n                            placeholder=\"Scopes...\"\n                            i18n-placeholder=\"@@apiScopePlaceholder\"\n                            [matChipInputFor]=\"chipList\"\n                            [matChipInputSeparatorKeyCodes]=\"separators\"\n                            [matChipInputAddOnBlur]=\"true\"\n                            (matChipInputTokenEnd)=\"addScope($event)\"\n                            [matAutocomplete]=\"auto\"\n                        />\n                    </mat-chip-grid>\n                    <mat-error>At least one scope is required</mat-error>\n                    <mat-autocomplete #auto=\"matAutocomplete\">\n                        <mat-option\n                            *ngFor=\"let option of scopes | async\"\n                            (click)=\"addScope({ input: {}, value: option })\"\n                        >\n                            {{ option }}\n                        </mat-option>\n                    </mat-autocomplete>\n                </mat-form-field>\n            </div>\n            <div class=\"flex flex-col\">\n                <label for=\"user\">User<span>*</span></label>\n                <an-action-field\n                    [matMenuTriggerFor]=\"menu\"\n                    yPosition=\"below\"\n                    class=\"mb-8\"\n                    (click)=\"focusInput()\"\n                >\n                    <div [class.opacity-30]=\"!form.value.user?.id\">\n                        {{ form.value.user?.name || 'Select user' }}\n                    </div>\n                </an-action-field>\n                <mat-menu #menu=\"matMenu\">\n                    <mat-form-field\n                        appearance=\"outline\"\n                        class=\"px-2 no-subtext\"\n                        (click)=\"\n                            $event.preventDefault(); $event.stopPropagation()\n                        \"\n                    >\n                        <input\n                            matInput\n                            #input\n                            ngModel\n                            (ngModelChange)=\"setSearch($event)\"\n                            [ngModelOptions]=\"{ standalone: true }\"\n                            placeholder=\"Search users...\"\n                        />\n                    </mat-form-field>\n                    <button\n                        mat-menu-item\n                        *ngFor=\"let item of users | async | slice: 0:10\"\n                        (click)=\"\n                            form.patchValue({ user: item, user_id: item.id });\n                            setSearch('')\n                        \"\n                        [class.text-secondary]=\"form.value.user?.id === item.id\"\n                    >\n                        {{ item.name }}\n                    </button>\n                    <button\n                        mat-menu-item\n                        [disabled]=\"true\"\n                        *ngIf=\"!(users | async)?.length\"\n                        class=\"text-center\"\n                    >\n                        No results\n                    </button>\n                </mat-menu>\n            </div>\n            <div class=\"flex flex-col\">\n                <label for=\"permissions\">Permissions</label>\n                <mat-form-field appearance=\"outline\">\n                    <mat-select\n                        name=\"permissions\"\n                        formControlName=\"permissions\"\n                        placeholder=\"None\"\n                    >\n                        <mat-option [value]=\"null\">None</mat-option>\n                        <mat-option value=\"user\">User</mat-option>\n                        <mat-option value=\"support\">Support</mat-option>\n                        <mat-option value=\"admin\">Admin</mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n        </main>\n        <footer\n            *ngIf=\"!loading\"\n            class=\"p-4 flex items-center justify-center border-t border-base-200 /20\"\n        >\n            <button btn class=\"w-32\" (click)=\"save()\">Save</button>\n        </footer>\n        <ng-template #load_state>\n            <main\n                class=\"flex flex-col items-center justify-center space-y-2 p-8 w-[24rem] h-64\"\n            >\n                <mat-spinner [diameter]=\"32\"></mat-spinner>\n                <p>{{ loading }}</p>\n            </main>\n        </ng-template>\n    `,\n    styles: [``],\n})\nexport class APIKeyModalComponent {\n    @Output() public event = new EventEmitter<DialogEvent>();\n    public form = new FormGroup({\n        name: new FormControl('', [Validators.required]),\n        user: new FormControl(null),\n        user_id: new FormControl('', [Validators.required]),\n        description: new FormControl(''),\n        scopes: new FormControl(\n            [],\n            [Validators.required, Validators.minLength(1)]\n        ),\n        permissions: new FormControl(''),\n    });\n    public loading: string;\n    public readonly search_str = new BehaviorSubject('');\n    public readonly scopes = this._service.available_scopes;\n\n    @ViewChild('input') public _input_el: ElementRef<HTMLInputElement>;\n\n    public readonly users = combineLatest([\n        this._service.users,\n        this.form.valueChanges,\n    ]).pipe(\n        map(([users, { permissions }]) => {\n            if (permissions === 'admin')\n                return users.filter((_) => _.sys_admin);\n            if (permissions === 'support')\n                return users.filter((_) => _.support || _.sys_admin);\n            return users.sort((a, b) => a.name?.localeCompare(b.name));\n        })\n    );\n\n    /** List of separator characters for tags */\n    public readonly separators: number[] = [ENTER, COMMA, SPACE];\n\n    public readonly focusInput = () =>\n        setTimeout(() => this._input_el?.nativeElement?.focus(), 100);\n    public readonly setSearch = (s) => this._service.setSearch(s);\n\n    public readonly addScope = (e) =>\n        addChipItem(this.form.controls.scopes as any, e);\n    public readonly removeScope = (i) =>\n        removeChipItem(this.form.controls.scopes as any, i);\n\n    constructor(private _service: APIKeyService) {\n        setTimeout(() => this.form.patchValue({ permissions: null }), 100);\n    }\n\n    public get scope_list(): string[] {\n        return this.form.controls.scopes.value;\n    }\n\n    public save() {\n        this.form.markAllAsTouched();\n        if (!this.form.valid) {\n            return notifyError(\n                `Some form fields are invalid. [${getInvalidFields(\n                    this.form\n                ).join(', ')}]`\n            );\n        }\n        const data = { ...this.form.value };\n        delete data.user;\n        this.event.emit({ reason: 'done', metadata: this.form.value });\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport {\n    create,\n    get,\n    PlaceDomain,\n    PlaceUser,\n    query,\n    queryDomains,\n    queryUsers,\n    remove,\n} from '@placeos/ts-client';\nimport { BehaviorSubject, combineLatest, Observable, of } from 'rxjs';\nimport { debounceTime, first, map, shareReplay, switchMap } from 'rxjs/operators';\nimport { openConfirmModal } from '../../common/general';\nimport { notifyError, notifySuccess } from '../../common/notifications';\nimport { PlaceAPIKeyDetails } from './api-key-details.class';\nimport { APIKeyModalComponent } from './api-key-modal.component';\n\n@Injectable()\nexport class APIKeyService {\n    private _search = new BehaviorSubject<string>('');\n    private _domain = new BehaviorSubject<PlaceDomain>(null);\n    private _last_key = new BehaviorSubject<PlaceAPIKeyDetails>(null);\n    private _change = new BehaviorSubject<number>(0);\n\n    public readonly last_key = this._last_key.asObservable();\n    public readonly active_domain = this._domain.asObservable();\n\n    public readonly available_domains = queryDomains({ limit: 500 }).pipe(\n        map((_) => _.data),\n        shareReplay(1)\n    );\n\n    public readonly available_scopes: Observable<string[]> = get('/api/engine/v2/scopes').pipe(\n        map(_ => _ as any),\n        shareReplay(1)\n    );\n\n    public readonly available_keys = combineLatest([\n        this._domain,\n        this._change,\n    ]).pipe(\n        switchMap(([domain]) => {\n            return domain\n                ? query({\n                      query_params: { authority_id: domain.id },\n                      fn: (d) => new PlaceAPIKeyDetails(d),\n                      path: 'api_keys',\n                  }).pipe(map((_) => _.data as PlaceAPIKeyDetails[]))\n                : of([] as PlaceAPIKeyDetails[]);\n        }),\n        shareReplay(1)\n    );\n\n    public readonly users = combineLatest([\n        this._domain,\n        this._search,\n        this._change,\n    ]).pipe(\n        debounceTime(300),\n        switchMap(([domain, q]) => {\n            return domain\n                ? queryUsers({ authority_id: domain.id, q }).pipe(\n                      map((_) => _.data as PlaceUser[])\n                  )\n                : of([] as PlaceUser[]);\n        }),\n        shareReplay(1)\n    );\n\n    constructor(private _dialog: MatDialog) {}\n\n    public setDomain(domain: PlaceDomain) {\n        this._domain.next(domain);\n    }\n\n    public setSearch(s: string) {\n        this._search.next(s);\n    }\n\n    public async newKey() {\n        const ref = this._dialog.open(APIKeyModalComponent);\n        const details = await Promise.race([\n            ref.componentInstance.event\n                .pipe(first((_) => _.reason === 'done'))\n                .toPromise(),\n            ref.afterClosed().toPromise(),\n        ]);\n        if (details?.reason !== 'done') return;\n        ref.componentInstance.loading = 'Creating new API key...';\n        const domain = this._domain.getValue();\n        const key = await create({\n            query_params: {},\n            fn: (d) => new PlaceAPIKeyDetails(d),\n            path: 'api_keys',\n            form_data: {\n                ...details.metadata,\n                authority_id: domain.id,\n            },\n        })\n            .toPromise()\n            .catch((_) => {\n                ref.close();\n                notifyError(_);\n                throw _;\n            });\n        this._last_key.next(key as any);\n        this._change.next(Date.now());\n        notifySuccess('Successfully created new API key.');\n        ref.close();\n    }\n\n    public async removeKey(key: PlaceAPIKeyDetails) {\n        const details = await openConfirmModal(\n            {\n                title: 'Remove API Key',\n                content: `Are you sure you wish to remove this API key?\n                    Removing this key may result in applications using this key to stop working.`,\n                icon: { content: 'delete' },\n            },\n            this._dialog\n        );\n        if (details?.reason !== 'done') return;\n        details.loading('Removing API key...');\n        await remove({\n            id: key.id,\n            query_params: {},\n            path: 'api_keys',\n        }).toPromise();\n        details.close();\n        notifySuccess('Successfully removed API key.');\n    }\n}\n","import { Component } from '@angular/core';\nimport { Clipboard } from '@angular/cdk/clipboard';\nimport { take } from 'rxjs/operators';\nimport { APIKeyService } from './api-keys.service';\nimport { notifyInfo } from '../../common/notifications';\nimport { authority } from '@placeos/ts-client';\n\n@Component({\n    selector: 'admin-api-keys',\n    template: `\n        <div class=\"flex items-start space-x-2 my-4\">\n            <div class=\"flex flex-col space-y-1\">\n                <label for=\"type\">Domain: </label>\n                <mat-form-field appearance=\"outline\" class=\"h-12\">\n                    <mat-select\n                        name=\"type\"\n                        [ngModel]=\"domain | async\"\n                        (ngModelChange)=\"setDomain($event)\"\n                        placeholder=\"Select Domain...\"\n                    >\n                        <mat-option\n                            *ngFor=\"let domain of domain_list | async\"\n                            [value]=\"domain\"\n                        >\n                            {{ domain.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n            <button\n                btn\n                class=\"mt-8 min-w-[8rem]\"\n                [disabled]=\"!(domain | async)\"\n                (click)=\"newKey()\"\n            >\n                Add API Key\n            </button>\n            <div\n                *ngIf=\"last_key | async\"\n                class=\"rounded shadow border border-base-200 min-w-[24rem]\"\n            >\n                <div class=\"border-b px-2 pb-1 bg-base-200 !w-full\">\n                    <label class=\"p-0 m-0\">\n                        Last API Key Details ({{\n                            (last_key | async)?.name || 'Unanamed API Key'\n                        }})\n                    </label>\n                </div>\n                <div class=\"p-2\">\n                    <div\n                        class=\"select-all text-xs opacity-60 mono break-words cursor-pointer\"\n                        (click)=\"copyKey()\"\n                    >\n                        {{ (last_key | async)?.x_api_key }}\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div\n            role=\"table\"\n            class=\"min-w-[60rem]\"\n            *ngIf=\"(key_list | async)?.length; else load_state\"\n        >\n            <div table-head>\n                <div class=\"w-48 p-2\">Name</div>\n                <div class=\"flex-1 p-2\">Description</div>\n                <div class=\"w-32 p-2 truncate\">Scopes</div>\n                <div class=\"w-28 p-2\">Permissions</div>\n                <div class=\"w-32 p-2\">Created</div>\n                <div class=\"w-16 p-2\"></div>\n            </div>\n            <div table-body>\n                <div table-row *ngFor=\"let item of key_list | async\">\n                    <div class=\"w-48 p-2 truncate text-sm\" [title]=\"item.name\">\n                        {{ item.name }}\n                    </div>\n                    <div class=\"flex-1 p-2 text-xs\">{{ item.description }}</div>\n                    <div class=\"w-32 p-2 truncate flex items-center flex-wrap\">\n                        <code *ngFor=\"let scope of item.scopes\" class=\"m-1\">\n                            {{ scope }}\n                        </code>\n                    </div>\n                    <div class=\"w-28 p-2\">{{ item.permissions || 'None' }}</div>\n                    <div class=\"w-32 p-2\">\n                        {{ item.created_at * 1000 | dateFrom }}\n                    </div>\n                    <div class=\"w-16 p-2 flex items-center\">\n                        <button btn icon (click)=\"deleteKey(item)\">\n                            <app-icon className=\"backoffice-trash\"></app-icon>\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <ng-template #load_state>\n            <div class=\"info-block\">\n                <app-icon class=\"text-3xl\">close</app-icon>\n                <p>No API keys configured for this domain</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [``],\n})\nexport class AdminAPIKeysComponent {\n    public readonly domain = this._service.active_domain;\n    public readonly domain_list = this._service.available_domains;\n    public readonly key_list = this._service.available_keys;\n    public readonly last_key = this._service.last_key;\n\n    public readonly setDomain = (d) => this._service.setDomain(d);\n    public readonly newKey = () => this._service.newKey();\n    public readonly deleteKey = (k) => this._service.removeKey(k);\n\n    constructor(\n        private _service: APIKeyService,\n        private _clipboard: Clipboard\n    ) {}\n\n    public async ngOnInit() {\n        const domain = authority();\n        const domain_list = await this.domain_list.pipe(take(1)).toPromise();\n        if (!domain_list?.length) return;\n        const match = domain_list.find((d) => d.id === domain.id);\n        if (match) this.setDomain(match);\n    }\n\n    public async copyKey() {\n        const key = await this.last_key.pipe(take(1)).toPromise();\n        if (!key?.x_api_key) return;\n        this._clipboard.copy(key.x_api_key);\n        notifyInfo('Copied API key to clipboard.');\n    }\n}\n","import {\n    cleanObject,\n    create,\n    query,\n    remove,\n    show,\n    update,\n} from '@placeos/ts-client';\n\nconst PATH = 'storages';\n\nexport class PlaceStorage {\n    /** ID of the storage */\n    public readonly id: string;\n    /** ID of the authority the storage is under */\n    public readonly authority_id: string;\n    /** Type of the storage */\n    public readonly storage_type: string;\n    /** Name of the storage */\n    public readonly bucket_name: string;\n    /** Region of the storage */\n    public readonly region: string;\n    /** Access key for the storage */\n    public readonly access_key: string;\n    /** Access secret for the storage */\n    public readonly access_secret: string;\n    /** Endpoint for the storage */\n    public readonly endpoint: string;\n    /** File type extensions to filter out */\n    public readonly ext_filter: string[];\n    /** File MIME type extensions to filter out */\n    public readonly mime_filter: string[];\n\n    constructor(item: Partial<PlaceStorage> = {}) {\n        Object.assign(this, item);\n    }\n}\n\n/** Convert raw server data to an storage object */\nfunction process(item: Partial<PlaceStorage>) {\n    return new PlaceStorage(item);\n}\n\nexport interface StorageQueryParameters {\n    /** ID of the authority the storage is under */\n    auth_id?: string;\n    /** Filter results based on a simple query string */\n    q?: string;\n    /** Number of results to return */\n    limit?: number;\n    /** Number of results to skip */\n    offset?: number;\n}\n\n/**\n * Query the available systems\n * @param query_params Query parameters to add the to request URL\n */\nexport function queryStorage(query_params: StorageQueryParameters = {}) {\n    return query({ query_params, fn: process, path: PATH });\n}\n\n/**\n * Get the data for a system\n * @param id ID of the system to retrieve\n * @param query_params Query parameters to add the to request URL\n */\nexport function showStorage(\n    id: string,\n    query_params: StorageQueryParameters = {}\n) {\n    return show({ id, query_params, fn: process, path: PATH });\n}\n\n/**\n * Update the storage in the database\n * @param id ID of the storage\n * @param form_data New values for the storage\n * @param query_params Query parameters to add the to request URL\n * @param method HTTP verb to use on request. Defaults to `patch`\n */\nexport function updateStorage(\n    id: string,\n    form_data: Partial<PlaceStorage>,\n    method: 'put' | 'patch' = 'patch'\n) {\n    return update({\n        id,\n        form_data,\n        query_params: {},\n        method,\n        fn: process,\n        path: PATH,\n    });\n}\n\n/**\n * Save the item to the database will overrite existing item if `id` is set\n * @param item New storage data\n * @returns New storage object\n */\nexport function saveStorage(item: PlaceStorage) {\n    const data = cleanObject(item, ['', undefined, null]);\n    return item.id ? updateStorage(item.id, data, 'put') : addStorage(data);\n}\n\n/**\n * Add a new storage to the database\n * @param form_data Storage data\n * @param query_params Query parameters to add the to request URL\n */\nexport function addStorage(form_data: Partial<PlaceStorage>) {\n    return create({ form_data, query_params: {}, fn: process, path: PATH });\n}\n\n/**\n * Remove an storage from the database\n * @param id ID of the storage\n * @param query_params Query parameters to add the to request URL\n */\nexport function removeStorage(\n    id: string,\n    query_params: Record<string, any> = {}\n) {\n    return remove({ id, query_params, path: PATH });\n}\n","import { Component, Inject } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { PlaceStorage, saveStorage } from './storage.fn';\nimport { notifyError, notifySuccess } from '../../common/notifications';\n\n@Component({\n    selector: 'storage-provider-modal',\n    template: `\n        <header>\n            <h2>{{ storage?.id ? 'Edit' : 'New' }} Storage Provider</h2>\n            <button btn icon matRipple mat-dialog-close>\n                <app-icon className=\"backoffice-close\"></app-icon>\n            </button>\n        </header>\n        <form [formGroup]=\"form\" class=\"max-h-[65vh] overflow-auto px-4 py-2\">\n            <!-- <div class=\"flex flex-col \">\n                <label for=\"storage-type\">Storage Type</label>\n                <mat-form-field appearance=\"outline\">\n                    <mat-select\n                        name=\"storage-type\"\n                        formControlName=\"storage_type\"\n                        placeholder=\"None\"\n                    >\n                        <mat-option value=\"s3\">Amazon S3</mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div> -->\n            <div class=\"flex space-x-2\">\n                <div class=\"flex-1 flex flex-col \">\n                    <label for=\"bucket-name\">Bucket Name</label>\n                    <mat-form-field appearance=\"outline\">\n                        <input\n                            matInput\n                            name=\"bucket-name\"\n                            formControlName=\"bucket_name\"\n                            placeholder=\"Bucket Name\"\n                        />\n                        <mat-error>Bucket Name is required</mat-error>\n                    </mat-form-field>\n                </div>\n                <div class=\"flex-1 flex flex-col \">\n                    <label for=\"region\">Region</label>\n                    <mat-form-field appearance=\"outline\">\n                        <input\n                            matInput\n                            name=\"region\"\n                            formControlName=\"region\"\n                            placeholder=\"Region\"\n                        />\n                        <mat-error>Region is required</mat-error>\n                    </mat-form-field>\n                </div>\n            </div>\n            <div class=\"flex space-x-2\">\n                <div class=\"flex-1 flex flex-col\">\n                    <label for=\"access-key\">Access Key</label>\n                    <mat-form-field appearance=\"outline\">\n                        <input\n                            matInput\n                            name=\"access-key\"\n                            formControlName=\"access_key\"\n                            placeholder=\"Access Key\"\n                        />\n                        <mat-error>Access Key is required</mat-error>\n                    </mat-form-field>\n                </div>\n                <div class=\"flex-1 flex flex-col\">\n                    <label for=\"access-secret\">Access Secret</label>\n                    <mat-form-field appearance=\"outline\">\n                        <input\n                            matInput\n                            name=\"access-secret\"\n                            formControlName=\"access_secret\"\n                            placeholder=\"Access Secret\"\n                        />\n                        <mat-error>Access Secret is required</mat-error>\n                    </mat-form-field>\n                </div>\n            </div>\n            <div class=\"flex flex-col\">\n                <label for=\"endpoint\">Endpoint</label>\n                <mat-form-field appearance=\"outline\">\n                    <input\n                        matInput\n                        name=\"endpoint\"\n                        formControlName=\"endpoint\"\n                        placeholder=\"Endpoint\"\n                    />\n                </mat-form-field>\n            </div>\n            <div class=\"flex flex-col\">\n                <label for=\"extensions\">Allowed File Extensions</label>\n                <mat-form-field appearance=\"outline\">\n                    <mat-select\n                        name=\"extensions\"\n                        formControlName=\"ext_filter\"\n                        placeholder=\"Allow all File Extensions\"\n                        [multiple]=\"true\"\n                    >\n                        <mat-option\n                            *ngFor=\"let ext of ALLOWED_FILE_EXTENSIONS\"\n                            [value]=\"ext\"\n                        >\n                            {{ ext }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n            <div class=\"flex flex-col \">\n                <label for=\"mime-types\">Allowed File MIME types</label>\n                <mat-form-field appearance=\"outline\">\n                    <mat-select\n                        name=\"mime-types\"\n                        formControlName=\"mime_filter\"\n                        placeholder=\"Allow all MIME Types\"\n                        [multiple]=\"true\"\n                    >\n                        <mat-option\n                            *ngFor=\"let mime of ALLOWED_MIME_TYPES\"\n                            [value]=\"mime\"\n                        >\n                            {{ mime }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n        </form>\n        <footer\n            class=\"flex items-center justify-end space-x-2 px-4 py-2 border-t border-base-200\"\n            *ngIf=\"!loading\"\n        >\n            <button btn matRipple mat-dialog-close class=\"inverse w-32\">\n                Cancel\n            </button>\n            <button btn matRipple class=\"w-32\" (click)=\"save()\">Save</button>\n        </footer>\n    `,\n    styles: [``],\n})\nexport class StorageProviderModalComponent {\n    public readonly ALLOWED_FILE_EXTENSIONS = [\n        'png',\n        'webp',\n        'bmp',\n        'jpg',\n        'jpeg',\n        'gif',\n        'svg',\n        'txt',\n        'csv',\n        'tsv',\n        'pdf',\n        'tif',\n        'tiff',\n        'mp3',\n        'ogg',\n        'rar',\n        'zip',\n        'mp4',\n        'webm',\n    ].sort((a, b) => a.localeCompare(b));\n\n    public readonly ALLOWED_MIME_TYPES = [\n        'image/png',\n        'image/webp',\n        'image/bmp',\n        'image/jpeg',\n        'image/gif',\n        'image/svg+xml',\n        'text/plain',\n        'text/csv',\n        'application/pdf',\n        'image/tiff',\n        'audio/mpeg',\n        'audio/ogg',\n        'application/vnd.rar',\n        'application/zip',\n        'video/mp4',\n        'video/webm',\n    ].sort((a, b) => a.localeCompare(b));\n    public readonly storage = this._data.item;\n    public readonly form = new FormGroup({\n        id: new FormControl(this._data.item?.id || ''),\n        authority_id: new FormControl(this._data.domain || ''),\n        storage_type: new FormControl(this._data.item?.storage_type || 's3', [\n            Validators.required,\n        ]),\n        bucket_name: new FormControl(this._data.item?.bucket_name || '', [\n            Validators.required,\n        ]),\n        region: new FormControl(this._data.item?.region || '', [\n            Validators.required,\n        ]),\n        access_key: new FormControl(this._data.item?.access_key || '', [\n            Validators.required,\n        ]),\n        access_secret: new FormControl(this._data.item?.access_secret || '', [\n            Validators.required,\n        ]),\n        endpoint: new FormControl(this._data.item?.endpoint || ''),\n        ext_filter: new FormControl(this._data.item?.ext_filter || []),\n        mime_filter: new FormControl(this._data.item?.mime_filter || []),\n    });\n    public loading = false;\n\n    constructor(\n        @Inject(MAT_DIALOG_DATA)\n        private _data: { item?: PlaceStorage; domain?: string },\n        private _dialog_ref: MatDialogRef<StorageProviderModalComponent>\n    ) {}\n\n    public async save() {\n        this.form.markAllAsTouched();\n        if (this.form.invalid) return;\n        this.loading = true;\n        this._dialog_ref.disableClose = true;\n        await saveStorage(this.form.value as PlaceStorage)\n            .toPromise()\n            .catch((e) => {\n                notifyError('Failed to save Storage Provider.');\n                this.loading = false;\n                this._dialog_ref.disableClose = false;\n                throw e;\n            });\n        this.loading = false;\n        this._dialog_ref.disableClose = false;\n        notifySuccess('Successfully saved Storage Provider.');\n        this._dialog_ref.close();\n    }\n}\n","import { Component } from '@angular/core';\nimport { PlaceDomain, queryDomains } from '@placeos/ts-client';\nimport { BehaviorSubject, combineLatest } from 'rxjs';\nimport { catchError, map, shareReplay, switchMap, tap } from 'rxjs/operators';\nimport { PlaceStorage, queryStorage, removeStorage } from './storage.fn';\nimport { MatDialog } from '@angular/material/dialog';\nimport { StorageProviderModalComponent } from './storage-provider-modal.component';\nimport { openConfirmModal } from '../../common/general';\n\n@Component({\n    selector: 'app-storage',\n    template: `\n        <div class=\"flex items-center justify-between space-x-2 my-4\">\n            <div class=\"flex flex-col space-y-2\">\n                <mat-form-field class=\"h-12\" appearance=\"outline\">\n                    <mat-select\n                        name=\"type\"\n                        [ngModel]=\"domain | async\"\n                        (ngModelChange)=\"domain.next($event)\"\n                        placeholder=\"All Domains\"\n                    >\n                        <mat-option [value]=\"{}\">All Domains</mat-option>\n                        <mat-option\n                            *ngFor=\"let domain of domain_list | async\"\n                            [value]=\"domain\"\n                        >\n                            {{ domain.name }}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n            <button btn matRipple (click)=\"edit()\">Add Storage Provider</button>\n        </div>\n        <ng-container *ngIf=\"!loading; else load_state\">\n            <div\n                class=\"w-full min-w-[40rem]\"\n                *ngIf=\"(storage_list | async)?.length; else empty_state\"\n            >\n                <div table-head>\n                    <div class=\"flex-1 p-2\">Domain</div>\n                    <div class=\"w-32 p-2\">Store Type</div>\n                    <div class=\"w-28 p-2 h-10\">Region</div>\n                    <div class=\"w-28 p-2 h-10\">Updated</div>\n                    <div class=\"w-24 p-2 h-10\"></div>\n                </div>\n                <div table-body>\n                    <div table-row *ngFor=\"let item of storage_list | async\">\n                        <div class=\"flex-1 p-2 truncate\">\n                            <a\n                                class=\"underline\"\n                                [routerLink]=\"[\n                                    '/domains',\n                                    item.authority_id || '_',\n                                    'about'\n                                ]\"\n                            >\n                                {{\n                                    item.domain?.name ||\n                                        item.authority_id ||\n                                        '[DEFAULT]'\n                                }}\n                            </a>\n                        </div>\n                        <div class=\"w-32 p-2 truncate text-xs\">\n                            <code>{{ item.storage_type }}</code>\n                        </div>\n                        <div class=\"w-28 p-2 h-12 text-xs\">\n                            <code>{{ item.region }}</code>\n                        </div>\n                        <div class=\"w-28 p-2 h-12\">\n                            {{ item.updated_at * 1000 | dateFrom }}\n                        </div>\n                        <div class=\"w-24 px-2 flex items-center justify-end \">\n                            <button\n                                btn\n                                icon\n                                class=\"h-10 w-10\"\n                                (click)=\"edit(item)\"\n                            >\n                                <app-icon\n                                    className=\"backoffice-edit\"\n                                ></app-icon>\n                            </button>\n                            <button\n                                btn\n                                icon\n                                class=\"h-10 w-10\"\n                                (click)=\"remove(item)\"\n                            >\n                                <app-icon\n                                    className=\"backoffice-trash\"\n                                ></app-icon>\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </ng-container>\n        <ng-template #empty_state>\n            <div\n                class=\"flex flex-col items-center justify-center opacity-30 p-8\"\n            >\n                <p>\n                    No storage providers for\n                    {{ domain.getValue() ? 'selected' : 'any' }} domain\n                </p>\n            </div>\n        </ng-template>\n        <ng-template #load_state>\n            <div class=\"w-full flex flex-col items-center justify-center\">\n                <mat-spinner class=\"mb-4\" [diameter]=\"48\"></mat-spinner>\n                <p>{{ loading }}</p>\n            </div>\n        </ng-template>\n    `,\n    styles: [``],\n})\nexport class StorageComponent {\n    /** Loading state */\n    public loading: string = '';\n    /** List of available domains */\n    public domain_list = queryDomains().pipe(\n        map((_) => _.data),\n        catchError((_) => []),\n        shareReplay(1)\n    );\n    /** Currently active domain */\n    public readonly domain = new BehaviorSubject<PlaceDomain>(null);\n\n    public readonly storage_data = this.domain.pipe(\n        switchMap((_) => {\n            this.loading = 'Loading Storage Providers...';\n            return queryStorage({ auth_id: _?.id });\n        }),\n        map(({ data }) => data),\n        catchError((_) => []),\n        tap((_) => (this.loading = '')),\n        shareReplay(1)\n    );\n\n    public readonly storage_list = combineLatest([\n        this.domain_list,\n        this.storage_data,\n    ]).pipe(\n        map(([domains, storage]) => {\n            if (!domains || !storage) return [];\n            return storage.map((_) => ({\n                ..._,\n                domain: domains.find((d) => d.id === _.authority_id),\n            }));\n        })\n    );\n\n    constructor(private _dialog: MatDialog) {}\n\n    public edit(item?: PlaceStorage) {\n        const ref = this._dialog.open(StorageProviderModalComponent, {\n            data: { item, domain: this.domain.getValue()?.id },\n        });\n        ref.afterClosed().subscribe(() =>\n            this.domain.next(this.domain.getValue())\n        );\n    }\n\n    public async remove(item: PlaceStorage) {\n        const resp = await openConfirmModal(\n            {\n                title: 'Remove Storage Provider',\n                content: `Are you sure you want to remove the storage provider for ${item.storage_type} ${item.bucket_name}?`,\n                icon: { content: 'delete_forever' },\n            },\n            this._dialog\n        );\n        if (resp.reason !== 'done') return;\n        resp.loading('Removing Storage Provider');\n        await removeStorage(item.id).toPromise();\n        this.domain.next(this.domain.getValue());\n        resp.close();\n    }\n}\n","import { Routes } from '@angular/router';\n\nimport { AuthorisedAdminGuard } from 'apps/backoffice/src/app/ui/guards/authorised-admin.guard';\n\nimport { PlaceComponent } from './admin.component';\nimport { PlaceDatabaseDetailsComponent } from './database-details.component';\nimport { PlaceDetailsComponent } from './details.component';\nimport { PlaceClusterDetailsComponent } from './cluster-details/cluster-details.component';\nimport { AdminInterfacesComponent } from './interfaces.component';\nimport { AdminBrokersComponent } from './brokers.component';\nimport { ExtensionOutletComponent } from '../ui/extension-outlet.component';\nimport { PlaceExtensionsComponent } from './extensions.component';\nimport { PlaceStaffAPIComponent } from './staff-api.component';\nimport { PlaceEdgeComponent } from './edge.component';\nimport { AdminSchemasComponent } from './schemas.component';\nimport { AdminAPIKeysComponent } from './api-keys/api-keys.component';\nimport { StorageComponent } from './storage/storage.component';\n\nexport const ROUTES: Routes = [\n    {\n        path: '',\n        component: PlaceComponent,\n        canActivate: [AuthorisedAdminGuard],\n        children: [\n            { path: 'about', component: PlaceDetailsComponent },\n            { path: 'database', component: PlaceDatabaseDetailsComponent },\n            { path: 'clusters', component: PlaceClusterDetailsComponent },\n            { path: 'interfaces', component: AdminInterfacesComponent },\n            { path: 'brokers', component: AdminBrokersComponent },\n            { path: 'edge', component: PlaceEdgeComponent },\n            { path: 'edge/:id', component: PlaceEdgeComponent },\n            { path: 'extensions', component: PlaceExtensionsComponent },\n            { path: 'staff-api', component: PlaceStaffAPIComponent },\n            { path: 'schemas', component: AdminSchemasComponent },\n            { path: 'api-keys', component: AdminAPIKeysComponent },\n            { path: 'upload-storage', component: StorageComponent },\n            { path: 'extend/:id', component: ExtensionOutletComponent },\n            { path: '**', redirectTo: 'about' },\n        ],\n    },\n    { path: '**', redirectTo: '' },\n];\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { RouterModule } from '@angular/router';\n\nimport { ROUTES } from './admin.routes';\nimport { SharedContentModule } from 'apps/backoffice/src/app/ui/ui.module';\n\nimport { PlaceComponent } from './admin.component';\nimport { PlaceDatabaseDetailsComponent } from './database-details.component';\nimport { PlaceDetailsComponent } from './details.component';\nimport { PlaceClusterDetailsComponent } from './cluster-details/cluster-details.component';\nimport { PlaceClusterItemComponent } from './cluster-details/cluster-item.component';\nimport { PlaceClusterTaskListComponent } from './cluster-details/cluster-task-list.component';\nimport { AdminInterfacesComponent } from './interfaces.component';\nimport { AdminBrokersComponent } from './brokers.component';\nimport { PlaceExtensionsComponent } from './extensions.component';\nimport { ExtensionModalComponent } from './extension-modal/extension-modal.component';\nimport { PlaceStaffAPIComponent } from './staff-api.component';\nimport { StaffTenantModalComponent } from './staff-tenant-modal.component';\nimport { PlaceEdgeComponent } from './edge.component';\nimport { EdgeModalComponent } from './edge-modal.component';\nimport { AdminClusterNodeComponent } from './cluster-details/cluster-node.component';\nimport { AdminSchemasComponent } from './schemas.component';\nimport { AdminAPIKeysComponent } from './api-keys/api-keys.component';\nimport { APIKeyModalComponent } from './api-keys/api-key-modal.component';\nimport { APIKeyService } from './api-keys/api-keys.service';\nimport { BookingLimitsModalComponent } from './booking-limits-modal.component';\nimport { StorageComponent } from './storage/storage.component';\nimport { StorageProviderModalComponent } from './storage/storage-provider-modal.component';\n\n@NgModule({\n    declarations: [\n        PlaceComponent,\n        PlaceDatabaseDetailsComponent,\n        PlaceDetailsComponent,\n        PlaceClusterDetailsComponent,\n        PlaceClusterItemComponent,\n        PlaceClusterTaskListComponent,\n        PlaceExtensionsComponent,\n        AdminInterfacesComponent,\n        AdminBrokersComponent,\n        ExtensionModalComponent,\n        PlaceStaffAPIComponent,\n        StaffTenantModalComponent,\n        PlaceEdgeComponent,\n        EdgeModalComponent,\n        AdminClusterNodeComponent,\n        AdminSchemasComponent,\n        AdminAPIKeysComponent,\n        APIKeyModalComponent,\n        BookingLimitsModalComponent,\n        StorageComponent,\n        StorageProviderModalComponent,\n    ],\n    imports: [\n        CommonModule,\n        FormsModule,\n        ReactiveFormsModule,\n        RouterModule.forChild(ROUTES),\n        SharedContentModule,\n    ],\n    providers: [APIKeyService],\n})\nexport class AppPlaceModule {}\n","import { Observable } from '../Observable';\nimport { async } from '../scheduler/async';\nimport { isNumeric } from '../util/isNumeric';\nexport function interval(period = 0, scheduler = async) {\n    if (!isNumeric(period) || period < 0) {\n        period = 0;\n    }\n    if (!scheduler || typeof scheduler.schedule !== 'function') {\n        scheduler = async;\n    }\n    return new Observable(subscriber => {\n        subscriber.add(scheduler.schedule(dispatch, period, { subscriber, counter: 0, period }));\n        return subscriber;\n    });\n}\nfunction dispatch(state) {\n    const { subscriber, counter, period } = state;\n    subscriber.next(counter);\n    this.schedule({ subscriber, counter: counter + 1, period }, period);\n}\n"],"x_google_ignoreList":[19,20,30]}