"use strict";(self.webpackChunkbackoffice=self.webpackChunkbackoffice||[]).push([[786],{3786:(fe,J,r)=>{r.r(J),r.d(J,{AppPlaceModule:()=>Co});var _=r(6575),c=r(987),O=r(9794),G=r(4246),I=r(4424),N=r(2941),E=r(5375),S=r(3540),$=r(3346),te=r(458),e=r(163),T=r(5997),ge=r(5694),he=r(8771);const Ae=n=>["/admin",n];function Te(n,s){if(1&n&&(e.TgZ(0,"a",11),e._UZ(1,"app-icon",12),e.TgZ(2,"span",13),e._uU(3),e.qZA()()),2&n){const t=s.$implicit;e.Q6J("routerLink",e.VKq(3,Ae,t.id)),e.xp6(1),e.Q6J("icon",t.icon),e.xp6(2),e.Oqu(t.name)}}function xe(n,s){1&n&&e._UZ(0,"app-debug-output",14)}function ve(n,s){1&n&&e._UZ(0,"app-debug-output",15)}let Ce=(()=>{class n extends I.c{get extensions(){return(0,N.fq)(this._service.active_item,"admin")}get dark_mode(){return this._users.dark_mode}get debug_position(){return this._debug.position}updateTabList(){this.tab_list=[{id:"about",name:"About",icon:{class:"backoffice-info"}},{id:"database",name:"Database",icon:{class:"backoffice-database"}},{id:"clusters",name:"Clusters",icon:{class:"backoffice-server"}},{id:"edge",name:"Edges",icon:{class:"backoffice-server"}},{id:"interfaces",name:"Interfaces",icon:{class:"backoffice-browser"}},{id:"brokers",name:"MQTT Brokers",icon:{class:"backoffice-server"}},{id:"staff-api",name:"Staff API",icon:{class:"backoffice-gist"}},{id:"extensions",name:"Extensions",icon:{class:"backoffice-gist"}},{id:"api-keys",name:"API Keys",icon:{class:"backoffice-key"}},{id:"schemas",name:"Custom Schemas",icon:{class:"backoffice-list"}},{id:"upload-storage",name:"Upload Storage",icon:{class:"backoffice-upload"}}].concat(this.extensions)}constructor(t,o,i,a){super(),this._settings=t,this._service=o,this._users=i,this._debug=a,this.tab_list=[],this.open_menu=!1}ngOnInit(){this._settings.title="Admin",this.updateTabList()}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36($.g),e.Y36(S.L),e.Y36(te.w),e.Y36(E.i))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-engine"]],features:[e.qOj],decls:12,vars:4,consts:[[1,"absolute","inset-0","flex","items-center","divide-y","sm:divide-y-0","sm:divide-x","divide-base-200","bg-base-100"],[1,"sm:h-full",3,"open","openChange"],[1,"flex","flex-col","h-full","flex-1","overflow-hidden","w-px"],[1,"flex","flex-1","z-0","h-1/2"],[1,"h-full","relative","sm:w-56","px-2","my-4","border-r","border-base-200","z-10","pt-10","sm:pt-0"],["class","flex items-center space-x-2 m-2 rounded h-8 px-3 hover:bg-base-200","routerLinkActive","active",3,"routerLink",4,"ngFor","ngForOf"],[1,"relative","flex-1","w-1/2","h-full","z-0","px-4","overflow-auto"],["btn","","icon","",1,"sm:hidden","mr-2","absolute","top-2","left-4","z-40",3,"click"],["className","backoffice-menu"],["below","",4,"ngIf"],["side","","class","h-full max-w-[30rem]",4,"ngIf"],["routerLinkActive","active",1,"flex","items-center","space-x-2","m-2","rounded","h-8","px-3","hover:bg-base-200",3,"routerLink"],[3,"icon"],[1,"hidden","sm:block"],["below",""],["side","",1,"h-full","max-w-[30rem]"]],template:function(o,i){1&o&&(e.TgZ(0,"div",0)(1,"sidebar-menu",1),e.NdJ("openChange",function(l){return i.open_menu=l}),e.qZA(),e.TgZ(2,"div",2)(3,"div",3)(4,"div",4),e.YNc(5,Te,4,5,"a",5),e.qZA(),e.TgZ(6,"div",6),e._UZ(7,"router-outlet"),e.qZA(),e.TgZ(8,"button",7),e.NdJ("click",function(){return i.open_menu=!0}),e._UZ(9,"app-icon",8),e.qZA()(),e.YNc(10,xe,1,0,"app-debug-output",9),e.qZA(),e.YNc(11,ve,1,0,"app-debug-output",10),e.qZA()),2&o&&(e.xp6(1),e.Q6J("open",i.open_menu),e.xp6(4),e.Q6J("ngForOf",i.tab_list),e.xp6(5),e.Q6J("ngIf","below"===i.debug_position),e.xp6(1),e.Q6J("ngIf","side"===i.debug_position))},dependencies:[_.sg,_.O5,O.lC,O.rH,O.Od,T.o,ge.z,he.V],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%}.active[_ngcontent-%COMP%]{background-color:var(--s)!important;color:var(--sc);margin-right:-1px}\n\n/*# sourceMappingURL=admin.component.ts-angular-inline--60.css.map*/"]})}return n})();var d=r(5530);let Ze=(()=>{class n extends I.c{reindex(t=!0){const o=`${(0,d._ds)()}/reindex${t?"?backfill=true":""}`;return(0,d.v_Q)(o,null).toPromise()}backfill(){const t=`${(0,d._ds)()}/backfill`;return(0,d.v_Q)(t,null).toPromise()}static#e=this.\u0275fac=(()=>{let t;return function(i){return(t||(t=e.n5z(n)))(i||n)}})();static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var p=r(9928),b=r(3910);function be(n,s){1&n&&(e.ynx(0),e._uU(1," Re-index "),e.BQk())}function ye(n,s){1&n&&(e.ynx(0),e._uU(1," Backfill "),e.BQk())}function Ie(n,s){1&n&&(e.TgZ(0,"div",6),e._UZ(1,"mat-spinner",7),e.qZA())}let Ne=(()=>{class n{constructor(t){this._engine_service=t}reindex(){this.reindexing=!0,this._engine_service.reindex().then(()=>this.reindexing=!1,t=>{this.reindexing=!1,(0,p.cB)(`Error reindexing database. Error: ${JSON.stringify(t.response||t.message||t)}`)})}backfill(){this.backfilling=!0,this._engine_service.backfill().then(()=>this.backfilling=!1,t=>{this.backfilling=!1,(0,p.cB)(`Error reindexing database. Error: ${JSON.stringify(t.response||t.message||t)}`)})}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(Ze))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-database-details"]],decls:17,vars:6,consts:[[1,"flex","w-full","p-4","space-x-4"],[1,"rounded","p-2","border","border-base-200","space-y-2","w-1/3","flex-1","flex","flex-col"],[1,"text-center","p-2"],["btn","",1,"w-[calc(100%-0.5rem)]",3,"disabled","click"],[4,"ngIf","ngIfElse"],["spinner",""],[1,"flex","justify-center","w-full","my-1"],["diameter","32"]],template:function(o,i){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"p",2),e._uU(3," Re-index elasticsearch for the"),e._UZ(4,"br"),e._uU(5,"current state of the database "),e.qZA(),e.TgZ(6,"button",3),e.NdJ("click",function(){return i.reindex()}),e.YNc(7,be,2,0,"ng-container",4),e.qZA()(),e.TgZ(8,"div",1)(9,"p",2),e._uU(10," Backfill elasticsearch with the"),e._UZ(11,"br"),e._uU(12,"current state of the database "),e.qZA(),e.TgZ(13,"button",3),e.NdJ("click",function(){return i.backfill()}),e.YNc(14,ye,2,0,"ng-container",4),e.qZA()()(),e.YNc(15,Ie,2,0,"ng-template",null,5,e.W1O)),2&o){const a=e.MAs(16);e.xp6(6),e.Q6J("disabled",i.reindexing),e.xp6(1),e.Q6J("ngIf",!i.reindexing)("ngIfElse",a),e.xp6(6),e.Q6J("disabled",i.backfilling),e.xp6(1),e.Q6J("ngIf",!i.backfilling)("ngIfElse",a)}},dependencies:[_.O5,b.Ou],styles:["[_nghost-%COMP%]{padding-top:1em;display:flex;flex-wrap:wrap}button[_ngcontent-%COMP%]{min-width:10em;margin:.25em}mat-card[_ngcontent-%COMP%]{margin:.5em;text-align:center}\n\n/*# sourceMappingURL=database-details.component.ts-angular-inline--61.css.map*/"]})}return n})();var u=r(1670),q=r(515),Ee=r(5705),M=r(3759),ne=r(4026),f=r(6861);function Me(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",21),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.changelog(i.backoffice_logs))}),e._uU(1," View Changelog "),e.qZA()}}function Pe(n,s){if(1&n&&(e.TgZ(0,"code"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(t.backend_version)}}function Se(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",21),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.changelog(i.changelog_data))}),e._uU(1," View Changelog "),e.qZA()}}function Oe(n,s){if(1&n&&(e.TgZ(0,"div",23)(1,"h3",24),e._uU(2),e.qZA(),e.TgZ(3,"div",25)(4,"label",26),e._uU(5,"Commit Hash"),e.qZA(),e.TgZ(6,"code"),e._uU(7),e.ALo(8,"slice"),e.qZA()(),e.TgZ(9,"div",25)(10,"label",26),e._uU(11,"Version"),e.qZA(),e.TgZ(12,"code"),e._uU(13),e.qZA()(),e.TgZ(14,"div",25)(15,"label",26),e._uU(16,"Build time"),e.qZA(),e.TgZ(17,"div",27),e._uU(18),e.ALo(19,"date"),e.qZA()(),e.TgZ(20,"div",28)(21,"label",26),e._uU(22,"Platform"),e.qZA(),e.TgZ(23,"code"),e._uU(24),e.qZA()()()),2&n){const t=s.$implicit;e.xp6(2),e.hij(" ",t.service," "),e.xp6(5),e.hij(" ",e.Dn7(8,5,t.commit,0,8)," "),e.xp6(6),e.hij(" ",t.version," "),e.xp6(5),e.hij(" ",e.xi3(19,9,t.build_time,"MMM d, y, h:mm a")," "),e.xp6(6),e.hij(" ",t.platform_version," ")}}function we(n,s){if(1&n&&(e.ynx(0),e.YNc(1,Oe,25,12,"div",22),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.api_details)}}function ke(n,s){1&n&&(e.TgZ(0,"div",29)(1,"div",30),e._uU(2," No API service details available. "),e.qZA()())}let Ue=(()=>{class n extends I.c{get user(){return this._users.user}get backoffice_version(){return q.q?.stamp||""}get backoffice_tag(){return q.q?.tag||""}get backoffice_hash(){return q.q?.hash||""}get backoffice_build(){return`${(0,ne.Z)(q.q.time,"dd MMM yyyy")} at ${(0,ne.Z)(q.q.time," h:mma")}`}constructor(t,o,i){super(),this._users=t,this._dialog=o,this._cdr=i,this.api_details=[],this.changelog_data="",this.backend_version="",this.backoffice_logs=""}ngOnInit(){this.loadApiDetails(),this.loadPlatformDetails()}changelog(t){this._dialog.open(Ee.n,{data:{changelog:t}})}copy(t,o){(0,M.vQ)(o),(0,p.QD)(`Copied ${t} to clipboard`)}loadApiDetails(){var t=this;return(0,u.Z)(function*(){const o=yield(0,d.U2M)(`${(0,d._ds)()}/cluster/versions`).toPromise().catch(i=>(0,p.cB)(`Error loading API details. Error: ${JSON.stringify(i.response||i.message||i)}`));t.api_details=o||[],t._cdr.detectChanges()})()}loadPlatformDetails(){var t=this;return(0,u.Z)(function*(){const{changelog:o,version:i}=yield(0,d.U2M)(`${(0,d._ds)()}/platform`).toPromise().catch(a=>{throw(0,p.cB)(`Error loading API details. Error: ${JSON.stringify(a.response||a.message||a)}`),a});t.changelog_data=o.replace("# Changelog\n\n",""),t.backend_version=i,t.backoffice_logs=yield(yield fetch("https://raw.githubusercontent.com/PlaceOS/backoffice/develop/CHANGELOG.md")).text()})()}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(te.w),e.Y36(f.uw),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-engine-details"]],features:[e.qOj],decls:31,vars:9,consts:()=>{let t,o,i,a,l;return t=$localize`:@@backoffice␟79db66104f7c9b710f7d23dba15d890f9536cc15␟724361024473937729: Application Details (Backoffice) `,o=$localize`:@@version␟ca17606ffe979fb5b411861280c33d2ad3e7a216␟6791662619770759914:Version:`,i=$localize`:@@commitHash␟d7f702c34df541537a2a188810a28d361a2cb09e␟8250617165434775274:Commit Hash:`,a=$localize`:@@buildTime␟401b32daa4e71a24498df7b26a72153805508074␟2870652620203683834:Build:`,l=$localize`:@@apiHeader␟a47f07776d66d3f78c5e90de066700070806d08b␟3679395425024031606: API Services `,[[1,"flex","items-center","space-x-2"],[1,"text-lg","font-medium"],t,["class","p-2 text-xs underline",3,"click",4,"ngIf"],[1,"space-y-2","mb-4","flex","flex-col","px-2"],[1,"flex","items-center"],["for","version",1,"w-24"],o,["name","version",3,"click"],["name","tag",1,"ml-2",3,"click"],["for","hash",1,"w-24"],i,["name","hash",3,"click"],["for","build-time",1,"w-24"],a,["name","build-time",1,"text-sm",3,"click"],l,[4,"ngIf"],[1,"flex","flex-wrap","py-2"],[4,"ngIf","ngIfElse"],["empty_state",""],[1,"p-2","text-xs","underline",3,"click"],["class","bg-base-100  rounded border border-base-200  m-2 min-w-[40%] flex-1 overflow-hidden",4,"ngFor","ngForOf"],[1,"bg-base-100","rounded","border","border-base-200","m-2","min-w-[40%]","flex-1","overflow-hidden"],[1,"w-full","px-4","py-2","mb-1","border-b","border-base-200","mono"],[1,"flex","items-center","px-4","py-1","hover:bg-base-200/20"],[1,"w-24"],[1,"text-sm"],[1,"flex","items-center","px-4","py-1","hover:bg-base-200/20","mb-1"],[1,"w-full","p-24","flex","flex-col","items-center","justify-center"],[1,"p-4","border","rounded-lg","bg-base-200","opacity-60"]]},template:function(o,i){if(1&o&&(e.TgZ(0,"div",0)(1,"h3",1),e.SDv(2,2),e.qZA(),e.YNc(3,Me,2,0,"button",3),e.qZA(),e.TgZ(4,"section",4)(5,"div",5)(6,"label",6),e.SDv(7,7),e.qZA(),e.TgZ(8,"code",8),e.NdJ("click",function(){return i.copy("version",i.backoffice_version)}),e._uU(9),e.qZA(),e.TgZ(10,"code",9),e.NdJ("click",function(){return i.copy("tag",i.backoffice_tag)}),e._uU(11),e.qZA()(),e.TgZ(12,"div",5)(13,"label",10),e.SDv(14,11),e.qZA(),e.TgZ(15,"code",12),e.NdJ("click",function(){return i.copy("hash",i.backoffice_hash)}),e._uU(16),e.qZA()(),e.TgZ(17,"div",5)(18,"label",13),e.SDv(19,14),e.qZA(),e.TgZ(20,"div",15),e.NdJ("click",function(){return i.copy("build time",i.backoffice_build)}),e._uU(21),e.qZA()()(),e.TgZ(22,"div",0)(23,"div",1),e.SDv(24,16),e.qZA(),e.YNc(25,Pe,2,1,"code",17)(26,Se,2,0,"button",3),e.qZA(),e.TgZ(27,"section",18),e.YNc(28,we,2,1,"ng-container",19),e.qZA(),e.YNc(29,ke,3,0,"ng-template",null,20,e.W1O)),2&o){const a=e.MAs(30);e.xp6(3),e.Q6J("ngIf",i.backoffice_logs),e.xp6(6),e.hij(" ",i.backoffice_version," "),e.xp6(2),e.hij(" ",i.backoffice_tag," "),e.xp6(5),e.hij(" ",i.backoffice_hash," "),e.xp6(5),e.hij(" ",i.backoffice_build," "),e.xp6(4),e.Q6J("ngIf",i.backend_version),e.xp6(1),e.Q6J("ngIf",i.changelog_data),e.xp6(2),e.Q6J("ngIf",i.api_details.length>0)("ngIfElse",a)}},dependencies:[_.sg,_.O5,_.OU,_.uU],styles:["[_nghost-%COMP%]{position:absolute;top:0;left:0;padding:1rem;width:100%;height:100%;overflow:auto}\n\n/*# sourceMappingURL=details.component.ts-angular-inline--62.css.map*/"]})}return n})();var Fe=r(1062),oe=r(5046),w=r(6520),U=r(8175),g=r(7422),X=r(5746),qe=r(7827),D=r(8497),v=r(257),De=r(9677);const Le=["chart"];let Je=(()=>{class n{constructor(){this.points=[]}get used_memory(){return(0,d.VDv)(1024*(this.node?.memory_usage||0))}get total_memory(){return(0,d.VDv)(1024*(this.node?.memory_total||0))}get memory_percentage(){return(this.node?.memory_usage||0)/(this.node?.memory_total||1)*100}ngOnInit(){this.generateCharts()}ngOnChanges(t){t.history&&this.history&&this.generateCharts()}generateCharts(){const t=[...this.history];for(;t.length<12;)t.unshift({});const o=t.slice(Math.max(0,t.length-12)).map((i,a)=>({x:a,y:i.value||0}));this.points=[...o]}static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["admin-cluster-node"]],viewQuery:function(o,i){if(1&o&&e.Gf(Le,7),2&o){let a;e.iGM(a=e.CRH())&&(i._chart_el=a.first)}},inputs:{node:"node",history:"history"},features:[e.TTD],decls:18,vars:6,consts:()=>{let t,o;return t=$localize`:@@cluserMemoryUsed␟aae92475915adb7cead3b32b846da601b94c5d79␟6834759780243751943: Memory Used `,o=$localize`:@@clusterCpuUsage␟6e5f806667d8c63b5716b1959c0cf07babd739f1␟3236008470518102616:CPU Usage`,[[1,"mb-2","h-40","w-64"],["basic-line-graph","",3,"points"],[1,"memory-utilisation"],[1,"flex","items-center","justify-between","space-x-2","p-2","text-left"],[1,"w-28"],t,[1,"value","flex-1","text-right","flex","space-x-2"],[1,"flex","items-center","justify-between","space-x-2","bg-base-200","rounded","p-2","text-left"],o]},template:function(o,i){1&o&&(e.TgZ(0,"h4"),e._uU(1),e.qZA(),e.TgZ(2,"div",0),e._UZ(3,"div",1),e.qZA(),e.TgZ(4,"div",2)(5,"div",3)(6,"label",4),e.SDv(7,5),e.qZA(),e.TgZ(8,"div",6)(9,"code"),e._uU(10),e.qZA(),e.TgZ(11,"code"),e._uU(12),e.qZA()()(),e.TgZ(13,"div",7)(14,"label",4),e.SDv(15,8),e.qZA(),e.TgZ(16,"code"),e._uU(17),e.qZA()()()),2&o&&(e.xp6(1),e.Oqu(null==i.node?null:i.node.hostname),e.xp6(2),e.Q6J("points",i.points),e.xp6(7),e.AsE("",i.used_memory," / ",i.total_memory,""),e.xp6(2),e.hij(" ",i.memory_percentage.toFixed(2),"% "),e.xp6(5),e.hij(" ",null==i.node?null:i.node.total_cpu,"% "))},dependencies:[De.C],encapsulation:2})}return n})();const $e=()=>[];function Re(n,s){if(1&n&&(e.ynx(0),e._UZ(1,"admin-cluster-node",1),e.BQk()),2&n){const t=s.$implicit,o=e.oxw();e.xp6(1),e.Q6J("node",t)("history",o.cpu_history[t.hostname]||e.DdM(2,$e))}}let Ke=(()=>{class n{constructor(){this.cpu_history={}}ngOnChanges(t){t.cluster&&this.cluster&&(this.cluster_nodes=[this.cluster,...this.cluster.edge_nodes],this.cpu_history=this.cpu_history||{})}static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["engine-cluster-item"]],inputs:{cluster:"cluster",cpu_history:"cpu_history"},features:[e.TTD],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"node","history"]],template:function(o,i){1&o&&e.YNc(0,Re,2,3,"ng-container",0),2&o&&e.Q6J("ngForOf",i.cluster_nodes)},dependencies:[_.sg,Je]})}return n})();var j=r(5340),C=r(462),R=r(9681),F=r(8159),Z=r(680),A=r(1268),k=r(9674),Qe=r(4620);function Be(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",18)(1,"div",19),e._UZ(2,"code",20),e.ALo(3,"driverFormat"),e.qZA(),e.TgZ(4,"div",21),e._uU(5),e.qZA(),e.TgZ(6,"div",21),e._uU(7),e.qZA(),e.TgZ(8,"div",21),e._uU(9),e.qZA(),e.TgZ(10,"div",22)(11,"button",1),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.confirmKillProcess(a))}),e._UZ(12,"app-icon",23),e.qZA()()()}if(2&n){const t=s.$implicit;e.xp6(1),e.Q6J("title",t.id),e.xp6(1),e.Q6J("innerHTML",e.lcZ(3,5,t.id),e.oJD),e.xp6(3),e.hij(" ",t.cpu_usage.toFixed(2),"% "),e.xp6(2),e.hij(" ",t.used_memory," "),e.xp6(2),e.hij(" ",t.module_instances," ")}}function Ge(n,s){if(1&n&&(e.TgZ(0,"div",11)(1,"div",12)(2,"div",13),e._uU(3,"Name"),e.qZA(),e.TgZ(4,"div",14),e._uU(5,"CPU %"),e.qZA(),e.TgZ(6,"div",14),e._uU(7,"Memory"),e.qZA(),e.TgZ(8,"div",14),e._uU(9,"Instances"),e.qZA(),e._UZ(10,"div",15),e.qZA(),e.TgZ(11,"div",16),e.YNc(12,Be,13,7,"div",17),e.ALo(13,"async"),e.qZA()()),2&n){const t=e.oxw();e.xp6(12),e.Q6J("ngForOf",e.lcZ(13,1,t.filtered_list))}}function Xe(n,s){1&n&&(e.TgZ(0,"div",24)(1,"p"),e.SDv(2,25),e.qZA()())}const je=()=>({type:"icon",class:"backoffice-arrow-left"});let Ye=(()=>{class n extends I.c{constructor(t){super(),this._dialog=t,this.close=new e.vpe,this.column_list=["id","cpu_usage","memory_usage","module_instances","running"],this.filter=new C.X(""),this._poll=new C.X(0),this.process_list=this._poll.pipe((0,oe.h)(()=>!this.loading),(0,w.w)(()=>(this.loading=!0,(0,d.X8f)(this.cluster.id,{include_status:!0}).pipe((0,U.K)(o=>(console.error(o),(0,R.of)([])))))),(0,g.U)(o=>(o||[]).sort((i,a)=>a.module_instances-i.module_instances)),(0,X.b)(()=>this.loading=!1),(0,Z.d)(1)),this.filtered_list=(0,F.aj)([this.filter,this.process_list]).pipe((0,g.U)(([o,i])=>i.filter(a=>a.id.toLowerCase().includes(o.toLowerCase()))),(0,Z.d)(1))}ngOnInit(){this._poll.next(Date.now()),this.interval("poll",()=>this._poll.next(Date.now()),5e3)}confirmKillProcess(t){const o=this._dialog.open(j.z,{...j.t,data:{title:"Kill process",content:`\n                    <p>Are you sure you want kill the process for "${t.id}"?</p>\n                    <p>The process will be terminated <strong>immediately</strong>.\n                    The process may be restarted after a short while.</p>\n                `,icon:{type:"icon",class:"backoffice-trash"}}});this.subscription("confirm_kill",o.componentInstance.event.subscribe(i=>{"done"===i.reason&&(this.killing=t.id,o.componentInstance.loading="Processing request...",this.killProcess(t).then(()=>{this.killing=null,o.close()},a=>{o.componentInstance.loading=null,this.killing=null,(0,p.cB)(`Error killing process. Error: ${JSON.stringify(a.response||a.message||a)}`),o.close()}))}))}killProcess(t){return(0,d.qx2)(this.cluster.id,t.id).toPromise()}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(f.uw))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["engine-cluster-task-list"]],inputs:{cluster:"cluster"},outputs:{close:"close"},features:[e.qOj],decls:13,vars:8,consts:()=>{let t,o;return t=$localize`:@@clusterHeader␟2837d97a9e0e3c660f026394ec40fe8e4ba4e592␟2012083462068270549: Cluster - ${"\ufffd0\ufffd"}:INTERPOLATION: `,o=$localize`:@@processTableEmpty␟9f96a52f0ede1cccf0177605958427b397bea944␟702517565059377669:No tasks running on cluster`,[[1,"flex","items-center","mb-4"],["btn","","icon","",3,"click"],[3,"icon"],[1,"text-lg","font-medium"],t,[1,"flex-1"],["appearance","outline",1,"h-12"],["matPrefix","","className","backoffice-magnifying-glass"],["matInput","","placeholder","Filter processes...",3,"ngModel","ngModelChange"],["role","table","class","h-1/2 flex-1",4,"ngIf","ngIfElse"],["empty_state",""],["role","table",1,"h-1/2","flex-1"],["table-head",""],[1,"flex-1","p-2"],[1,"w-24","p-2"],[1,"w-12","p-2"],["table-body",""],["table-row","",4,"ngFor","ngForOf"],["table-row",""],[1,"flex-1","p-2",3,"title"],[1,"truncate",3,"innerHTML"],[1,"w-24","p-2","text-right","justify-end"],[1,"w-12","flex","items-center","justify-center"],["className","backoffice-trash"],[1,"flex","flex-col","items-center","p-8"],o]},template:function(o,i){if(1&o&&(e.TgZ(0,"div",0)(1,"button",1),e.NdJ("click",function(){return i.close.emit()}),e._UZ(2,"app-icon",2),e.qZA(),e.TgZ(3,"h3",3),e.SDv(4,4),e.qZA(),e._UZ(5,"div",5),e.TgZ(6,"mat-form-field",6),e._UZ(7,"app-icon",7),e.TgZ(8,"input",8),e.NdJ("ngModelChange",function(l){return i.filter.next(l)}),e.qZA()()(),e.YNc(9,Ge,14,3,"div",9),e.ALo(10,"async"),e.YNc(11,Xe,3,0,"ng-template",null,10,e.W1O)),2&o){const a=e.MAs(12);let l;e.xp6(2),e.Q6J("icon",e.DdM(7,je)),e.xp6(2),e.pQV(null==i.cluster?null:i.cluster.hostname),e.QtT(4),e.xp6(4),e.Q6J("ngModel",i.filter.getValue()),e.xp6(1),e.Q6J("ngIf",null==(l=e.lcZ(10,5,i.filtered_list))?null:l.length)("ngIfElse",a)}},dependencies:[_.sg,_.O5,c.Fj,c.JJ,c.On,T.o,A.KE,A.qo,k.Nt,_.Ov,Qe.X],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;padding:1rem;height:100%;width:100%}\n\n/*# sourceMappingURL=cluster-task-list.component.ts-angular-inline--71.css.map*/"]})}return n})();const He=()=>[];function ze(n,s){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"mat-card",5)(2,"mat-card-header")(3,"mat-card-title",6),e._uU(4),e.qZA()(),e.TgZ(5,"mat-card-content"),e._UZ(6,"engine-cluster-item",7),e.qZA(),e.TgZ(7,"mat-card-actions")(8,"button",8),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw(3);return e.KtG(l.active_cluster=a)}),e.SDv(9,9),e.qZA()()(),e.BQk()}if(2&n){const t=s.$implicit,o=e.oxw(3);e.xp6(4),e.hij("",t.hostname||"Undefined Cluster"," "),e.xp6(2),e.Q6J("cluster",t)("cpu_history",o.cpu_history[t.id]||e.DdM(3,He))}}function Ve(n,s){if(1&n&&(e.ynx(0),e.YNc(1,ze,10,4,"ng-container",4),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.cluster_list)}}function We(n,s){if(1&n&&(e.ynx(0),e.YNc(1,Ve,2,1,"ng-container",1),e.BQk()),2&n){const t=e.oxw(),o=e.MAs(5);e.xp6(1),e.Q6J("ngIf",!t.active_cluster)("ngIfElse",o)}}function et(n,s){1&n&&(e.TgZ(0,"div",10)(1,"app-icon",11),e._uU(2,"close"),e.qZA(),e.TgZ(3,"div",12),e.SDv(4,13),e.qZA()())}function tt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"engine-cluster-task-list",14),e.NdJ("close",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.active_cluster=null)}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("cluster",t.active_cluster)}}let nt=(()=>{class n extends I.c{constructor(){super(...arguments),this.cluster_list=[],this.cpu_history={},this.clusters$=(0,qe.F)(2e3).pipe((0,Fe.O)(0),(0,oe.h)(()=>!this.active_cluster&&!this.loading),(0,w.w)(()=>(this.loading=!0,(0,d.rEJ)({include_status:!0}).pipe((0,U.K)(t=>({data:[]}))))),(0,g.U)(t=>t.data),(0,g.U)(t=>{this.cluster_list=t||[];const o=Date.now();this.cluster_list.forEach(i=>{this.cpu_history[i.id]||(this.cpu_history[i.id]={});const a=[i,...i.edge_nodes];for(const l of a)this.cpu_history[i.id][l.hostname]||(this.cpu_history[i.id][l.hostname]=[]),this.cpu_history[i.id][l.hostname].push({id:o,value:l.core_cpu}),this.cpu_history[i.id][l.hostname].length>120&&this.cpu_history[i.id][l.hostname].shift()})}),(0,X.b)(()=>this.loading=!1))}ngOnInit(){this.subscription("load_cluster",this.clusters$.subscribe())}static#e=this.\u0275fac=(()=>{let t;return function(i){return(t||(t=e.n5z(n)))(i||n)}})();static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["engine-cluster-details"]],features:[e.qOj],decls:6,vars:2,consts:()=>{let t,o;return t=$localize`:@@viewClusterProcesses␟932e92be8259d8b34de2a992839ed6e5426bc22a␟2919581239059220567: View Processes `,o=$localize`:@@clusterListEmpty␟d2439117e1e3b740500ee9adc477711383f33d30␟7110510397716287271: No Cluster details to show `,[[1,"flex","flex-wrap","overflow-auto","max-h-full"],[4,"ngIf","ngIfElse"],["empty_state",""],["process_state",""],[4,"ngFor","ngForOf"],[1,"m-2","text-center"],["clas","capitalize"],[3,"cluster","cpu_history"],["btn","","matRipple","",1,"mx-2",3,"click"],t,[1,"absolute","inset-0","flex","flex-col","items-center","p-8","space-y-2"],[1,"text-3xl"],[1,"text"],o,[3,"cluster","close"]]},template:function(o,i){if(1&o&&(e.TgZ(0,"div",0),e.YNc(1,We,2,2,"ng-container",1),e.qZA(),e.YNc(2,et,5,0,"ng-template",null,2,e.W1O)(4,tt,1,1,"ng-template",null,3,e.W1O)),2&o){const a=e.MAs(3);e.xp6(1),e.Q6J("ngIf",i.cluster_list&&i.cluster_list.length)("ngIfElse",a)}},dependencies:[_.sg,_.O5,T.o,D.a8,D.hq,D.dn,D.dk,D.n5,v.wG,Ke,Ye]})}return n})();function ot(n,s){if(1&n&&(e.TgZ(0,"div",8)(1,"div",4),e._uU(2),e.qZA(),e.TgZ(3,"div",5)(4,"code"),e._uU(5),e.qZA()()()),2&n){const t=s.$implicit;e.xp6(2),e.Oqu(t.id),e.xp6(3),e.hij(" ",t.name||"~No Commit Hash~"," ")}}function it(n,s){if(1&n&&(e.TgZ(0,"div",2)(1,"div",3)(2,"div",4),e._uU(3,"Repository"),e.qZA(),e.TgZ(4,"div",5),e._uU(5,"Commit Hash"),e.qZA()(),e.TgZ(6,"div",6),e.YNc(7,ot,6,2,"div",7),e.qZA()()),2&n){const t=e.oxw();e.xp6(7),e.Q6J("ngForOf",t.interfaces)}}function at(n,s){1&n&&(e.TgZ(0,"div",9),e._UZ(1,"app-icon",10),e.TgZ(2,"p"),e._uU(3,"No interfaces"),e.qZA()())}let st=(()=>{class n{constructor(){this.interfaces=[]}ngOnInit(){this.loadInterfaces()}loadInterfaces(){var t=this;return(0,u.Z)(function*(){const o=yield(0,d.BmL)().toPromise();t.interfaces=Object.keys(o).map(i=>({id:i,name:o[i]})),t.interfaces.sort((i,a)=>`${i.id}`?.localeCompare(`${a.id}`))})()}static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-interfaces"]],decls:3,vars:2,consts:[["role","table","class","pt-4",4,"ngIf","ngIfElse"],["load_state",""],["role","table",1,"pt-4"],["table-head",""],[1,"flex-1","p-2"],[1,"w-[20rem]","p-2"],["table-body",""],["table-row","",4,"ngFor","ngForOf"],["table-row",""],[1,"flex","flex-col","items-center","p-8"],["className","backoffice-cross",1,"mb-4"]],template:function(o,i){if(1&o&&e.YNc(0,it,8,1,"div",0)(1,at,4,0,"ng-template",null,1,e.W1O),2&o){const a=e.MAs(2);e.Q6J("ngIf",i.interfaces&&i.interfaces.length)("ngIfElse",a)}},dependencies:[_.sg,_.O5,T.o],styles:["[_nghost-%COMP%]{width:100%;height:100%}\n\n/*# sourceMappingURL=interfaces.component.ts-angular-inline--63.css.map*/"]})}return n})();var ie=r(9134);const lt=()=>({class:"backoffice-edit"}),ct=()=>({class:"backoffice-trash"});function rt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",16)(1,"div",9),e._uU(2),e.qZA(),e.TgZ(3,"div",10),e._uU(4," "),e.SDv(5,17),e._uU(6," "),e.qZA(),e.TgZ(7,"div",11),e._uU(8),e.qZA(),e.TgZ(9,"div",12),e._uU(10),e.qZA(),e.TgZ(11,"div",13),e._uU(12),e.qZA(),e.TgZ(13,"div",13),e._uU(14," "),e.SDv(15,18),e._uU(16," "),e.qZA(),e.TgZ(17,"div",9),e._uU(18),e.ALo(19,"json"),e.qZA(),e.TgZ(20,"div",19)(21,"button",20),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.editBroker(a))}),e._UZ(22,"app-icon",21),e.qZA(),e.TgZ(23,"button",20),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.deleteBroker(a))}),e._UZ(24,"app-icon",21),e.qZA()()()}if(2&n){const t=s.$implicit;e.xp6(2),e.Oqu(t.name),e.xp6(3),e.pQV(t.auth_type),e.QtT(5),e.xp6(3),e.Oqu(t.description),e.xp6(2),e.Oqu(t.host),e.xp6(2),e.Oqu(t.port),e.xp6(3),e.pQV(t.tls),e.QtT(15),e.xp6(3),e.Oqu(e.lcZ(19,9,t.filters)),e.xp6(4),e.Q6J("icon",e.DdM(11,lt)),e.xp6(2),e.Q6J("icon",e.DdM(12,ct))}}function _t(n,s){if(1&n&&(e.TgZ(0,"div",7)(1,"div",8)(2,"div",9),e._uU(3,"Name"),e.qZA(),e.TgZ(4,"div",10),e._uU(5,"Auth Type"),e.qZA(),e.TgZ(6,"div",11),e._uU(7,"Description"),e.qZA(),e.TgZ(8,"div",12),e._uU(9,"Host"),e.qZA(),e.TgZ(10,"div",13),e._uU(11,"Port"),e.qZA(),e.TgZ(12,"div",13),e._uU(13,"TLS"),e.qZA(),e.TgZ(14,"div",9),e._uU(15,"Filters"),e.qZA(),e._UZ(16,"div",10),e.qZA(),e.TgZ(17,"div",14),e.YNc(18,rt,25,13,"div",15),e.qZA()()),2&n){const t=e.oxw();e.xp6(18),e.Q6J("ngForOf",t.brokers)}}function dt(n,s){1&n&&(e.TgZ(0,"div",22)(1,"p"),e._uU(2,"No Brokers"),e.qZA()())}let mt=(()=>{class n extends I.c{constructor(t){super(),this._dialog=t,this.brokers=[]}ngOnInit(){this.loadBrokers()}newBroker(){const t=this._dialog.open(ie.K,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:new d.w4u,name:"Broker",save:o=>(0,d.z0G)(o)}});this.subscription("modal_events",t.componentInstance.event.subscribe(o=>{"done"===o.reason&&this.loadBrokers()}))}editBroker(t){const o=this._dialog.open(ie.K,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:t,name:"Broker",save:i=>(0,d.VTA)(i.id,i)}});this.subscription("modal_events",o.componentInstance.event.subscribe(i=>{"done"===i.reason&&this.loadBrokers()}))}deleteBroker(t){var o=this;return(0,u.Z)(function*(){if(t){const i=yield(0,M._5)({title:"Delete MQTT Broker",content:"<p>Are you sure you want delete this boker?</p><p>The broker will be deleted <strong>immediately.</strong></p>",icon:{type:"icon",class:"backoffice-trash"}},o._dialog);if(!i)return;i.loading("Deleting broker...");const a=yield(0,d.bws)(t.id).toPromise().catch(l=>l);if(i.close(),a)return(0,p.cB)(`Error deleting broker. Error: ${JSON.stringify(a.response||a.message||a)}`);(0,p.t5)(`Successfully deleted broker "${t.name}".`),o.loadBrokers()}})()}loadBrokers(){var t=this;return(0,u.Z)(function*(){const o=yield(0,d.zOf)().pipe((0,g.U)(i=>i.data)).toPromise();t.brokers=o})()}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(f.uw))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-brokers"]],features:[e.qOj],decls:9,vars:2,consts:()=>{let t,o;return t=$localize`:␟adee30e7ac4fc6cea612033aa0e36fbd638bf9ac␟6259518065458203177:{VAR_SELECT, select, 0 {Certificate } , 2 {User Password } , other {No Auth }}`,t=e.Zx4(t,{VAR_SELECT:"\ufffd0\ufffd"}),o=$localize`:␟9a505795a50d2999edad754aef444307458115f7␟8318225782441593222:{VAR_SELECT, select, true {Yes } , false {No }}`,o=e.Zx4(o,{VAR_SELECT:"\ufffd0\ufffd"}),[["btn","",1,"my-4",3,"click"],[1,"flex","items-center"],["className","backoffice-plus"],[1,"text"],[1,"overflow-auto"],["role","table","class","min-w-[52rem]",4,"ngIf","ngIfElse"],["load_state",""],["role","table",1,"min-w-[52rem]"],["table-head",""],[1,"w-32","p-2"],[1,"w-24","p-2"],[1,"flex-1","p-2"],[1,"w-32","p-2","truncate"],[1,"w-16","p-2"],["table-body",""],["table-row","",4,"ngFor","ngForOf"],["table-row",""],t,o,[1,"w-24","p-2","flex","items-center"],["btn","","icon","",3,"click"],[3,"icon"],[1,"flex","flex-col","items-center"]]},template:function(o,i){if(1&o&&(e.TgZ(0,"button",0),e.NdJ("click",function(){return i.newBroker()}),e.TgZ(1,"div",1),e._UZ(2,"app-icon",2),e.TgZ(3,"div",3),e._uU(4,"Add Broker"),e.qZA()()(),e.TgZ(5,"div",4),e.YNc(6,_t,19,1,"div",5),e.qZA(),e.YNc(7,dt,3,0,"ng-template",null,6,e.W1O)),2&o){const a=e.MAs(8);e.xp6(6),e.Q6J("ngIf",i.brokers&&i.brokers.length)("ngIfElse",a)}},dependencies:[_.sg,_.O5,T.o,_.Ts]})}return n})();var pt=r(6497),Y=r(7627),ut=r(2426),P=r(6355);const ft=()=>({type:"icon",class:"backoffice-cross"});function gt(n,s){1&n&&(e.TgZ(0,"button",4),e._UZ(1,"app-icon",5),e.qZA()),2&n&&(e.xp6(1),e.Q6J("icon",e.DdM(1,ft)))}function ht(n,s){if(1&n&&(e.TgZ(0,"mat-option",26)(1,"span",27),e._uU(2),e.qZA()()),2&n){const t=s.$implicit;e.Q6J("value",t),e.xp6(2),e.Oqu(t)}}function At(n,s){1&n&&(e.TgZ(0,"label"),e._uU(1,"Conditions"),e.qZA())}function Tt(n,s){if(1&n&&(e.TgZ(0,"mat-option",26)(1,"span",27),e._uU(2),e.qZA()()),2&n){const t=s.$implicit;e.Q6J("value",t),e.xp6(2),e.Oqu(t)}}const H=()=>({standalone:!0}),xt=()=>({class:"backoffice-cross"});function vt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",7)(1,"div",8)(2,"mat-form-field",11)(3,"input",28),e.NdJ("ngModelChange",function(i){const l=e.CHM(t).$implicit;return e.KtG(l[0]=i)}),e.qZA()()(),e.TgZ(4,"div",8)(5,"mat-form-field",11)(6,"mat-select",29),e.NdJ("ngModelChange",function(i){const l=e.CHM(t).$implicit;return e.KtG(l[1]=i)}),e.YNc(7,Tt,3,2,"mat-option",13),e.qZA()()(),e.TgZ(8,"div",8)(9,"mat-form-field",11)(10,"input",30),e.NdJ("ngModelChange",function(i){const l=e.CHM(t).$implicit;return e.KtG(l[2]=i)}),e.qZA()()(),e.TgZ(11,"button",31),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.removeCondition(a))}),e._UZ(12,"app-icon",5),e.qZA()()}if(2&n){const t=s.$implicit,o=e.oxw(2);e.xp6(3),e.Q6J("ngModel",t[0])("ngModelOptions",e.DdM(9,H)),e.xp6(3),e.Q6J("ngModel",t[1])("ngModelOptions",e.DdM(10,H)),e.xp6(1),e.Q6J("ngForOf",o.condition_ops),e.xp6(3),e.Q6J("disabled","truthy"===t[1]||"falsy"===t[1])("ngModel",t[2])("ngModelOptions",e.DdM(11,H)),e.xp6(2),e.Q6J("icon",e.DdM(12,xt))}}function Ct(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"main",6)(1,"div",7)(2,"div",8)(3,"label",9),e.tHW(4,10),e._UZ(5,"span"),e.N_p(),e.qZA(),e.TgZ(6,"mat-form-field",11)(7,"mat-select",12),e.YNc(8,ht,3,2,"mat-option",13),e.qZA()()(),e.TgZ(9,"div",8)(10,"label",14),e.tHW(11,15),e._UZ(12,"span"),e.N_p(),e.qZA(),e.TgZ(13,"mat-form-field",11),e._UZ(14,"input",16),e.TgZ(15,"mat-error"),e.SDv(16,17),e.qZA()()()(),e.TgZ(17,"div",8)(18,"label",18),e.tHW(19,19),e._UZ(20,"span"),e.N_p(),e.qZA(),e.TgZ(21,"mat-form-field",11),e._UZ(22,"input",20),e.TgZ(23,"mat-error"),e.SDv(24,21),e.qZA()()(),e.TgZ(25,"div",22),e.YNc(26,At,2,0,"label",23)(27,vt,13,13,"div",24),e.TgZ(28,"button",25),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.addCondition())}),e._uU(29," Add Condition "),e.qZA()()()}if(2&n){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(8),e.Q6J("ngForOf",t.available_types),e.xp6(18),e.Q6J("ngIf",null==t.form.controls.conditions.value?null:t.form.controls.conditions.value.length),e.xp6(1),e.Q6J("ngForOf",t.form.controls.conditions.value)}}function Zt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"footer",32)(1,"button",33),e._uU(2,"Cancel"),e.qZA(),e.TgZ(3,"button",34),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.submit())}),e._uU(4),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(4),e.hij(" ",t.item?"Save":"Add"," [S] ")}}function bt(n,s){1&n&&(e.TgZ(0,"div",35)(1,"div",36)(2,"div",37),e._UZ(3,"mat-spinner",38),e.qZA(),e.TgZ(4,"div",39),e._uU(5,"Processing request..."),e.qZA()()())}let yt=(()=>{class n extends I.c{constructor(t,o){super(),this._data=t,this._hotkey=o,this.event=new e.vpe,this.available_types=["admin","systems","modules","zones","drivers","repositories","triggers","users","domains"],this.condition_ops=["includes","equals","truthy","falsy"],this.item=this._data.item,this.loading=!1,this.form=new c.cw({type:new c.NI("systems",[c.kI.required]),name:new c.NI("",[c.kI.required]),url:new c.NI("",[c.kI.required]),conditions:new c.NI([])})}ngOnInit(){this.subscription("save",this._hotkey.listen(["KeyS"],()=>this.submit())),this.form.patchValue(this.item)}addCondition(){this.form.controls.conditions.value.push(["","",""])}removeCondition(t){this.form.controls.conditions.setValue(this.form.controls.conditions.value.filter(o=>o!==t))}submit(){if(this.form.markAllAsTouched(),!this.form.valid)return;const t=this.form.value;t.conditions=t.conditions.filter(o=>o[0]&&o[1]),this.event.emit({reason:"done",metadata:t})}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(f.WI),e.Y36(ut.t))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["extension-modal"]],outputs:{event:"event"},features:[e.qOj],decls:8,vars:5,consts:()=>{let t,o,i,a,l,m,h,x,B;return t=$localize`:@@typeLabel␟bf3a1deab2bcaeddfcfd7782ed54db830840d950␟5706127539532094818:Type${"\ufffd#5\ufffd"}:START_TAG_SPAN:*${"\ufffd/#5\ufffd"}:CLOSE_TAG_SPAN:: `,o=$localize`:@@nameLabel␟a6b516b2a07891bc316fc0d40fd572bc7ec46f3e␟346892941642015871:Name${"\ufffd#12\ufffd"}:START_TAG_SPAN:*${"\ufffd/#12\ufffd"}:CLOSE_TAG_SPAN:: `,i=$localize`:@@extensionNamePlaceholder␟d4a3634b658f6ac93604e3078106d79a140b8f7a␟6487826043722252959:Extension Display Name`,a=$localize`:@@nameError␟7a48e7a68431ebbfa25cde40585dd405e42cd1db␟7513538297502205849:A valid name is required`,l=$localize`:@@urlLabel␟7ee18d2358331fdb6eec3d6c2b1f3f4a7a50ec76␟4688120902984071927:URL${"\ufffd#20\ufffd"}:START_TAG_SPAN:*${"\ufffd/#20\ufffd"}:CLOSE_TAG_SPAN:: `,m=$localize`:@@extensionUrlPlaceholder␟1cfc829fdf84ddffc5a47a8938119b912fd251a4␟4436431142729435103:Extension URL`,h=$localize`:@@urlError␟2456d09bc2a34c4c067354efdb9c5783efe6e0b7␟4193103363836374269:A valid URL is required`,x=$localize`:@@conditionPlaceholder␟f545fbb6b587caa70ce7d42cdbb1077844b6d749␟6760598080948557972:Condition Field`,B=$localize`:@@conditionValuePlaceholder␟81bcdbb856d39d2d033c153b3953bb340e883efd␟1069058670263181644:Condition Value`,[["btn","","icon","","mat-dialog-close","",4,"ngIf"],["class","max-h-[65vh] overflow-auto p-4",3,"formGroup",4,"ngIf","ngIfElse"],["class","border-t border-base-200 flex items-center justify-end space-x-2 p-4",4,"ngIf"],["load_state",""],["btn","","icon","","mat-dialog-close",""],[3,"icon"],[1,"max-h-[65vh]","overflow-auto","p-4",3,"formGroup"],[1,"fieldset"],[1,"field"],["for","type"],t,["appearance","outline"],["formControlName","type"],[3,"value",4,"ngFor","ngForOf"],["for","name"],o,["matInput","","name","name","placeholder",i,"formControlName","name"],a,["for","url"],l,["matInput","","name","url","placeholder",m,"formControlName","url"],h,[1,"w-full"],[4,"ngIf"],["class","fieldset",4,"ngFor","ngForOf"],["btn","",1,"w-full",3,"click"],[3,"value"],[1,"capitalize"],["matInput","","name","url","placeholder",x,3,"ngModel","ngModelOptions","ngModelChange"],["placeholder","Operation",3,"ngModel","ngModelOptions","ngModelChange"],["matInput","","name","value","placeholder",B,3,"disabled","ngModel","ngModelOptions","ngModelChange"],["btn","","icon","",3,"click"],[1,"border-t","border-base-200","flex","items-center","justify-end","space-x-2","p-4"],["btn","","mat-dialog-close","",1,"w-32","inverse"],["btn","","type","submit",1,"w-32",3,"click"],[1,"body"],[1,"info-block"],[1,"icon"],["diameter","32"],[1,"text"]]},template:function(o,i){if(1&o&&(e.TgZ(0,"header")(1,"h3"),e._uU(2),e.qZA(),e.YNc(3,gt,2,2,"button",0),e.qZA(),e.YNc(4,Ct,30,4,"main",1)(5,Zt,5,1,"footer",2)(6,bt,6,0,"ng-template",null,3,e.W1O)),2&o){const a=e.MAs(7);e.xp6(2),e.hij("",i.item?"Edit":"New"," Extension"),e.xp6(1),e.Q6J("ngIf",!i.loading),e.xp6(1),e.Q6J("ngIf",!i.loading)("ngIfElse",a),e.xp6(1),e.Q6J("ngIf",!i.loading)}},dependencies:[_.sg,_.O5,c.Fj,c.JJ,c.JL,c.On,c.sg,c.u,T.o,f.ZT,A.KE,A.TO,k.Nt,b.Ou,v.ey,P.gD],styles:[".body[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;padding:1em;width:32rem;max-width:calc(100vw - 2rem)}.icon[_ngcontent-%COMP%]{height:1.2em;width:1.2em;display:flex;align-items:center;justify-content:center;font-size:2em}.content[_ngcontent-%COMP%]{width:16rem;text-align:center;font-size:.8em}.info-block[_ngcontent-%COMP%]{margin:2em 6em}.capitalize[_ngcontent-%COMP%]{text-transform:capitalize}.fieldset[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;width:100%}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{width:auto;flex:1;min-width:25%;margin:0 .25em}@media screen and (max-width: 640px){.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{min-width:20em;margin:0}}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]:first-child{margin-left:0}.fieldset[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]:last-child{margin-right:0}.fieldset[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:.5rem}.field[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;min-width:50%;width:100%}.field[_ngcontent-%COMP%]   div.error[_ngcontent-%COMP%]{position:absolute;bottom:.5em;left:1em;color:var(--error);font-size:.7em;font-weight:500}label[_ngcontent-%COMP%]{font-size:.8em;font-weight:500;margin:.5em 0}label.error[_ngcontent-%COMP%]{color:var(--error)}label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--pending)}mat-dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:8em}"]})}return n})();const It=["app-extensions",""];function Nt(n,s){if(1&n&&(e.TgZ(0,"mat-option",12),e._uU(1),e.qZA()),2&n){const t=s.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.name," ")}}const Et=()=>({class:"backoffice-edit"}),Mt=()=>({class:"backoffice-trash"});function Pt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",21)(1,"div",22),e._uU(2),e.qZA(),e.TgZ(3,"div",16),e._uU(4),e.qZA(),e.TgZ(5,"div",17),e._uU(6),e.qZA(),e.TgZ(7,"div",18),e._uU(8),e.qZA(),e.TgZ(9,"div",23)(10,"button",24),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw(3);return e.KtG(l.editExtension(a))}),e._UZ(11,"app-icon",25),e.qZA(),e.TgZ(12,"button",24),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw(3);return e.KtG(l.removeExtension(a))}),e._UZ(13,"app-icon",25),e.qZA()()()}if(2&n){const t=s.$implicit;e.xp6(2),e.hij(" ",t.type," "),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.url),e.xp6(2),e.hij(" ",t.conditions.length," "),e.xp6(3),e.Q6J("icon",e.DdM(6,Et)),e.xp6(2),e.Q6J("icon",e.DdM(7,Mt))}}function St(n,s){if(1&n&&(e.TgZ(0,"div",13)(1,"div",14)(2,"div",15),e._uU(3,"Type"),e.qZA(),e.TgZ(4,"div",16),e._uU(5,"Name"),e.qZA(),e.TgZ(6,"div",17),e._uU(7,"URL"),e.qZA(),e.TgZ(8,"div",18),e._uU(9,"Conditions"),e.qZA(),e._UZ(10,"div",15),e.qZA(),e.TgZ(11,"div",19),e.YNc(12,Pt,14,8,"div",20),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(12),e.Q6J("ngForOf",t.extension_list)}}function Ot(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",4)(2,"label",5),e._uU(3,"Domain: "),e.qZA(),e.TgZ(4,"mat-form-field",6)(5,"mat-select",7),e.NdJ("ngModelChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.domain=i)})("ngModelChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.setDomain(i))}),e.YNc(6,Nt,2,2,"mat-option",8),e.qZA()(),e.TgZ(7,"button",9),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.editExtension())}),e._uU(8,"Add Extension"),e.qZA()(),e.TgZ(9,"div",10)(10,"p")(11,"strong"),e._uU(12,"Note:"),e.qZA(),e._uU(13," Backoffice requires a full page refresh for extension changes and additions to apply "),e.qZA()(),e.YNc(14,St,13,1,"div",11),e.qZA()}if(2&n){const t=e.oxw(),o=e.MAs(6);e.xp6(5),e.Q6J("ngModel",t.domain),e.xp6(1),e.Q6J("ngForOf",t.domain_list),e.xp6(8),e.Q6J("ngIf",t.extension_list.length)("ngIfElse",o)}}function wt(n,s){if(1&n&&(e.TgZ(0,"div",26)(1,"div",27),e._UZ(2,"mat-spinner",28),e.qZA(),e.TgZ(3,"div",29),e._uU(4),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("diameter",32),e.xp6(2),e.Oqu(t.loading)}}function kt(n,s){1&n&&(e.TgZ(0,"div",26)(1,"app-icon",30),e._uU(2,"close"),e.qZA(),e.TgZ(3,"p"),e._uU(4,"No extensions configured for this domain"),e.qZA()())}let Ut=(()=>{class n{constructor(t){this._dialog=t,this.loading="",this.extension_list=[]}ngOnInit(){var t=this;return(0,u.Z)(function*(){t.loading="Loading domains...",t.domain_list=yield(0,d.R2s)().pipe((0,g.U)(a=>a.data)).toPromise();const o=(0,d.N9E)();if(!t.domain_list?.length)return;const i=t.domain_list.find(a=>a.id===o.id);i&&t.setDomain(i),t.loading=""})()}setDomain(t){this.domain=t;const o=this.domain.config?.backoffice?.extend||{},i=[];for(const a in o)if(o[a])for(const l in o[a])o[a][l]&&i.push({...o[a][l],name:l,type:a});this.extension_list=i,this.extension_list.sort((a,l)=>a.type.localeCompare(l.type)||a.name.localeCompare(l.name))}editExtension(t){var o=this;const i=this._dialog.open(yt,{data:{item:t?JSON.parse(JSON.stringify(t)):void 0}});i.componentInstance.event.pipe((0,Y.P)(a=>"done"===a.reason)).subscribe(function(){var a=(0,u.Z)(function*(l){i.componentInstance.loading=!0,t&&(o.extension_list=o.extension_list.filter(m=>m!==t)),o.extension_list.push(l.metadata),yield o.updateDomain(),i.componentInstance.loading=!1,i.close()});return function(l){return a.apply(this,arguments)}}())}removeExtension(t){var o=this;return(0,u.Z)(function*(){const i=o._dialog.open(j.z,{data:{title:"Remove extension",content:`Are you sure you want to remove the extension "${t.name}" from ${t.type}?`,icon:{class:"backoffice-trash"}}});i.componentInstance.event.pipe((0,Y.P)(a=>"done"===a.reason)).subscribe(function(){var a=(0,u.Z)(function*(l){i.componentInstance.loading="Removing extension...",o.extension_list=o.extension_list.filter(m=>m!==t),yield o.updateDomain().catch(m=>(0,p.cB)(`Error removing extension: ${m}`)),i.componentInstance.loading="",i.close()});return function(l){return a.apply(this,arguments)}}())})()}updateDomain(){var t=this;return(0,u.Z)(function*(){const o={};for(const l of t.extension_list){o[l.type]||(o[l.type]={});const m={...l};delete m.type,delete m.name,o[l.type][l.name]=m}const i=new d.OeX({...t.domain,config:{...t.domain.config,backoffice:{...t.domain.config.backoffice||{},extend:o}}}),a=yield(0,d.gKz)(t.domain.id,i).toPromise();t.setDomain(a)})()}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(f.uw))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["","app-extensions",""]],attrs:It,decls:7,vars:2,consts:[[1,"text-lg","font-medium","mb-4","mt-4"],[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],[1,"flex","items-center","space-x-2","mb-4"],["for","type"],["appearance","outline",1,"h-12"],["name","type","placeholder","Select Domain...",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["btn","",3,"click"],[1,"bg-info","my-4","p-4","flex","items-center","rounded","shadow","space-x-4","text-sm","text-info-content"],["role","table",4,"ngIf","ngIfElse"],[3,"value"],["role","table"],["table-head",""],[1,"w-24","p-2"],[1,"w-40","p-2"],[1,"flex-1","p-2"],[1,"w-28","p-2"],["table-body",""],["table-row","",4,"ngFor","ngForOf"],["table-row",""],[1,"w-24","p-2","capitalize"],[1,"w-24","flex","items-center","justify-center"],["btn","","icon","",3,"click"],[3,"icon"],[1,"info-block"],[1,"icon"],[3,"diameter"],[1,"text"],[1,"text-3xl"]],template:function(o,i){if(1&o&&(e.TgZ(0,"h2",0),e._uU(1,"Backoffice extensions"),e.qZA(),e.YNc(2,Ot,15,4,"div",1)(3,wt,5,2,"ng-template",null,2,e.W1O)(5,kt,5,0,"ng-template",null,3,e.W1O)),2&o){const a=e.MAs(4);e.xp6(2),e.Q6J("ngIf",!i.loading)("ngIfElse",a)}},dependencies:[_.sg,_.O5,c.JJ,c.On,T.o,A.KE,b.Ou,v.ey,P.gD],styles:["[_nghost-%COMP%]{width:100%;height:100%}\n\n/*# sourceMappingURL=extensions.component.ts-angular-inline--65.css.map*/"]})}return n})();var ae=r(1170);function Ft(n,s){1&n&&(e.TgZ(0,"button",5),e._UZ(1,"app-icon",6),e.qZA())}const qt=()=>["type","amount"];function Dt(n,s){if(1&n&&(e.TgZ(0,"main",7)(1,"div",8),e._UZ(2,"object-list-field",9),e.qZA()()),2&n){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("fields",e.DdM(2,qt))}}function Lt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"footer",10)(1,"button",11),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.save())}),e._uU(2,"Save"),e.qZA()()}}function Jt(n,s){1&n&&(e.TgZ(0,"main",12),e._UZ(1,"mat-spinner",13),e.TgZ(2,"p"),e._uU(3,"Saving booking limits for Staff API tenant..."),e.qZA()()),2&n&&(e.xp6(1),e.Q6J("diameter",48))}let $t=(()=>{class n{constructor(t,o){this._data=t,this._dialog_ref=o,this.tenant=this._data.tenant,this.domain=this._data.domain,this.form=new c.cw({booking_limits:new c.NI([])}),this.loading=!1;const i=this.tenant?.booking_limits||{};this.form.patchValue({booking_limits:Object.keys(i).map(a=>({type:a,amount:`${i[a]}`}))})}save(){var t=this;return(0,u.Z)(function*(){if(t.form.markAllAsTouched(),!t.form.valid)return;t._dialog_ref.disableClose=!0,t.loading=!0;const o=t.form.value.booking_limits||[],i={};for(const{type:m,amount:h}of o)i[m]=+h||0;const l=yield(0,d.v_Q)(`/api/staff/v1/tenants/${t.tenant.id}/limits`,i).toPromise().catch(m=>null);if(t.loading=!1,t._dialog_ref.disableClose=!1,!l)return(0,p.cB)("Error adding new tenant.");(0,p.t5)("Successfully added new tenant."),t._dialog_ref.close({...t.tenant,booking_limits:l})})()}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(f.WI),e.Y36(f.so))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["booking-limits-modal"]],decls:9,vars:4,consts:[[1,"flex-1"],["btn","","icon","","mat-dialog-close","",4,"ngIf"],["class","overflow-auto w-[512px] max-w-[100vw]",3,"formGroup",4,"ngIf","ngIfElse"],["class","p-2 border-t border-base-200 flex justify-center",4,"ngIf"],["load_state",""],["btn","","icon","","mat-dialog-close",""],["className","backoffice-cross"],[1,"overflow-auto","w-[512px]","max-w-[100vw]",3,"formGroup"],[1,"flex","flex-col"],["formControlName","booking_limits",3,"fields"],[1,"p-2","border-t","border-base-200","flex","justify-center"],["btn","",1,"w-32",3,"click"],[1,"flex","flex-col","p-8","items-center","justify-center"],[1,"mb-4",3,"diameter"]],template:function(o,i){if(1&o&&(e.TgZ(0,"header")(1,"h3"),e._uU(2,"Edit Tenant Booking Limits"),e.qZA(),e._UZ(3,"div",0),e.YNc(4,Ft,2,0,"button",1),e.qZA(),e.YNc(5,Dt,3,3,"main",2)(6,Lt,3,0,"footer",3)(7,Jt,4,1,"ng-template",null,4,e.W1O)),2&o){const a=e.MAs(8);e.xp6(4),e.Q6J("ngIf",!i.loading),e.xp6(1),e.Q6J("ngIf",!i.loading)("ngIfElse",a),e.xp6(1),e.Q6J("ngIf",!i.loading)}},dependencies:[_.O5,c.JJ,c.JL,c.sg,c.u,T.o,ae.i,f.ZT,b.Ou]})}return n})();var Rt=r(6658);function Kt(n,s){1&n&&(e.TgZ(0,"button",5),e._UZ(1,"app-icon",6),e.qZA())}function Qt(n,s){1&n&&(e.TgZ(0,"div",8)(1,"div",9)(2,"label"),e._uU(3,"Service Account:"),e.qZA(),e.TgZ(4,"mat-form-field",10),e._UZ(5,"input",24),e.TgZ(6,"mat-error"),e._uU(7," Service account should be a valid email address "),e.qZA()()()())}function Bt(n,s){1&n&&(e.TgZ(0,"span"),e._uU(1,"*"),e.qZA())}function Gt(n,s){if(1&n&&e._UZ(0,"input",33),2&n){const t=e.oxw().$implicit,o=e.oxw(3);e.Q6J("formControlName",t.key)("placeholder",o.name_map[t.key]||t.key)}}function Xt(n,s){if(1&n&&e._UZ(0,"textarea",33),2&n){const t=e.oxw().$implicit,o=e.oxw(3);e.Q6J("formControlName",t.key)("placeholder",o.name_map[t.key]||t.key)}}function jt(n,s){if(1&n&&(e.ynx(0),e.TgZ(1,"div",27)(2,"label",28),e._uU(3),e.YNc(4,Bt,2,0,"span",29),e._uU(5,": "),e.qZA(),e.TgZ(6,"mat-form-field",10),e.ynx(7,30),e.YNc(8,Gt,1,2,"input",31)(9,Xt,1,2,"textarea",32),e.BQk(),e.TgZ(10,"mat-error"),e._uU(11),e.qZA()()(),e.BQk()),2&n){const t=s.$implicit,o=e.oxw(3);e.xp6(1),e.ekj("hidden",null==t.value?null:t.value.disabled),e.xp6(2),e.hij(" ",o.name_map[t.key]||t.key," "),e.xp6(1),e.Q6J("ngIf","conference_type"!==t.key&&!o.form.value.id),e.xp6(3),e.Q6J("ngSwitch",t.key),e.xp6(2),e.Q6J("ngSwitchCase","signing_key"),e.xp6(2),e.hij("A ",t.key," is required")}}function Yt(n,s){if(1&n&&(e.TgZ(0,"form",25),e.YNc(1,jt,12,7,"ng-container",26),e.ALo(2,"keyvalue"),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("formGroup",t.credentials),e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,2,t.credentials.controls))}}const Ht=()=>({standalone:!0});function zt(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",17)(1,"mat-checkbox",34),e.NdJ("ngModelChange",function(i){e.CHM(t);const a=e.oxw(2);return e.KtG(a.show_outlook=i)}),e._uU(2," Configure Outlook Plugin "),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngModel",t.show_outlook)("ngModelOptions",e.DdM(2,Ht))}}function Vt(n,s){1&n&&(e.TgZ(0,"form",35)(1,"div",8)(2,"div",9)(3,"label"),e._uU(4,"Outlook App ID"),e.TgZ(5,"span"),e._uU(6,"*"),e.qZA(),e._uU(7,":"),e.qZA(),e.TgZ(8,"mat-form-field",10),e._UZ(9,"input",36),e.TgZ(10,"mat-error"),e._uU(11,"An application ID is required"),e.qZA()()(),e.TgZ(12,"div",9)(13,"label"),e._uU(14,"Outlook App Domain:"),e.qZA(),e.TgZ(15,"mat-form-field",10),e._UZ(16,"input",37),e.TgZ(17,"mat-error"),e._uU(18," An application domain is required "),e.qZA()()()(),e.TgZ(19,"div",8)(20,"div",9)(21,"label"),e._uU(22,"Outlook App Resource:"),e.qZA(),e.TgZ(23,"mat-form-field",10),e._UZ(24,"input",38),e.TgZ(25,"mat-error"),e._uU(26," An application resource is required "),e.qZA()()(),e.TgZ(27,"div",9)(28,"label"),e._uU(29,"Outlook Source Location:"),e.qZA(),e.TgZ(30,"mat-form-field",10),e._UZ(31,"input",39),e.TgZ(32,"mat-error"),e._uU(33,"A source location is required"),e.qZA()()()(),e.TgZ(34,"div",8)(35,"div",9)(36,"label"),e._uU(37,"Outlook Base Path:"),e.qZA(),e.TgZ(38,"mat-form-field",10),e._UZ(39,"input",40),e.TgZ(40,"mat-error"),e._uU(41," Base path to the application root folder is required "),e.qZA()()()()())}const Wt=()=>["type","amount"];function en(n,s){if(1&n&&(e.TgZ(0,"main",7)(1,"div",8)(2,"div",9)(3,"label"),e._uU(4,"Name"),e.TgZ(5,"span"),e._uU(6,"*"),e.qZA(),e._uU(7,":"),e.qZA(),e.TgZ(8,"mat-form-field",10),e._UZ(9,"input",11),e.TgZ(10,"mat-error"),e._uU(11,"A tenant name is required"),e.qZA()()(),e.TgZ(12,"div",9)(13,"label"),e._uU(14,"Platform"),e.TgZ(15,"span"),e._uU(16,"*"),e.qZA(),e._uU(17,":"),e.qZA(),e.TgZ(18,"mat-form-field",10)(19,"mat-select",12)(20,"mat-option",13),e._uU(21,"Google"),e.qZA(),e.TgZ(22,"mat-option",14),e._uU(23,"Office365"),e.qZA()()()()(),e.TgZ(24,"div",9)(25,"label"),e._uU(26,"Email Domain:"),e.qZA(),e.TgZ(27,"mat-form-field",10),e._UZ(28,"input",15),e.TgZ(29,"mat-error"),e._uU(30,"A domain is required"),e.qZA()()(),e.YNc(31,Qt,8,0,"div",16),e.TgZ(32,"div",17)(33,"mat-checkbox",18),e._uU(34," Delegated "),e.qZA()(),e.YNc(35,Yt,3,4,"form",19)(36,zt,3,3,"div",20)(37,Vt,42,0,"form",21),e.TgZ(38,"div",22)(39,"label"),e._uU(40,"Booking Limits"),e.qZA(),e._UZ(41,"object-list-field",23),e.qZA()()),2&n){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(31),e.Q6J("ngIf","google"!==t.form.value.platform&&!t.form.value.delegated),e.xp6(4),e.Q6J("ngIf",t.credentials),e.xp6(1),e.Q6J("ngIf","office365"===t.form.value.platform),e.xp6(1),e.Q6J("ngIf",t.show_outlook&&t.form.get("outlook_config")),e.xp6(4),e.Q6J("fields",e.DdM(6,Wt))}}function tn(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"footer",41)(1,"button",42),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.save())}),e._uU(2,"Save"),e.qZA()()}}function nn(n,s){1&n&&(e.TgZ(0,"main",43),e._UZ(1,"mat-spinner",44),e.TgZ(2,"p"),e._uU(3,"Saving staff API tenant..."),e.qZA()()),2&n&&(e.xp6(1),e.Q6J("diameter",48))}const on={issuer:"Service Account Email",conference_type:"Conference Type",signing_key:"Private Key",sub:"Service User",client_id:"Client ID",client_secret:"Client Secret",domain:"Domain",scopes:"Scopes",user_agent:"User Agent"};let an=(()=>{class n{get office_form(){return new c.cw({tenant:new c.NI("",[c.kI.required]),client_id:new c.NI("",[c.kI.required]),client_secret:new c.NI("",[c.kI.required]),conference_type:new c.NI("")})}get google_form(){return new c.cw({issuer:new c.NI("",[c.kI.required]),signing_key:new c.NI("",[c.kI.required]),scopes:new c.NI("",[c.kI.required]),domain:new c.NI("",[c.kI.required]),sub:new c.NI("",[c.kI.required]),user_agent:new c.NI("PlaceOS",[c.kI.required]),conference_type:new c.NI("")})}get credentials(){return this.form?.controls.credentials}constructor(t,o){this._data=t,this._dialog_ref=o,this.event=new e.vpe,this.tenant=this._data.tenant,this.domain=this._data.domain,this.show_outlook=!1,this.form=new c.cw({id:new c.NI(this.tenant?.id||""),domain:new c.NI(this.domain?.domain||this.tenant?.domain||"localhost"),name:new c.NI(this.tenant?.name||"",[c.kI.required]),email_domain:new c.NI(this.tenant?.email_domain||""),delegated:new c.NI(this.tenant?.delegated??!1),platform:new c.NI(this.tenant?.platform||"google",[c.kI.required]),service_account:new c.NI(this.tenant?.service_account,[c.kI.email]),booking_limits:new c.NI([]),credentials:"office365"===this.tenant?.platform?this.office_form:this.google_form}),this.loading=!1,this.name_map=on}ngOnInit(){const t=this.tenant?.booking_limits||{},o=["tenant","client_id","client_secret","issuer","signing_key","scopes","sub","domain","user_agent"],i=a=>{if(a)for(const l of o)this.form.get("credentials")?.get(l)?.disable(),this.form.get("credentials")?.get(l)?.setValidators([]);else{const l=this.form.value.id;for(const m of o)this.form.get("credentials")?.get(m)?.enable(),this.form.get("credentials")?.get(m)?.setValidators(l?[]:[c.kI.required])}this.form.updateValueAndValidity()};this.form.controls.platform.valueChanges.subscribe(a=>{const l=this.form.value.credentials;this.form.removeControl("credentials"),this.form.addControl("credentials","office365"===a?this.office_form:this.google_form),"office365"===a?this.form.addControl("outlook_config",new c.cw({app_id:new c.NI(""),app_domain:new c.NI(""),app_resource:new c.NI(""),source_location:new c.NI(""),base_path:new c.NI("")})):this.form.removeControl("outlook_config"),i(this.form.value.delegated),this.form.patchValue({credentials:l})}),i(this.form.value.delegated),this.form.controls.delegated.valueChanges.subscribe(i),this.form.patchValue({...this.tenant||{},domain:this.tenant?.domain||this._data.domain?.domain,booking_limits:Object.keys(t).map(a=>({type:a,amount:t[a]}))})}save(){var t=this;return(0,u.Z)(function*(){if(t.form.markAllAsTouched(),!t.form.valid)return(0,p.cB)(`Some fields are invalid. [${(0,M.RD)(t.form)}]`);t._dialog_ref.disableClose=!0,t.loading=!0;const i=(t.form.value.booking_limits||[]).reduce((x,{type:B,amount:y})=>(x[B]=+y,x),{}),a=t.form.value;if(a.credentials.conference_type||delete a.credentials.conference_type,t.show_outlook)for(const x in a.outlook_config)null==a.outlook_config[x]&&delete a.outlook_config[x];else delete a.outlook_config;for(const x in a.credentials)null==a.credentials[x]&&delete a.credentials[x];Object.keys(a.credentials).length||delete a.credentials;const l=(0,d.sWL)({...t.tenant||{},...a,booking_limits:i},["",null,void 0]),h=yield(t.tenant?.id?(0,d.gzd)(`/api/staff/v1/tenants/${t.tenant.id}`,l):(0,d.v_Q)("/api/staff/v1/tenants",l)).toPromise().catch(x=>null);if(t.loading=!1,t._dialog_ref.disableClose=!1,!h)return(0,p.cB)("Error adding new tenant.");(0,p.t5)("Successfully added new tenant."),t._dialog_ref.close()})()}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(f.WI),e.Y36(f.so))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["staff-tenant-modal"]],outputs:{event:"event"},decls:9,vars:5,consts:[[1,"flex-1"],["btn","","icon","","mat-dialog-close","",4,"ngIf"],["class","overflow-auto p-4",3,"formGroup",4,"ngIf","ngIfElse"],["class","p-2 border-t border-base-200 flex justify-center",4,"ngIf"],["load_state",""],["btn","","icon","","mat-dialog-close",""],["className","backoffice-cross"],[1,"overflow-auto","p-4",3,"formGroup"],[1,"flex","items-center","flex-wrap","space-x-0","sm:space-x-2"],[1,"flex","flex-col","flex-1"],["appearance","outline"],["matInput","","formControlName","name","placeholder","Tenant Name"],["formControlName","platform"],["value","google"],["value","office365"],["matInput","","formControlName","email_domain","placeholder","Domain of user's email for this tenant"],["class","flex items-center flex-wrap space-x-0 sm:space-x-2",4,"ngIf"],[1,"flex","items-center","mb-4"],["formControlName","delegated"],[3,"formGroup",4,"ngIf"],["class","flex items-center mb-4",4,"ngIf"],["formGroupName","outlook_config",4,"ngIf"],[1,"flex","flex-col","space-y-2"],["formControlName","booking_limits",3,"fields"],["matInput","","formControlName","service_account","placeholder","Service Account"],[3,"formGroup"],[4,"ngFor","ngForOf"],[1,"flex","flex-col"],[1,"capitalize"],[4,"ngIf"],[3,"ngSwitch"],["matInput","",3,"formControlName","placeholder",4,"ngSwitchDefault"],["matInput","",3,"formControlName","placeholder",4,"ngSwitchCase"],["matInput","",3,"formControlName","placeholder"],[3,"ngModel","ngModelOptions","ngModelChange"],["formGroupName","outlook_config"],["matInput","","formControlName","app_id","placeholder","Application ID"],["matInput","","formControlName","app_domain","placeholder","Application Domain"],["matInput","","formControlName","app_resource","placeholder","Application ID"],["matInput","","formControlName","source_location","placeholder","Source Location"],["matInput","","formControlName","base_path","placeholder","outlook"],[1,"p-2","border-t","border-base-200","flex","justify-center"],["btn","",1,"w-32",3,"click"],[1,"flex","flex-col","p-8","items-center","justify-center"],[1,"mb-4",3,"diameter"]],template:function(o,i){if(1&o&&(e.TgZ(0,"header")(1,"h3"),e._uU(2),e.qZA(),e._UZ(3,"div",0),e.YNc(4,Kt,2,0,"button",1),e.qZA(),e.YNc(5,en,42,7,"main",2)(6,tn,3,0,"footer",3)(7,nn,4,1,"ng-template",null,4,e.W1O)),2&o){const a=e.MAs(8);e.xp6(2),e.hij("",i.tenant?"Edit":"New"," Tenant"),e.xp6(2),e.Q6J("ngIf",!i.loading),e.xp6(1),e.Q6J("ngIf",!i.loading)("ngIfElse",a),e.xp6(1),e.Q6J("ngIf",!i.loading)}},dependencies:[_.sg,_.O5,_.RF,_.n9,_.ED,c._Y,c.Fj,c.JJ,c.JL,c.On,c.F,c.sg,c.u,c.x0,T.o,ae.i,f.ZT,A.KE,A.TO,k.Nt,b.Ou,v.ey,P.gD,Rt.oG,_.Nd],styles:["main[_ngcontent-%COMP%]{width:32rem;max-width:calc(100vw - 5rem);max-height:65vh}\n\n/*# sourceMappingURL=staff-tenant-modal.component.ts-angular-inline--66.css.map*/"]})}return n})();function sn(n,s){if(1&n&&(e.TgZ(0,"mat-option",9),e._uU(1),e.qZA()),2&n){const t=s.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.name," ")}}function ln(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",18)(1,"div",19),e._uU(2),e.qZA(),e.TgZ(3,"div",20),e._uU(4),e.qZA(),e.TgZ(5,"div",21)(6,"button",22),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw(3);return e.KtG(l.editLimits(a))}),e._uU(7," Edit Limits "),e.qZA()(),e.TgZ(8,"div",23)(9,"button",24),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw(3);return e.KtG(l.editTenant(a))}),e._UZ(10,"app-icon",25),e.qZA(),e.TgZ(11,"button",24),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw(3);return e.KtG(l.removeTenant(a))}),e._UZ(12,"app-icon",26),e.qZA()()()}if(2&n){const t=s.$implicit;e.xp6(2),e.Oqu(t.name),e.xp6(2),e.hij(" ",t.platform," ")}}function cn(n,s){if(1&n&&(e.TgZ(0,"div",11)(1,"div",12)(2,"div",13),e._uU(3,"Name"),e.qZA(),e.TgZ(4,"div",14),e._uU(5,"Platform"),e.qZA(),e._UZ(6,"div",15)(7,"div",15),e.qZA(),e.TgZ(8,"div",16),e.YNc(9,ln,13,2,"div",17),e.ALo(10,"async"),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(9),e.Q6J("ngForOf",e.lcZ(10,1,t.tenants))}}function rn(n,s){if(1&n&&(e.ynx(0),e.YNc(1,cn,11,3,"div",10),e.ALo(2,"async"),e.BQk()),2&n){const t=e.oxw(),o=e.MAs(11);let i;e.xp6(1),e.Q6J("ngIf",null==(i=e.lcZ(2,2,t.tenants))?null:i.length)("ngIfElse",o)}}function _n(n,s){1&n&&(e.TgZ(0,"div",27)(1,"p"),e._uU(2,"No tenants for selected domain"),e.qZA()())}function dn(n,s){if(1&n&&(e.TgZ(0,"div",28),e._UZ(1,"mat-spinner",29),e.TgZ(2,"p"),e._uU(3),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("diameter",48),e.xp6(2),e.Oqu(t.loading)}}let mn=(()=>{class n{constructor(t){this._dialog=t,this.loading="",this.domain=new C.X(null),this.tenants=this.domain.pipe((0,w.w)(()=>(this.loading="Loading tenants for domain...",(0,d.U2M)("/api/staff/v1/tenants"))),(0,U.K)(o=>[]),(0,g.U)(o=>(this.loading="",o.filter(i=>i.domain===this.domain.getValue().domain))),(0,Z.d)())}ngOnInit(){var t=this;return(0,u.Z)(function*(){t.loading="Loading domains...",t.domain_list=yield(0,d.R2s)().pipe((0,g.U)(a=>a.data)).toPromise();const o=(0,d.N9E)();if(!t.domain_list?.length)return;const i=t.domain_list.find(a=>a.id===o.id);i&&t.domain.next(i),t.loading=""})()}editTenant(t){this._dialog.open(an,{data:{tenant:t,domain:this.domain.getValue()}}).afterClosed().subscribe(i=>this.domain.next(this.domain.getValue()))}editLimits(t){this._dialog.open($t,{data:{tenant:t,domain:this.domain.getValue()}}).afterClosed().subscribe(i=>this.domain.next(this.domain.getValue()))}removeTenant(t){var o=this;return(0,u.Z)(function*(){const i=yield(0,M._5)({title:"Remove tenant?",content:`Remove <strong>${t.name}</strong> from this domain?<br>\n                <p style="text-align: left; width: 100%;">This will remove all related:</p><br>\n                <ul style="list-style: disc;text-align: left;padding-left: 2rem">\n                <li>bookings (such as desk bookings)</li>\n                <li>event metadata (such as catering)</li>\n                <li>guest information</li>\n                <li>survey data</li>\n                </ul>`,icon:{type:"icon",class:"backoffice-trash"},action:"Delete"},o._dialog);if(!i||!i.reason)return;i.loading("Removing tenant from domain...");const a=yield(0,d.IVX)(`/api/staff/v1/tenants/${t.id}`).toPromise().catch(l=>((0,p.cB)(`Error removing module ${t.id} from domain. Error: ${l.statusText||l.message||l}`),!0));i.close(),!a&&((0,p.t5)("Successfully removed tenant from domain."),o.domain.next(o.domain.getValue()))})()}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(f.uw))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["staff-api"]],decls:14,vars:6,consts:[[1,"flex","items-center","space-x-2","my-4"],["for","type"],["appearance","outline",1,"h-12"],["name","type","placeholder","Select Domain...",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["btn","",3,"click"],[4,"ngIf","ngIfElse"],["empty_state",""],["load_state",""],[3,"value"],["class","w-full",4,"ngIf","ngIfElse"],[1,"w-full"],["table-head",""],[1,"w-1/2","p-2"],[1,"flex-1","p-2"],[1,"w-24","p-2","h-10"],["table-body",""],["table-row","",4,"ngFor","ngForOf"],["table-row",""],[1,"w-1/2","p-2","truncate"],[1,"flex-1","p-2","truncate"],[1,"w-24","p-2","truncate"],["btn","",1,"clear","underline",3,"click"],[1,"w-24","px-2","flex","items-center","justify-end"],["btn","","icon","",1,"h-10","w-10",3,"click"],["className","backoffice-edit"],["className","backoffice-trash"],[1,"flex","flex-col","items-center","justify-center"],[1,"w-full","flex","flex-col","items-center","justify-center"],[1,"mb-4",3,"diameter"]],template:function(o,i){if(1&o&&(e.TgZ(0,"div",0)(1,"label",1),e._uU(2,"Domain: "),e.qZA(),e.TgZ(3,"mat-form-field",2)(4,"mat-select",3),e.NdJ("ngModelChange",function(l){return i.domain.next(l)}),e.ALo(5,"async"),e.YNc(6,sn,2,2,"mat-option",4),e.qZA()(),e.TgZ(7,"button",5),e.NdJ("click",function(){return i.editTenant()}),e._uU(8,"Add Tenant"),e.qZA()(),e.YNc(9,rn,3,4,"ng-container",6)(10,_n,3,0,"ng-template",null,7,e.W1O)(12,dn,4,2,"ng-template",null,8,e.W1O)),2&o){const a=e.MAs(13);e.xp6(4),e.Q6J("ngModel",e.lcZ(5,4,i.domain)),e.xp6(2),e.Q6J("ngForOf",i.domain_list),e.xp6(3),e.Q6J("ngIf",!i.loading)("ngIfElse",a)}},dependencies:[_.sg,_.O5,c.JJ,c.On,T.o,A.KE,b.Ou,v.ey,P.gD,_.Ov],styles:["[_nghost-%COMP%]{position:relative;height:100%;width:100%}\n\n/*# sourceMappingURL=staff-api.component.ts-angular-inline--67.css.map*/"]})}return n})();var z=r(5933);function pn(n,s){1&n&&(e.TgZ(0,"button",5),e._UZ(1,"app-icon",6),e.qZA())}function un(n,s){if(1&n&&(e.TgZ(0,"main",7)(1,"div",8)(2,"label"),e._uU(3,"Name"),e.TgZ(4,"span"),e._uU(5,"*"),e.qZA(),e._uU(6,":"),e.qZA(),e.TgZ(7,"mat-form-field",9),e._UZ(8,"input",10),e.TgZ(9,"mat-error"),e._uU(10,"A edge name is required"),e.qZA()()(),e.TgZ(11,"div",8)(12,"label"),e._uU(13,"Description:"),e.qZA(),e.TgZ(14,"mat-form-field",9),e._UZ(15,"textarea",11),e.qZA()()()),2&n){const t=e.oxw();e.Q6J("formGroup",t.form)}}function fn(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"footer",12)(1,"button",13),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.save())}),e._uU(2,"Save"),e.qZA()()}}function gn(n,s){1&n&&(e.TgZ(0,"main",14),e._UZ(1,"mat-spinner",15),e.TgZ(2,"p"),e._uU(3,"Saving edge..."),e.qZA()()),2&n&&(e.xp6(1),e.Q6J("diameter",48))}let hn=(()=>{class n{constructor(t,o){this._data=t,this._dialog_ref=o,this.event=new e.vpe,this.edge=this._data.edge,this.form=new c.cw({name:new c.NI("",[c.kI.required]),description:new c.NI("")}),this.loading=!1}ngOnInit(){this.form.patchValue(this.edge)}save(){var t=this;return(0,u.Z)(function*(){if(t.form.markAllAsTouched(),!t.form.valid)return;t._dialog_ref.disableClose=!0,t.loading=!0;const o={...t.edge,...t.form.value},a=yield(o.id?(0,d.sNt)(o.id,o):(0,d.Z_z)(o)).toPromise().catch(l=>null);if(t.loading=!1,t._dialog_ref.disableClose=!1,!a)return(0,p.cB)("Error adding new edge.");(0,p.t5)(o.id?"Successfully updated edge.":"Successfully added new edge. Please make sure to save the API key as you will not be able to view it again in the future."),t._dialog_ref.close(a)})()}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(f.WI),e.Y36(f.so))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["edge-modal"]],outputs:{event:"event"},decls:9,vars:5,consts:[[1,"flex-1"],["btn","","icon","","mat-dialog-close","",4,"ngIf"],["class","overflow-auto p-4",3,"formGroup",4,"ngIf","ngIfElse"],["class","p-2 border-t border-base-200 flex justify-center",4,"ngIf"],["load_state",""],["btn","","icon","","mat-dialog-close",""],["className","backoffice-cross"],[1,"overflow-auto","p-4",3,"formGroup"],[1,"flex","flex-col","flex-1"],["appearance","outline"],["matInput","","formControlName","name","placeholder","Edge Name"],["matInput","","formControlName","description","placeholder","Edge description..."],[1,"p-2","border-t","border-base-200","flex","justify-center"],["btn","",1,"w-32",3,"click"],[1,"flex","flex-col","p-8","items-center","justify-center"],[1,"mb-4",3,"diameter"]],template:function(o,i){if(1&o&&(e.TgZ(0,"header")(1,"h3"),e._uU(2),e.qZA(),e._UZ(3,"div",0),e.YNc(4,pn,2,0,"button",1),e.qZA(),e.YNc(5,un,16,1,"main",2)(6,fn,3,0,"footer",3)(7,gn,4,1,"ng-template",null,4,e.W1O)),2&o){const a=e.MAs(8);e.xp6(2),e.hij("",i.edge?"Edit":"New"," Edge"),e.xp6(2),e.Q6J("ngIf",!i.loading),e.xp6(1),e.Q6J("ngIf",!i.loading&&i.form)("ngIfElse",a),e.xp6(1),e.Q6J("ngIf",!i.loading)}},dependencies:[_.O5,c.Fj,c.JJ,c.JL,c.sg,c.u,T.o,f.ZT,A.KE,A.TO,k.Nt,b.Ou],styles:["main[_ngcontent-%COMP%]{width:32rem;max-width:calc(100vw - 5rem);max-height:65vh}\n\n/*# sourceMappingURL=edge-modal.component.ts-angular-inline--68.css.map*/"]})}return n})();var se=r(4362),An=r(702);const Tn=["admin-edge",""];function xn(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",14)(1,"div",15),e._uU(2),e.qZA(),e.TgZ(3,"div",16),e._uU(4),e.qZA(),e.TgZ(5,"div",17),e._uU(6),e.qZA(),e.TgZ(7,"div",18)(8,"button",19),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw(3);return e.KtG(l.edit(a))}),e._UZ(9,"app-icon",20),e.qZA(),e.TgZ(10,"button",19),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw(3);return e.KtG(l.remove(a))}),e._UZ(11,"app-icon",21),e.qZA()()()}if(2&n){const t=s.$implicit;e.xp6(2),e.hij(" ",t.id," "),e.xp6(2),e.hij(" ",t.name," "),e.xp6(2),e.hij(" ",t.description," ")}}function vn(n,s){if(1&n&&(e.TgZ(0,"div",6)(1,"div",7)(2,"div",8),e._uU(3,"ID"),e.qZA(),e.TgZ(4,"div",9),e._uU(5,"Name"),e.qZA(),e.TgZ(6,"div",10),e._uU(7,"Description"),e.qZA(),e._UZ(8,"div",11),e.qZA(),e.TgZ(9,"div",12),e.YNc(10,xn,12,3,"div",13),e.ALo(11,"async"),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(10),e.Q6J("ngForOf",e.lcZ(11,1,t.edges))}}function Cn(n,s){if(1&n&&(e.ynx(0),e.YNc(1,vn,12,3,"div",5),e.ALo(2,"async"),e.BQk()),2&n){const t=e.oxw(),o=e.MAs(6);let i;e.xp6(1),e.Q6J("ngIf",null==(i=e.lcZ(2,2,t.edges))?null:i.length)("ngIfElse",o)}}function Zn(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",22),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.copyKey(i.item.x_api_key))}),e.TgZ(1,"div",23)(2,"code",24),e._uU(3),e.qZA()(),e.TgZ(4,"button",25),e._UZ(5,"app-icon",26),e.qZA()()}if(2&n){const t=e.oxw();e.Q6J("matTooltip","Copy API Key for "+t.item.name),e.xp6(3),e.Oqu(t.item.x_api_key)}}function bn(n,s){1&n&&(e.TgZ(0,"div",27)(1,"p"),e._uU(2,"No edges"),e.qZA()())}function yn(n,s){if(1&n&&(e.TgZ(0,"div",28),e._UZ(1,"mat-spinner",29),e.TgZ(2,"p"),e._uU(3),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("diameter",48),e.xp6(2),e.Oqu(t.loading)}}let le=(()=>{class n{get item(){return this.last_change.getValue()}constructor(t,o){var i=this;this._dialog=t,this._clipboard=o,this.loading="",this._change=new C.X(0),this._hide=new C.X(""),this.last_change=new C.X(null),this._edge_list=this._change.pipe((0,z.b)(300),(0,w.w)(a=>(this.loading="Loading Edges...",(0,d.KQ8)())),(0,U.K)(a=>(0,R.of)({})),(0,g.U)(a=>(this.loading="",(a?.data||[]).sort((l,m)=>l.id?.localeCompare(m.id)))),(0,Z.d)()),this.edges=(0,F.aj)([this._edge_list,this._hide]).pipe((0,z.b)(500),(0,g.U)(([a,l])=>l?a.filter(h=>h.id!==l).sort((h,x)=>h.id?.localeCompare(x.id)):a)),this.token=function(){var a=(0,u.Z)(function*(l){const m=yield(0,d.HLJ)(l.id).toPromise();(0,M.vQ)(m.token),(0,p.QD)("Token copied to clickboard.")});return function(l){return a.apply(this,arguments)}}(),this.edit=function(){var a=(0,u.Z)(function*(l){i._dialog.open(hn,{data:{edge:l}}).afterClosed().subscribe(h=>{sessionStorage.setItem("BACKOFFICE.last_edge",JSON.stringify(h)),i.last_change.next(h),i._change.next(Date.now())})});return function(l){return a.apply(this,arguments)}}(),this.remove=function(){var a=(0,u.Z)(function*(l){const m=yield(0,M._5)({title:"Remove edge?",content:`Remove <strong>${l.name}</strong>?<br>You or your users may lose access to some data.`,icon:{type:"icon",class:"backoffice-trash"}},i._dialog);if(!m)return;m.loading("Removing edge...");const h=yield(0,d.eAF)(l.id).toPromise().catch(x=>x);if(m.close(),h)return(0,p.cB)(`Error removing edge. Error: ${h.statusText||h.message||h}`);sessionStorage.removeItem("BACKOFFICE.last_edge"),i.last_change.next(null),(0,p.t5)("Successfully removed Edge."),i._hide.next(l.id)});return function(l){return a.apply(this,arguments)}}()}ngOnInit(){const t=sessionStorage.getItem("BACKOFFICE.last_edge");try{this.last_change.next(JSON.parse(t)||null)}catch{}}copyKey(t){t&&this._clipboard.copy(t)&&(0,p.t5)("Edge API Key copied to clipboard.")}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(f.uw),e.Y36(se.TU))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["","admin-edge",""]],attrs:Tn,decls:9,vars:5,consts:[["btn","",1,"w-full","sm:w-40","my-4",3,"click"],[4,"ngIf","ngIfElse"],["matRipple","","class","absolute flex rounded cursor-pointer items-center right-4 top-4 bg-base-100  shadow border border-base-200  max-w-[calc(100%-11rem)] overflow-hidden",3,"matTooltip","click",4,"ngIf"],["empty_state",""],["load_state",""],["table","","class","w-full min-w-[52rem]",4,"ngIf","ngIfElse"],["table","",1,"w-full","min-w-[52rem]"],["table-head",""],[1,"w-32","p-2"],[1,"w-40","p-2"],[1,"flex-1","p-2"],[1,"w-24","p-2","h-10"],["table-body",""],["table-row","",4,"ngFor","ngForOf"],["table-row",""],[1,"w-32","p-2","truncate","text-xs","font-mono"],[1,"w-40","p-2","truncate","text-sm"],[1,"flex-1","w-1/4","p-2","truncate","text-xs"],[1,"w-24","px-2","flex","items-center","justify-end"],["btn","","icon","",1,"h-10","w-10",3,"click"],["className","backoffice-edit"],["className","backoffice-trash"],["matRipple","",1,"absolute","flex","rounded","cursor-pointer","items-center","right-4","top-4","bg-base-100","shadow","border","border-base-200","max-w-[calc(100%-11rem)]","overflow-hidden",3,"matTooltip","click"],[1,"p-2","flex-1","w-1/2","flex","h-full","items-center","border-r","border-base-200"],[1,"flex-1","truncate"],["btn","","icon","",1,"rounded-none"],["className","backoffice-copy"],[1,"flex","flex-col","items-center","justify-center"],[1,"w-full","flex","flex-col","items-center","justify-center"],[1,"mb-4",3,"diameter"]],template:function(o,i){if(1&o&&(e.TgZ(0,"button",0),e.NdJ("click",function(){return i.edit()}),e._uU(1," Add New Edge "),e.qZA(),e.YNc(2,Cn,3,4,"ng-container",1)(3,Zn,6,2,"div",2),e.ALo(4,"async"),e.YNc(5,bn,3,0,"ng-template",null,3,e.W1O)(7,yn,4,2,"ng-template",null,4,e.W1O)),2&o){const a=e.MAs(8);let l;e.xp6(2),e.Q6J("ngIf",!i.loading)("ngIfElse",a),e.xp6(1),e.Q6J("ngIf",null==(l=e.lcZ(4,3,i.last_change))?null:l.x_api_key)}},dependencies:[_.sg,_.O5,T.o,b.Ou,An.gM,v.wG,_.Ov],styles:["[_nghost-%COMP%]{height:100%;width:100%;min-height:10rem}\n\n/*# sourceMappingURL=edge.component.ts-angular-inline--69.css.map*/"]})}return n})();var In=r(4915),Nn=r(8590);function En(n,s){if(1&n&&(e.TgZ(0,"mat-option",13),e._uU(1),e.qZA()),2&n){const t=s.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.name," ")}}function Mn(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",14)(1,"div",1)(2,"label",2),e._uU(3,"Schema Name: "),e.qZA(),e.TgZ(4,"mat-form-field",3)(5,"input",15),e.NdJ("ngModelChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.schema_copy.name=i)}),e.qZA()()(),e.TgZ(6,"button",8),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.saveSchema())}),e._uU(7,"Save Schema"),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(5),e.Q6J("ngModel",t.schema_copy.name)}}function Pn(n,s){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"settings-form-field",16),e.NdJ("ngModelChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.schema_copy.schema=i)}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngModel",t.schema_copy.schema)("readonly",!1)}}function Sn(n,s){1&n&&(e.TgZ(0,"div",17)(1,"p",18),e._uU(2,"Select a schema to edit"),e.qZA()())}let On=(()=>{class n{constructor(t){this._state=t,this.schema_list=this._state.schemas.pipe((0,Z.d)(1))}copySchema(){this.active_schema&&(this.schema_copy=JSON.parse(JSON.stringify(this.active_schema)))}newSchema(){var t=this;return(0,u.Z)(function*(){t.active_schema={name:"New Schema",schema:"{}"},t.copySchema()})()}saveSchema(){this._state.saveSchema(this.schema_copy),this.active_schema=null,this.schema_copy=null}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(In.O))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["admin-schemas"]],decls:18,vars:7,consts:[[1,"flex","items-center","space-x-2","my-4"],[1,"flex","flex-col"],["for","type"],["appearance","outline",1,"h-12"],["name","type","placeholder","Select Schema...",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"click"],[1,"italic","font-sans"],["btn","",1,"mt-6",3,"click"],["class","flex items-center space-x-2 mb-4",4,"ngIf"],[1,"relative","flex-1","h-1/2"],[4,"ngIf","ngIfElse"],["empty_state",""],[3,"value"],[1,"flex","items-center","space-x-2","mb-4"],["matInput","",3,"ngModel","ngModelChange"],["lang","json",3,"ngModel","readonly","ngModelChange"],[1,"absolute","inset-0","flex","items-center","justify-center"],[1,"p-8"]],template:function(o,i){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label",2),e._uU(3,"Schema: "),e.qZA(),e.TgZ(4,"mat-form-field",3)(5,"mat-select",4),e.NdJ("ngModelChange",function(l){return i.active_schema=l})("ngModelChange",function(){return i.copySchema()}),e.YNc(6,En,2,2,"mat-option",5),e.ALo(7,"async"),e.TgZ(8,"mat-option",6),e.NdJ("click",function(l){return i.newSchema(),l.preventDefault()}),e.TgZ(9,"span",7),e._uU(10,"New Schema"),e.qZA()()()()(),e.TgZ(11,"button",8),e.NdJ("click",function(){return i.newSchema()}),e._uU(12,"Add Schema"),e.qZA()(),e.YNc(13,Mn,8,1,"div",9),e.TgZ(14,"div",10),e.YNc(15,Pn,2,2,"ng-container",11),e.qZA(),e.YNc(16,Sn,3,0,"ng-template",null,12,e.W1O)),2&o){const a=e.MAs(17);e.xp6(5),e.Q6J("ngModel",i.active_schema),e.xp6(1),e.Q6J("ngForOf",e.lcZ(7,5,i.schema_list)),e.xp6(7),e.Q6J("ngIf",i.schema_copy),e.xp6(2),e.Q6J("ngIf",i.schema_copy)("ngIfElse",a)}},dependencies:[_.sg,_.O5,c.Fj,c.JJ,c.On,Nn.x,A.KE,k.Nt,v.ey,P.gD,_.Ov],styles:["[_nghost-%COMP%]{position:absolute;top:0;left:1rem;right:1rem;bottom:0;display:flex;flex-direction:column}\n\n/*# sourceMappingURL=schemas.component.ts-angular-inline--70.css.map*/"]})}return n})();var ce=r(6939),wn=r(7120),re=r(7265);function _e(n){return(0,re.Z)(1,arguments),Math.floor(function kn(n){return(0,re.Z)(1,arguments),(0,wn.Z)(n).getTime()}(n)/1e3)}class de{constructor(s){this.id=s.id||"",this.name=s.name||"",this.user_id=s.user_id||"",this.authority_id=s.authority_id||"",this.description=s.description||"",this.permissions=s.permissions||"user",this.created_at=s.created_at||_e(new Date),this.updated_at=s.updated_at||_e(new Date),this.secret=s.secret,this.x_api_key=s.x_api_key||"",this.scopes=s.scopes||[]}}var V=r(554),me=r(647),Un=r(4507),pe=r(9892),W=r(8128),K=r(1757);const Fn=["input"];function qn(n,s){1&n&&(e.TgZ(0,"button",5),e._UZ(1,"app-icon",6),e.qZA())}function Dn(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"mat-chip",34),e.NdJ("removed",function(){const a=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.removeScope(a))}),e._uU(1),e._UZ(2,"app-icon",35),e.qZA()}if(2&n){const t=s.$implicit;e.Q6J("selectable",!0)("removable",!0),e.xp6(1),e.hij(" ",t," ")}}function Ln(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"mat-option",36),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.addScope({input:{},value:a}))}),e._uU(1),e.qZA()}if(2&n){const t=s.$implicit;e.xp6(1),e.hij(" ",t," ")}}function Jn(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",37),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw(2);return l.form.patchValue({user:a,user_id:a.id}),e.KtG(l.setSearch(""))}),e._uU(1),e.qZA()}if(2&n){const t=s.$implicit,o=e.oxw(2);e.ekj("text-secondary",(null==o.form.value.user?null:o.form.value.user.id)===t.id),e.xp6(1),e.hij(" ",t.name," ")}}function $n(n,s){1&n&&(e.TgZ(0,"button",38),e._uU(1," No results "),e.qZA()),2&n&&e.Q6J("disabled",!0)}const Rn=()=>({standalone:!0});function Kn(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"main",7)(1,"div",8)(2,"label",9),e._uU(3,"Name"),e.TgZ(4,"span"),e._uU(5,"*"),e.qZA()(),e.TgZ(6,"mat-form-field",10),e._UZ(7,"input",11),e.TgZ(8,"mat-error"),e._uU(9,"Name is required"),e.qZA()()(),e.TgZ(10,"div",8)(11,"label",9),e._uU(12,"Description"),e.qZA(),e.TgZ(13,"mat-form-field",10),e._UZ(14,"textarea",12),e.qZA()(),e.TgZ(15,"div",8)(16,"label",13),e._uU(17,"Scopes"),e.TgZ(18,"span"),e._uU(19,"*"),e.qZA()(),e.TgZ(20,"mat-form-field",10)(21,"mat-chip-grid",14,15),e.YNc(23,Dn,3,3,"mat-chip",16),e.TgZ(24,"input",17),e.NdJ("matChipInputTokenEnd",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.addScope(i))}),e.qZA()(),e.TgZ(25,"mat-error"),e._uU(26,"At least one scope is required"),e.qZA(),e.TgZ(27,"mat-autocomplete",null,18),e.YNc(29,Ln,2,1,"mat-option",19),e.ALo(30,"async"),e.qZA()()(),e.TgZ(31,"div",8)(32,"label",20),e._uU(33,"User"),e.TgZ(34,"span"),e._uU(35,"*"),e.qZA()(),e.TgZ(36,"an-action-field",21),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.focusInput())}),e.TgZ(37,"div"),e._uU(38),e.qZA()(),e.TgZ(39,"mat-menu",null,22)(41,"mat-form-field",23),e.NdJ("click",function(i){return i.preventDefault(),i.stopPropagation()}),e.TgZ(42,"input",24,25),e.NdJ("ngModelChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.setSearch(i))}),e.qZA()(),e.YNc(44,Jn,2,3,"button",26),e.ALo(45,"slice"),e.ALo(46,"async"),e.YNc(47,$n,2,1,"button",27),e.ALo(48,"async"),e.qZA()(),e.TgZ(49,"div",8)(50,"label",28),e._uU(51,"Permissions"),e.qZA(),e.TgZ(52,"mat-form-field",10)(53,"mat-select",29)(54,"mat-option",30),e._uU(55,"None"),e.qZA(),e.TgZ(56,"mat-option",31),e._uU(57,"User"),e.qZA(),e.TgZ(58,"mat-option",32),e._uU(59,"Support"),e.qZA(),e.TgZ(60,"mat-option",33),e._uU(61,"Admin"),e.qZA()()()()()}if(2&n){const t=e.MAs(22),o=e.MAs(28),i=e.MAs(40),a=e.oxw();let l;e.Q6J("formGroup",a.form),e.xp6(23),e.Q6J("ngForOf",a.scope_list),e.xp6(1),e.Q6J("matChipInputFor",t)("matChipInputSeparatorKeyCodes",a.separators)("matChipInputAddOnBlur",!0)("matAutocomplete",o),e.xp6(5),e.Q6J("ngForOf",e.lcZ(30,15,a.scopes)),e.xp6(7),e.Q6J("matMenuTriggerFor",i),e.xp6(1),e.ekj("opacity-30",!(null!=a.form.value.user&&a.form.value.user.id)),e.xp6(1),e.hij(" ",(null==a.form.value.user?null:a.form.value.user.name)||"Select user"," "),e.xp6(4),e.Q6J("ngModelOptions",e.DdM(25,Rn)),e.xp6(2),e.Q6J("ngForOf",e.Dn7(45,17,e.lcZ(46,21,a.users),0,10)),e.xp6(3),e.Q6J("ngIf",!(null!=(l=e.lcZ(48,23,a.users))&&l.length)),e.xp6(7),e.Q6J("value",null)}}function Qn(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"footer",39)(1,"button",40),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.save())}),e._uU(2,"Save"),e.qZA()()}}function Bn(n,s){if(1&n&&(e.TgZ(0,"main",41),e._UZ(1,"mat-spinner",42),e.TgZ(2,"p"),e._uU(3),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("diameter",32),e.xp6(2),e.Oqu(t.loading)}}let Gn=(()=>{class n{constructor(t){this._service=t,this.event=new e.vpe,this.form=new c.cw({name:new c.NI("",[c.kI.required]),user:new c.NI(null),user_id:new c.NI("",[c.kI.required]),description:new c.NI(""),scopes:new c.NI([],[c.kI.required,c.kI.minLength(1)]),permissions:new c.NI("")}),this.search_str=new C.X(""),this.scopes=this._service.available_scopes,this.users=(0,F.aj)([this._service.users,this.form.valueChanges]).pipe((0,g.U)(([o,{permissions:i}])=>"admin"===i?o.filter(a=>a.sys_admin):"support"===i?o.filter(a=>a.support||a.sys_admin):o.sort((a,l)=>a.name?.localeCompare(l.name)))),this.separators=[V.K5,V.OC,V.L_],this.focusInput=()=>setTimeout(()=>this._input_el?.nativeElement?.focus(),100),this.setSearch=o=>this._service.setSearch(o),this.addScope=o=>(0,me.Z)(this.form.controls.scopes,o),this.removeScope=o=>(0,me.i)(this.form.controls.scopes,o),setTimeout(()=>this.form.patchValue({permissions:null}),100)}get scope_list(){return this.form.controls.scopes.value}save(){if(this.form.markAllAsTouched(),!this.form.valid)return(0,p.cB)(`Some form fields are invalid. [${(0,M.RD)(this.form).join(", ")}]`);delete{...this.form.value}.user,this.event.emit({reason:"done",metadata:this.form.value})}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(ee))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["api-key-modal"]],viewQuery:function(o,i){if(1&o&&e.Gf(Fn,5),2&o){let a;e.iGM(a=e.CRH())&&(i._input_el=a.first)}},outputs:{event:"event"},decls:8,vars:4,consts:()=>{let t;return t=$localize`:@@apiScopePlaceholder␟312125edb94a1ac433d530e4ec51212da69819d9␟4303954101435613129:Scopes...`,[[1,"h-12","flex","items-center","justify-between","p-4"],["btn","","icon","","mat-dialog-close","",4,"ngIf"],["class","w-[32rem] max-w-[calc(100vw-2rem)] p-4",3,"formGroup",4,"ngIf","ngIfElse"],["class","p-4 flex items-center justify-center border-t border-base-200 /20",4,"ngIf"],["load_state",""],["btn","","icon","","mat-dialog-close",""],["className","backoffice-cross"],[1,"w-[32rem]","max-w-[calc(100vw-2rem)]","p-4",3,"formGroup"],[1,"flex","flex-col"],["for","name"],["appearance","outline"],["name","name","formControlName","name","placeholder","Name","matInput",""],["name","description","formControlName","description","placeholder","Description","matInput",""],["for","scope"],["aria-label","Scopes"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["matInput","","placeholder",t,3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matAutocomplete","matChipInputTokenEnd"],["auto","matAutocomplete"],[3,"click",4,"ngFor","ngForOf"],["for","user"],["yPosition","below",1,"mb-8",3,"matMenuTriggerFor","click"],["menu","matMenu"],["appearance","outline",1,"px-2","no-subtext",3,"click"],["matInput","","ngModel","","placeholder","Search users...",3,"ngModelOptions","ngModelChange"],["input",""],["mat-menu-item","",3,"text-secondary","click",4,"ngFor","ngForOf"],["mat-menu-item","","class","text-center",3,"disabled",4,"ngIf"],["for","permissions"],["name","permissions","formControlName","permissions","placeholder","None"],[3,"value"],["value","user"],["value","support"],["value","admin"],[3,"selectable","removable","removed"],["matChipRemove","","className","backoffice-cross",1,""],[3,"click"],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"text-center",3,"disabled"],[1,"p-4","flex","items-center","justify-center","border-t","border-base-200","/20"],["btn","",1,"w-32",3,"click"],[1,"flex","flex-col","items-center","justify-center","space-y-2","p-8","w-[24rem]","h-64"],[3,"diameter"]]},template:function(o,i){if(1&o&&(e.TgZ(0,"header",0)(1,"h2"),e._uU(2,"New API Key"),e.qZA(),e.YNc(3,qn,2,0,"button",1),e.qZA(),e.YNc(4,Kn,62,26,"main",2)(5,Qn,3,0,"footer",3)(6,Bn,4,2,"ng-template",null,4,e.W1O)),2&o){const a=e.MAs(7);e.xp6(3),e.Q6J("ngIf",!i.loading),e.xp6(1),e.Q6J("ngIf",!i.loading&&i.form)("ngIfElse",a),e.xp6(1),e.Q6J("ngIf",!i.loading)}},dependencies:[_.sg,_.O5,c.Fj,c.JJ,c.JL,c.On,c.sg,c.u,T.o,Un.s,f.ZT,A.KE,A.TO,k.Nt,b.Ou,pe.XC,v.ey,pe.ZL,P.gD,W.VK,W.OP,W.p6,K.HS,K.RA,K.oH,K.qH,_.Ov,_.OU]})}return n})(),ee=(()=>{class n{constructor(t){this._dialog=t,this._search=new C.X(""),this._domain=new C.X(null),this._last_key=new C.X(null),this._change=new C.X(0),this.last_key=this._last_key.asObservable(),this.active_domain=this._domain.asObservable(),this.available_domains=(0,d.R2s)({limit:500}).pipe((0,g.U)(o=>o.data),(0,Z.d)(1)),this.available_scopes=(0,d.U2M)("/api/engine/v2/scopes").pipe((0,g.U)(o=>o),(0,Z.d)(1)),this.available_keys=(0,F.aj)([this._domain,this._change]).pipe((0,w.w)(([o])=>o?(0,d.IOR)({query_params:{authority_id:o.id},fn:i=>new de(i),path:"api_keys"}).pipe((0,g.U)(i=>i.data)):(0,R.of)([])),(0,Z.d)(1)),this.users=(0,F.aj)([this._domain,this._search,this._change]).pipe((0,z.b)(300),(0,w.w)(([o,i])=>o?(0,d.E4d)({authority_id:o.id,q:i}).pipe((0,g.U)(a=>a.data)):(0,R.of)([])),(0,Z.d)(1))}setDomain(t){this._domain.next(t)}setSearch(t){this._search.next(t)}newKey(){var t=this;return(0,u.Z)(function*(){const o=t._dialog.open(Gn),i=yield Promise.race([o.componentInstance.event.pipe((0,Y.P)(m=>"done"===m.reason)).toPromise(),o.afterClosed().toPromise()]);if("done"!==i?.reason)return;o.componentInstance.loading="Creating new API key...";const a=t._domain.getValue(),l=yield(0,d.Ue8)({query_params:{},fn:m=>new de(m),path:"api_keys",form_data:{...i.metadata,authority_id:a.id}}).toPromise().catch(m=>{throw o.close(),(0,p.cB)(m),m});t._last_key.next(l),t._change.next(Date.now()),(0,p.t5)("Successfully created new API key."),o.close()})()}removeKey(t){var o=this;return(0,u.Z)(function*(){const i=yield(0,M._5)({title:"Remove API Key",content:"Are you sure you wish to remove this API key?\n                    Removing this key may result in applications using this key to stop working.",icon:{content:"delete"}},o._dialog);"done"===i?.reason&&(i.loading("Removing API key..."),yield(0,d.OdJ)({id:t.id,query_params:{},path:"api_keys"}).toPromise(),i.close(),(0,p.t5)("Successfully removed API key."))})()}static#e=this.\u0275fac=function(o){return new(o||n)(e.LFG(f.uw))};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac})}return n})();var ue=r(857);function Xn(n,s){if(1&n&&(e.TgZ(0,"mat-option",10),e._uU(1),e.qZA()),2&n){const t=s.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.name," ")}}function jn(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",11)(1,"div",12)(2,"label",13),e._uU(3),e.ALo(4,"async"),e.qZA()(),e.TgZ(5,"div",14)(6,"div",15),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.copyKey())}),e._uU(7),e.ALo(8,"async"),e.qZA()()()}if(2&n){const t=e.oxw();let o,i;e.xp6(3),e.hij(" Last API Key Details (",(null==(o=e.lcZ(4,2,t.last_key))?null:o.name)||"Unanamed API Key",") "),e.xp6(4),e.hij(" ",null==(i=e.lcZ(8,4,t.last_key))?null:i.x_api_key," ")}}function Yn(n,s){if(1&n&&(e.TgZ(0,"code",34),e._uU(1),e.qZA()),2&n){const t=s.$implicit;e.xp6(1),e.hij(" ",t," ")}}function Hn(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",26)(1,"div",27),e._uU(2),e.qZA(),e.TgZ(3,"div",28),e._uU(4),e.qZA(),e.TgZ(5,"div",29),e.YNc(6,Yn,2,1,"code",30),e.qZA(),e.TgZ(7,"div",21),e._uU(8),e.qZA(),e.TgZ(9,"div",22),e._uU(10),e.ALo(11,"dateFrom"),e.qZA(),e.TgZ(12,"div",31)(13,"button",32),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.deleteKey(a))}),e._UZ(14,"app-icon",33),e.qZA()()()}if(2&n){const t=s.$implicit;e.xp6(1),e.Q6J("title",t.name),e.xp6(1),e.hij(" ",t.name," "),e.xp6(2),e.Oqu(t.description),e.xp6(2),e.Q6J("ngForOf",t.scopes),e.xp6(2),e.Oqu(t.permissions||"None"),e.xp6(2),e.hij(" ",e.lcZ(11,6,1e3*t.created_at)," ")}}function zn(n,s){if(1&n&&(e.TgZ(0,"div",16)(1,"div",17)(2,"div",18),e._uU(3,"Name"),e.qZA(),e.TgZ(4,"div",19),e._uU(5,"Description"),e.qZA(),e.TgZ(6,"div",20),e._uU(7,"Scopes"),e.qZA(),e.TgZ(8,"div",21),e._uU(9,"Permissions"),e.qZA(),e.TgZ(10,"div",22),e._uU(11,"Created"),e.qZA(),e._UZ(12,"div",23),e.qZA(),e.TgZ(13,"div",24),e.YNc(14,Hn,15,8,"div",25),e.ALo(15,"async"),e.qZA()()),2&n){const t=e.oxw();e.xp6(14),e.Q6J("ngForOf",e.lcZ(15,1,t.key_list))}}function Vn(n,s){1&n&&(e.TgZ(0,"div",35)(1,"app-icon",36),e._uU(2,"close"),e.qZA(),e.TgZ(3,"p"),e._uU(4,"No API keys configured for this domain"),e.qZA()())}let Wn=(()=>{class n{constructor(t,o){this._service=t,this._clipboard=o,this.domain=this._service.active_domain,this.domain_list=this._service.available_domains,this.key_list=this._service.available_keys,this.last_key=this._service.last_key,this.setDomain=i=>this._service.setDomain(i),this.newKey=()=>this._service.newKey(),this.deleteKey=i=>this._service.removeKey(i)}ngOnInit(){var t=this;return(0,u.Z)(function*(){const o=(0,d.N9E)(),i=yield t.domain_list.pipe((0,ce.q)(1)).toPromise();if(!i?.length)return;const a=i.find(l=>l.id===o.id);a&&t.setDomain(a)})()}copyKey(){var t=this;return(0,u.Z)(function*(){const o=yield t.last_key.pipe((0,ce.q)(1)).toPromise();o?.x_api_key&&(t._clipboard.copy(o.x_api_key),(0,p.QD)("Copied API key to clipboard."))})()}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(ee),e.Y36(se.TU))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["admin-api-keys"]],decls:18,vars:16,consts:[[1,"flex","items-start","space-x-2","my-4"],[1,"flex","flex-col","space-y-1"],["for","type"],["appearance","outline",1,"h-12"],["name","type","placeholder","Select Domain...",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["btn","",1,"mt-8","min-w-[8rem]",3,"disabled","click"],["class","rounded shadow border border-base-200 min-w-[24rem]",4,"ngIf"],["role","table","class","min-w-[60rem]",4,"ngIf","ngIfElse"],["load_state",""],[3,"value"],[1,"rounded","shadow","border","border-base-200","min-w-[24rem]"],[1,"border-b","px-2","pb-1","bg-base-200","!w-full"],[1,"p-0","m-0"],[1,"p-2"],[1,"select-all","text-xs","opacity-60","mono","break-words","cursor-pointer",3,"click"],["role","table",1,"min-w-[60rem]"],["table-head",""],[1,"w-48","p-2"],[1,"flex-1","p-2"],[1,"w-32","p-2","truncate"],[1,"w-28","p-2"],[1,"w-32","p-2"],[1,"w-16","p-2"],["table-body",""],["table-row","",4,"ngFor","ngForOf"],["table-row",""],[1,"w-48","p-2","truncate","text-sm",3,"title"],[1,"flex-1","p-2","text-xs"],[1,"w-32","p-2","truncate","flex","items-center","flex-wrap"],["class","m-1",4,"ngFor","ngForOf"],[1,"w-16","p-2","flex","items-center"],["btn","","icon","",3,"click"],["className","backoffice-trash"],[1,"m-1"],[1,"info-block"],[1,"text-3xl"]],template:function(o,i){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"label",2),e._uU(3,"Domain: "),e.qZA(),e.TgZ(4,"mat-form-field",3)(5,"mat-select",4),e.NdJ("ngModelChange",function(l){return i.setDomain(l)}),e.ALo(6,"async"),e.YNc(7,Xn,2,2,"mat-option",5),e.ALo(8,"async"),e.qZA()()(),e.TgZ(9,"button",6),e.NdJ("click",function(){return i.newKey()}),e.ALo(10,"async"),e._uU(11," Add API Key "),e.qZA(),e.YNc(12,jn,9,6,"div",7),e.ALo(13,"async"),e.qZA(),e.YNc(14,zn,16,3,"div",8),e.ALo(15,"async"),e.YNc(16,Vn,5,0,"ng-template",null,9,e.W1O)),2&o){const a=e.MAs(17);let l;e.xp6(5),e.Q6J("ngModel",e.lcZ(6,6,i.domain)),e.xp6(2),e.Q6J("ngForOf",e.lcZ(8,8,i.domain_list)),e.xp6(2),e.Q6J("disabled",!e.lcZ(10,10,i.domain)),e.xp6(3),e.Q6J("ngIf",e.lcZ(13,12,i.last_key)),e.xp6(2),e.Q6J("ngIf",null==(l=e.lcZ(15,14,i.key_list))?null:l.length)("ngIfElse",a)}},dependencies:[_.sg,_.O5,c.JJ,c.On,T.o,A.KE,v.ey,P.gD,_.Ov,ue.R]})}return n})();const L="storages";class eo{constructor(s={}){Object.assign(this,s)}}function Q(n){return new eo(n)}function so(n,s){if(1&n&&(e.TgZ(0,"mat-option",23),e._uU(1),e.qZA()),2&n){const t=s.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function lo(n,s){if(1&n&&(e.TgZ(0,"mat-option",23),e._uU(1),e.qZA()),2&n){const t=s.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function co(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"footer",24)(1,"button",25),e._uU(2," Cancel "),e.qZA(),e.TgZ(3,"button",26),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.save())}),e._uU(4,"Save"),e.qZA()()}}let ro=(()=>{class n{constructor(t,o){this._data=t,this._dialog_ref=o,this.ALLOWED_FILE_EXTENSIONS=["png","webp","bmp","jpg","jpeg","gif","svg","txt","csv","tsv","pdf","tif","tiff","mp3","ogg","rar","zip","mp4","webm"].sort((i,a)=>i.localeCompare(a)),this.ALLOWED_MIME_TYPES=["image/png","image/webp","image/bmp","image/jpeg","image/gif","image/svg+xml","text/plain","text/csv","application/pdf","image/tiff","audio/mpeg","audio/ogg","application/vnd.rar","application/zip","video/mp4","video/webm"].sort((i,a)=>i.localeCompare(a)),this.storage=this._data.item,this.form=new c.cw({id:new c.NI(this._data.item?.id||""),authority_id:new c.NI(this._data.domain||""),storage_type:new c.NI(this._data.item?.storage_type||"s3",[c.kI.required]),bucket_name:new c.NI(this._data.item?.bucket_name||"",[c.kI.required]),region:new c.NI(this._data.item?.region||"",[c.kI.required]),access_key:new c.NI(this._data.item?.access_key||"",[c.kI.required]),access_secret:new c.NI(this._data.item?.access_secret||"",[c.kI.required]),endpoint:new c.NI(this._data.item?.endpoint||""),ext_filter:new c.NI(this._data.item?.ext_filter||[]),mime_filter:new c.NI(this._data.item?.mime_filter||[])}),this.loading=!1}save(){var t=this;return(0,u.Z)(function*(){t.form.markAllAsTouched(),!t.form.invalid&&(t.loading=!0,t._dialog_ref.disableClose=!0,yield function oo(n){const s=(0,d.sWL)(n,["",void 0,null]);return n.id?function no(n,s,t="patch"){return(0,d.Vxg)({id:n,form_data:s,query_params:{},method:t,fn:Q,path:L})}(n.id,s,"put"):function io(n){return(0,d.Ue8)({form_data:n,query_params:{},fn:Q,path:L})}(s)}(t.form.value).toPromise().catch(o=>{throw(0,p.cB)("Failed to save Storage Provider."),t.loading=!1,t._dialog_ref.disableClose=!1,o}),t.loading=!1,t._dialog_ref.disableClose=!1,(0,p.t5)("Successfully saved Storage Provider."),t._dialog_ref.close())})()}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(f.WI),e.Y36(f.so))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["storage-provider-modal"]],decls:54,vars:7,consts:[["btn","","icon","","matRipple","","mat-dialog-close",""],["className","backoffice-close"],[1,"max-h-[65vh]","overflow-auto","px-4","py-2",3,"formGroup"],[1,"flex","space-x-2"],[1,"flex-1","flex","flex-col"],["for","bucket-name"],["appearance","outline"],["matInput","","name","bucket-name","formControlName","bucket_name","placeholder","Bucket Name"],["for","region"],["matInput","","name","region","formControlName","region","placeholder","Region"],["for","access-key"],["matInput","","name","access-key","formControlName","access_key","placeholder","Access Key"],["for","access-secret"],["matInput","","name","access-secret","formControlName","access_secret","placeholder","Access Secret"],[1,"flex","flex-col"],["for","endpoint"],["matInput","","name","endpoint","formControlName","endpoint","placeholder","Endpoint"],["for","extensions"],["name","extensions","formControlName","ext_filter","placeholder","Allow all File Extensions",3,"multiple"],[3,"value",4,"ngFor","ngForOf"],["for","mime-types"],["name","mime-types","formControlName","mime_filter","placeholder","Allow all MIME Types",3,"multiple"],["class","flex items-center justify-end space-x-2 px-4 py-2 border-t border-base-200",4,"ngIf"],[3,"value"],[1,"flex","items-center","justify-end","space-x-2","px-4","py-2","border-t","border-base-200"],["btn","","matRipple","","mat-dialog-close","",1,"inverse","w-32"],["btn","","matRipple","",1,"w-32",3,"click"]],template:function(o,i){1&o&&(e.TgZ(0,"header")(1,"h2"),e._uU(2),e.qZA(),e.TgZ(3,"button",0),e._UZ(4,"app-icon",1),e.qZA()(),e.TgZ(5,"form",2)(6,"div",3)(7,"div",4)(8,"label",5),e._uU(9,"Bucket Name"),e.qZA(),e.TgZ(10,"mat-form-field",6),e._UZ(11,"input",7),e.TgZ(12,"mat-error"),e._uU(13,"Bucket Name is required"),e.qZA()()(),e.TgZ(14,"div",4)(15,"label",8),e._uU(16,"Region"),e.qZA(),e.TgZ(17,"mat-form-field",6),e._UZ(18,"input",9),e.TgZ(19,"mat-error"),e._uU(20,"Region is required"),e.qZA()()()(),e.TgZ(21,"div",3)(22,"div",4)(23,"label",10),e._uU(24,"Access Key"),e.qZA(),e.TgZ(25,"mat-form-field",6),e._UZ(26,"input",11),e.TgZ(27,"mat-error"),e._uU(28,"Access Key is required"),e.qZA()()(),e.TgZ(29,"div",4)(30,"label",12),e._uU(31,"Access Secret"),e.qZA(),e.TgZ(32,"mat-form-field",6),e._UZ(33,"input",13),e.TgZ(34,"mat-error"),e._uU(35,"Access Secret is required"),e.qZA()()()(),e.TgZ(36,"div",14)(37,"label",15),e._uU(38,"Endpoint"),e.qZA(),e.TgZ(39,"mat-form-field",6),e._UZ(40,"input",16),e.qZA()(),e.TgZ(41,"div",14)(42,"label",17),e._uU(43,"Allowed File Extensions"),e.qZA(),e.TgZ(44,"mat-form-field",6)(45,"mat-select",18),e.YNc(46,so,2,2,"mat-option",19),e.qZA()()(),e.TgZ(47,"div",14)(48,"label",20),e._uU(49,"Allowed File MIME types"),e.qZA(),e.TgZ(50,"mat-form-field",6)(51,"mat-select",21),e.YNc(52,lo,2,2,"mat-option",19),e.qZA()()()(),e.YNc(53,co,5,0,"footer",22)),2&o&&(e.xp6(2),e.hij("",null!=i.storage&&i.storage.id?"Edit":"New"," Storage Provider"),e.xp6(3),e.Q6J("formGroup",i.form),e.xp6(40),e.Q6J("multiple",!0),e.xp6(1),e.Q6J("ngForOf",i.ALLOWED_FILE_EXTENSIONS),e.xp6(5),e.Q6J("multiple",!0),e.xp6(1),e.Q6J("ngForOf",i.ALLOWED_MIME_TYPES),e.xp6(1),e.Q6J("ngIf",!i.loading))},dependencies:[_.sg,_.O5,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,T.o,f.ZT,A.KE,A.TO,k.Nt,v.ey,P.gD,v.wG]})}return n})();function _o(n,s){if(1&n&&(e.TgZ(0,"mat-option",4),e._uU(1),e.qZA()),2&n){const t=s.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.name," ")}}const mo=n=>["/domains",n,"about"];function po(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"div",19)(1,"div",20)(2,"a",21),e._uU(3),e.qZA()(),e.TgZ(4,"div",22)(5,"code"),e._uU(6),e.qZA()(),e.TgZ(7,"div",23)(8,"code"),e._uU(9),e.qZA()(),e.TgZ(10,"div",24),e._uU(11),e.ALo(12,"dateFrom"),e.qZA(),e.TgZ(13,"div",25)(14,"button",26),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw(3);return e.KtG(l.edit(a))}),e._UZ(15,"app-icon",27),e.qZA(),e.TgZ(16,"button",26),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw(3);return e.KtG(l.remove(a))}),e._UZ(17,"app-icon",28),e.qZA()()()}if(2&n){const t=s.$implicit;e.xp6(2),e.Q6J("routerLink",e.VKq(7,mo,t.authority_id||"_")),e.xp6(1),e.hij(" ",(null==t.domain?null:t.domain.name)||t.authority_id||"[DEFAULT]"," "),e.xp6(3),e.Oqu(t.storage_type),e.xp6(3),e.Oqu(t.region),e.xp6(2),e.hij(" ",e.lcZ(12,5,1e3*t.updated_at)," ")}}function uo(n,s){if(1&n&&(e.TgZ(0,"div",11)(1,"div",12)(2,"div",13),e._uU(3,"Domain"),e.qZA(),e.TgZ(4,"div",14),e._uU(5,"Store Type"),e.qZA(),e.TgZ(6,"div",15),e._uU(7,"Region"),e.qZA(),e.TgZ(8,"div",15),e._uU(9,"Updated"),e.qZA(),e._UZ(10,"div",16),e.qZA(),e.TgZ(11,"div",17),e.YNc(12,po,18,9,"div",18),e.ALo(13,"async"),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(12),e.Q6J("ngForOf",e.lcZ(13,1,t.storage_list))}}function fo(n,s){if(1&n&&(e.ynx(0),e.YNc(1,uo,14,3,"div",10),e.ALo(2,"async"),e.BQk()),2&n){const t=e.oxw(),o=e.MAs(13);let i;e.xp6(1),e.Q6J("ngIf",null==(i=e.lcZ(2,2,t.storage_list))?null:i.length)("ngIfElse",o)}}function go(n,s){if(1&n&&(e.TgZ(0,"div",29)(1,"p"),e._uU(2),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.hij(" No storage providers for ",t.domain.getValue()?"selected":"any"," domain ")}}function ho(n,s){if(1&n&&(e.TgZ(0,"div",30),e._UZ(1,"mat-spinner",31),e.TgZ(2,"p"),e._uU(3),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("diameter",48),e.xp6(2),e.Oqu(t.loading)}}const Ao=()=>({}),xo=[{path:"",component:Ce,canActivate:[G.w],children:[{path:"about",component:Ue},{path:"database",component:Ne},{path:"clusters",component:nt},{path:"interfaces",component:st},{path:"brokers",component:mt},{path:"edge",component:le},{path:"edge/:id",component:le},{path:"extensions",component:Ut},{path:"staff-api",component:mn},{path:"schemas",component:On},{path:"api-keys",component:Wn},{path:"upload-storage",component:(()=>{class n{constructor(t){this._dialog=t,this.loading="",this.domain_list=(0,d.R2s)().pipe((0,g.U)(o=>o.data),(0,U.K)(o=>[]),(0,Z.d)(1)),this.domain=new C.X(null),this.storage_data=this.domain.pipe((0,w.w)(o=>(this.loading="Loading Storage Providers...",function to(n={}){return(0,d.IOR)({query_params:n,fn:Q,path:L})}({auth_id:o?.id}))),(0,g.U)(({data:o})=>o),(0,U.K)(o=>[]),(0,X.b)(o=>this.loading=""),(0,Z.d)(1)),this.storage_list=(0,F.aj)([this.domain_list,this.storage_data]).pipe((0,g.U)(([o,i])=>o&&i?i.map(a=>({...a,domain:o.find(l=>l.id===a.authority_id)})):[]))}edit(t){this._dialog.open(ro,{data:{item:t,domain:this.domain.getValue()?.id}}).afterClosed().subscribe(()=>this.domain.next(this.domain.getValue()))}remove(t){var o=this;return(0,u.Z)(function*(){const i=yield(0,M._5)({title:"Remove Storage Provider",content:`Are you sure you want to remove the storage provider for ${t.storage_type} ${t.bucket_name}?`,icon:{content:"delete_forever"}},o._dialog);"done"===i.reason&&(i.loading("Removing Storage Provider"),yield function ao(n,s={}){return(0,d.OdJ)({id:n,query_params:s,path:L})}(t.id).toPromise(),o.domain.next(o.domain.getValue()),i.close())})()}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(f.uw))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-storage"]],decls:16,vars:10,consts:[[1,"flex","items-center","justify-between","space-x-2","my-4"],[1,"flex","flex-col","space-y-2"],["appearance","outline",1,"h-12"],["name","type","placeholder","All Domains",3,"ngModel","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["btn","","matRipple","",3,"click"],[4,"ngIf","ngIfElse"],["empty_state",""],["load_state",""],["class","w-full min-w-[40rem]",4,"ngIf","ngIfElse"],[1,"w-full","min-w-[40rem]"],["table-head",""],[1,"flex-1","p-2"],[1,"w-32","p-2"],[1,"w-28","p-2","h-10"],[1,"w-24","p-2","h-10"],["table-body",""],["table-row","",4,"ngFor","ngForOf"],["table-row",""],[1,"flex-1","p-2","truncate"],[1,"underline",3,"routerLink"],[1,"w-32","p-2","truncate","text-xs"],[1,"w-28","p-2","h-12","text-xs"],[1,"w-28","p-2","h-12"],[1,"w-24","px-2","flex","items-center","justify-end"],["btn","","icon","",1,"h-10","w-10",3,"click"],["className","backoffice-edit"],["className","backoffice-trash"],[1,"flex","flex-col","items-center","justify-center","opacity-30","p-8"],[1,"w-full","flex","flex-col","items-center","justify-center"],[1,"mb-4",3,"diameter"]],template:function(o,i){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-form-field",2)(3,"mat-select",3),e.NdJ("ngModelChange",function(l){return i.domain.next(l)}),e.ALo(4,"async"),e.TgZ(5,"mat-option",4),e._uU(6,"All Domains"),e.qZA(),e.YNc(7,_o,2,2,"mat-option",5),e.ALo(8,"async"),e.qZA()()(),e.TgZ(9,"button",6),e.NdJ("click",function(){return i.edit()}),e._uU(10,"Add Storage Provider"),e.qZA()(),e.YNc(11,fo,3,4,"ng-container",7)(12,go,3,1,"ng-template",null,8,e.W1O)(14,ho,4,2,"ng-template",null,9,e.W1O)),2&o){const a=e.MAs(15);e.xp6(3),e.Q6J("ngModel",e.lcZ(4,5,i.domain)),e.xp6(2),e.Q6J("value",e.DdM(9,Ao)),e.xp6(2),e.Q6J("ngForOf",e.lcZ(8,7,i.domain_list)),e.xp6(4),e.Q6J("ngIf",!i.loading)("ngIfElse",a)}},dependencies:[_.sg,_.O5,c.JJ,c.On,O.rH,T.o,A.KE,b.Ou,v.ey,P.gD,v.wG,_.Ov,ue.R]})}return n})()},{path:"extend/:id",component:pt.z},{path:"**",redirectTo:"about"}]},{path:"**",redirectTo:""}];var vo=r(5858);let Co=(()=>{class n{static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275mod=e.oAB({type:n});static#n=this.\u0275inj=e.cJS({providers:[ee],imports:[_.ez,c.u5,c.UX,O.Bz.forChild(xo),vo.X]})}return n})()},7827:(fe,J,r)=>{r.d(J,{F:()=>G});var _=r(2330),c=r(1432),O=r(240);function G(N=0,E=c.P){return(!(0,O.k)(N)||N<0)&&(N=0),(!E||"function"!=typeof E.schedule)&&(E=c.P),new _.y(S=>(S.add(E.schedule(I,N,{subscriber:S,counter:0,period:N})),S))}function I(N){const{subscriber:E,counter:S,period:$}=N;E.next(S),this.schedule({subscriber:E,counter:S+1,period:$},$)}}}]);
//# sourceMappingURL=786.063505c5c2f9653b.js.map