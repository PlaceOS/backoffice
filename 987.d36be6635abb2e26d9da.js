(self.webpackChunkplaceos=self.webpackChunkplaceos||[]).push([[987],{9987:(e,t,i)=>{"use strict";i.r(t),i.d(t,{AppRepositoriesModule:()=>F});var s=i(1511),a=i(3695),n=i(6898),o=i(4762),r=i(5697),c=i(8194),l=i(5546),d=i(8512),f=i(878),m=i(4689),p=i(7727),u=i(9996),v=i(3835),h=i(5712),b=i(8739),g=i(4415),Z=i(1572),_=i(4608);let A=(()=>{class e{constructor(e,t){this._state=e,this._dialog=t,this._loading=new d.X(!1),this.loading=this._loading.asObservable(),this.item=this._state.item,this.driver_list=this._state.all_item.pipe((0,m.w)(e=>e instanceof l.aPq&&e.repo_type!==l.VYb.Interface?(this._loading.next(!0),(0,l.qTj)(e.id,{limit:2e3})):(0,f.of)(null)),(0,p.K)(e=>[]),(0,u.U)(e=>(this._loading.next(!1),e))),this.commit=this._state.all_item.pipe((0,v.h)(e=>e instanceof l.aPq),(0,m.w)(e=>(0,l.rmk)(e.id,{count:1})),(0,p.K)(e=>[]),(0,u.U)(e=>{var t;return(null===(t=e[0])||void 0===t?void 0:t.commit)||"HEAD"}))}get active_item(){return this._state.active_item}pullLatestCommit(){return(0,o.mG)(this,void 0,void 0,function*(){const e=yield(0,l.cYE)(this.active_item.id).toPromise().catch(e=>{(0,b.cB)(`Error pulling latest commit. Error: ${JSON.stringify(e.response||e.message||"Pull timed out")}`)});e&&this._state.replaceItem(new l.aPq(Object.assign(Object.assign({},this.active_item),{commit_hash:e.commit_hash})))})}newDriver(e){return(0,o.mG)(this,void 0,void 0,function*(){this._dialog.open(g.K,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:new l.CbG({name:"",module_name:"",repository_id:this.active_item.id,file_name:e}),name:"Driver",save:e=>(0,l.X2O)(e)}})})}}return e.\u0275fac=function(t){return new(t||e)(Z.LFG(h.L),Z.LFG(_.uw))},e.\u0275prov=Z.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var x=i(7096),q=i(6478);let T=(()=>{class e extends c.K{constructor(e){super(),this._service=e,this.name="repositories",this.tab_list=[]}get extensions(){return(0,r.fq)(this._service.active_item,this.name)}updateTabList(){this.tab_list=(this.driver_count<0||!this.driver_count?[{id:"about",name:"About",icon:{class:"backoffice-info-with-circle"}}]:[{id:"about",name:"About",icon:{class:"backoffice-info-with-circle"}},{id:"drivers",name:"Drivers",count:this.driver_count,icon:{class:"backoffice-documents"}}]).concat(this.extensions)}ngOnInit(){return(0,o.mG)(this,void 0,void 0,function*(){this.subscription("item",this._service.driver_list.subscribe(e=>{this.driver_count=e?e.length:-1,this.updateTabList()})),this.updateTabList()})}}return e.\u0275fac=function(t){return new(t||e)(Z.Y36(A))},e.\u0275cmp=Z.Xpm({type:e,selectors:[["app-repositories"]],features:[Z.qOj],decls:3,vars:1,consts:[[1,"flex-1","flex-col","sm:flex-row","flex","h-full","w-full","relative"],["heading","Repositories","name","repositories",1,"absolute","top-0","left-0","h-12","w-full","sm:h-full","sm:static"],["name","repo","route","repositories",1,"flex-1","relative","mt-12","sm:mt-0","w-full","sm:w-1/2",3,"tabs"]],template:function(e,t){1&e&&(Z.TgZ(0,"div",0),Z._UZ(1,"sidebar",1),Z._UZ(2,"item-display",2),Z.qZA()),2&e&&(Z.xp6(2),Z.Q6J("tabs",t.tab_list))},directives:[x.k,q.s],styles:["sidebar[_ngcontent-%COMP%]{transition:height .3s}@media screen and (min-width:640px){sidebar[_ngcontent-%COMP%]{width:20em!important}}"]}),e})();var w=i(7439),y=i(5980),L=i(7806),I=i(1004),D=i(6529);function O(e,t){1&e&&(Z.ynx(0),Z.SDv(1,23),Z.BQk())}function $(e,t){if(1&e&&(Z.TgZ(0,"div",6),Z.TgZ(1,"label"),Z.SDv(2,24),Z.qZA(),Z.TgZ(3,"div",11),Z._uU(4),Z.qZA(),Z.qZA()),2&e){const e=Z.oxw();Z.xp6(4),Z.Oqu(e.item.branch||"master")}}function U(e,t){if(1&e&&(Z.TgZ(0,"span",25),Z._uU(1),Z.qZA()),2&e){const e=Z.oxw();Z.xp6(1),Z.hij(" (",e.commit,") ")}}function N(e,t){1&e&&Z._UZ(0,"mat-spinner",26)}let z=(()=>{class e extends c.K{constructor(e){super(),this._service=e,this.commit=""}get item(){return this._service.active_item}get local_url(){return this.item.type===l.VYb.Interface?`${location.origin}/${this.item.folder_name}/`:`${location.hash}`}get repo_uri(){var e;return null===(e=this.item)||void 0===e?void 0:e.uri.replace(/\/[a-zA-Z0-9\-\.:]*@/,"/...@")}ngOnInit(){this.commit="",this.subscription("commit",this._service.commit.subscribe(e=>this.commit=e))}pullLatestCommit(){return(0,o.mG)(this,void 0,void 0,function*(){this.pulling=!0,yield this._service.pullLatestCommit(),this.pulling=!1})}}return e.\u0275fac=function(t){return new(t||e)(Z.Y36(A))},e.\u0275cmp=Z.Xpm({type:e,selectors:[["repository-about"]],features:[Z.qOj],decls:53,vars:25,consts:function(){let e,t,i,s,a,n,o,r,c,l,d,f;return e=$localize`:@@repoPullActionDetails␟705317b9b8c222fb8e2835b4ae429a4b968b16f6␟5996546099806594516: Pull the latest commit for${"\ufffd#4\ufffd\ufffd/#4\ufffd"}:LINE_BREAK: this repository `,t=$localize`:@@repoTypeLabel␟e78c0d60ac39787f62c9159646fe0b3c1ed55a1d␟2736556170366900089:Type:`,i=$localize`:␟f07f17add1b4d8fd14dedf1038249bf1fcc7595c␟2995574017154029352:{VAR_SELECT, select, interface {Interface Repository } driver {Driver Repository } , other {=Unknown=}}`,i=Z.Zx4(i,{VAR_SELECT:"\ufffd0\ufffd"}),s=$localize`:@@driverListEmpty␟4c00bff7f0dcbae591d1cdd9e6040169e11900e0␟675757566509609077: ${i}:ICU: `,a=$localize`:@@repoFolderNameLabel␟28e6abdb97b12116fa31c70e842d7b4b37e08fda␟8999240573830223335:Folder name:`,n=$localize`:@@repoUriLabel␟6457460dafb273ccfbc2d68f7ec171f467c6e1c1␟1789506856666851299:Repository URI:`,o=$localize`:@@repoCommitHashLabel␟682ca154aba791fe87aa293b29c921247e12da9c␟7502103762200984555:Commit hash:`,r=$localize`:@@descriptionLabel␟4a22c6843133f0b0d7dc0d28f864f2f90c1de7ad␟6996799422725544865:Description:`,c=$localize`:@@repoCreatedAtLabel␟a5ed099ffc9e96f6970df843289ade8a7d20ab9f␟1616250945945379783:Created:`,l=$localize`:@@repoUpdatedAtLabel␟f94240161f912dbd8758b858877cddeab80f36cb␟1116759395536210856:Updated:`,d=$localize`:@@repoPullAction␟9bcb0809ace39056b42648266b3bd89f1fca0fcb␟2795587821431625096: Pull `,f=$localize`:@@repoBranchLabel␟6ff214f90707e3964f2a08e22f6a079ec2649a5f␟733188758140846537:Branch:`,[[1,"mb-4","text-center"],[1,"w-52"],e,["mat-button","",1,"w-40",3,"disabled","click"],[4,"ngIf","ngIfElse"],[1,"space-y-2"],[1,"flex","items-center","space-x-2"],t,[1,"value"],s,a,[1,"value","select-all"],["target","_blank",3,"href"],["class","flex items-center space-x-2",4,"ngIf"],n,[1,"value","underline","select-all"],o,[1,"value","select-text"],["class","select-text",4,"ngIf"],r,c,l,["spinner",""],d,f,[1,"select-text"],["diameter","32"]]},template:function(e,t){if(1&e&&(Z.TgZ(0,"section",0),Z.TgZ(1,"mat-card",1),Z.TgZ(2,"mat-card-content"),Z.tHW(3,2),Z._UZ(4,"br"),Z.N_p(),Z.qZA(),Z.TgZ(5,"mat-card-actions"),Z.TgZ(6,"button",3),Z.NdJ("click",function(){return t.pullLatestCommit()}),Z.YNc(7,O,2,0,"ng-container",4),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(8,"section",5),Z.TgZ(9,"div",6),Z.TgZ(10,"label"),Z.SDv(11,7),Z.qZA(),Z.TgZ(12,"div",8),Z.SDv(13,9),Z.qZA(),Z.qZA(),Z.TgZ(14,"div",6),Z.TgZ(15,"label"),Z.SDv(16,10),Z.qZA(),Z.TgZ(17,"div",11),Z.TgZ(18,"a",12),Z._uU(19),Z.qZA(),Z.qZA(),Z.qZA(),Z.YNc(20,$,5,1,"div",13),Z.TgZ(21,"div",6),Z.TgZ(22,"label"),Z.SDv(23,14),Z.qZA(),Z.TgZ(24,"div",15),Z.TgZ(25,"a",12),Z.ALo(26,"safe"),Z._uU(27),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(28,"div",6),Z.TgZ(29,"label"),Z.SDv(30,16),Z.qZA(),Z.TgZ(31,"div",17),Z._uU(32),Z.YNc(33,U,2,1,"span",18),Z.qZA(),Z.qZA(),Z.TgZ(34,"div",6),Z.TgZ(35,"label"),Z.SDv(36,19),Z.qZA(),Z.TgZ(37,"div",11),Z._uU(38),Z.qZA(),Z.qZA(),Z.TgZ(39,"div",6),Z.TgZ(40,"label"),Z.SDv(41,20),Z.qZA(),Z.TgZ(42,"div",8),Z._uU(43),Z.ALo(44,"dateFrom"),Z.qZA(),Z.qZA(),Z.TgZ(45,"div",6),Z.TgZ(46,"label"),Z.SDv(47,21),Z.qZA(),Z.TgZ(48,"div",8),Z._uU(49),Z.ALo(50,"dateFrom"),Z.qZA(),Z.qZA(),Z.qZA(),Z.YNc(51,N,1,0,"ng-template",null,22,Z.W1O)),2&e){const e=Z.MAs(52);Z.xp6(6),Z.Q6J("disabled",t.pulling),Z.xp6(1),Z.Q6J("ngIf",!t.pulling)("ngIfElse",e),Z.xp6(6),Z.pQV(t.item.type),Z.QtT(13),Z.xp6(4),Z.ekj("underline","interface"===t.item.type)("pointer-events-none","interface"!==t.item.type),Z.xp6(1),Z.Q6J("href",t.local_url,Z.LSH),Z.xp6(1),Z.Oqu(t.item.folder_name||"No folder set"),Z.xp6(1),Z.Q6J("ngIf","Interface"===t.item.type),Z.xp6(5),Z.Q6J("href",Z.xi3(26,18,t.item.uri,"url"),Z.LSH),Z.xp6(2),Z.Oqu(t.repo_uri||"No URI set"),Z.xp6(5),Z.hij(" ",t.item.commit_hash||"No Commit hash set"," "),Z.xp6(1),Z.Q6J("ngIf",t.commit&&t.commit!==t.item.commit_hash),Z.xp6(5),Z.hij(" ",t.item.description||"No description"," "),Z.xp6(5),Z.Oqu(Z.lcZ(44,21,1e3*t.item.created_at)),Z.xp6(6),Z.Oqu(Z.lcZ(50,23,1e3*t.item.updated_at))}},directives:[w.a8,w.dn,w.hq,y.lW,s.O5,L.$g],pipes:[I.y,D.R],styles:["[_nghost-%COMP%]{padding:1rem;height:100%;width:100%}"]}),e})();var C=i(3609),k=i(3709);function S(e,t){if(1&e){const e=Z.EpF();Z.TgZ(0,"div",13),Z._UZ(1,"div",14),Z.ALo(2,"driverFormat"),Z.TgZ(3,"div",15),Z.TgZ(4,"button",16),Z.NdJ("click",function(){const t=Z.CHM(e).$implicit;return Z.oxw(3).newDriver(t)}),Z._UZ(5,"app-icon",17),Z.qZA(),Z.qZA(),Z.qZA()}if(2&e){const e=t.$implicit;Z.xp6(1),Z.Q6J("innerHTML",Z.lcZ(2,1,e),Z.oJD)}}function E(e,t){if(1&e&&(Z.TgZ(0,"div",6),Z.TgZ(1,"div",7),Z.TgZ(2,"td",8),Z.SDv(3,9),Z.qZA(),Z._UZ(4,"td",10),Z.qZA(),Z.TgZ(5,"div",11),Z.YNc(6,S,6,3,"div",12),Z.ALo(7,"async"),Z.qZA(),Z.qZA()),2&e){const e=Z.oxw(2);Z.xp6(6),Z.Q6J("ngForOf",Z.lcZ(7,1,e.driver_list))}}function J(e,t){if(1&e&&(Z.ynx(0),Z.YNc(1,E,8,3,"div",5),Z.ALo(2,"async"),Z.BQk()),2&e){const e=Z.oxw(),t=Z.MAs(4);let i;Z.xp6(1),Z.Q6J("ngIf",null==(i=Z.lcZ(2,2,e.driver_list))?null:i.length)("ngIfElse",t)}}function Y(e,t){1&e&&(Z.TgZ(0,"div",18),Z.TgZ(1,"p"),Z.SDv(2,19),Z.qZA(),Z.qZA())}function Q(e,t){1&e&&(Z.TgZ(0,"div",18),Z._UZ(1,"mat-spinner",20),Z.TgZ(2,"p"),Z.SDv(3,21),Z.qZA(),Z.qZA())}const P=[{path:":id",component:T,children:[{path:"about",component:z},{path:"drivers",component:(()=>{class e{constructor(e){this._service=e,this.driver_list=this._service.driver_list,this.newDriver=e=>this._service.newDriver(e)}get item(){return this._service.active_item}}return e.\u0275fac=function(t){return new(t||e)(Z.Y36(A))},e.\u0275cmp=Z.Xpm({type:e,selectors:[["repository-drivers"]],decls:7,vars:2,consts:function(){let e,t,i,s;return e=$localize`:@@repoDriverHeader␟0fb2961dd5d0938e459c98921d1effe1d21e759b␟4782277420149557084:Available Drivers`,t=$localize`:@@driverListname␟cff1428d10d59d14e45edec3c735a27b5482db59␟8953033926734869941:Name`,i=$localize`:@@driverListEmpty␟0b0bbe90203a8b9ff0681db976d02fbcd960cb85␟6121742772920538074:No drivers for repository`,s=$localize`:@@driverListLoading␟929bfd86e4829c0b7401762d92f52536a57ca6c0␟4949757592530193773:Loading driver list...`,[[1,"font-medium","text-lg","mb-2"],e,[4,"ngIf","ngIfElse"],["empty_state",""],["load_state",""],["role","table","class","overflow-x-auto",4,"ngIf","ngIfElse"],["role","table",1,"overflow-x-auto"],["table-head",""],[1,"flex-1","p-2"],t,[1,"w-12","p-2","h-10"],["body","",1,"overflow-y-auto"],["table-row","",4,"ngFor","ngForOf"],["table-row",""],[1,"flex-1","p-2",3,"innerHTML"],[1,"w-12","flex","justify-center"],["mat-icon-button","",3,"click"],["className","backoffice-plus"],[1,"flex","flex-col","p-8","items-center","justify-center"],i,["diameter","48",1,"mb-4"],s]},template:function(e,t){if(1&e&&(Z.TgZ(0,"h3",0),Z.SDv(1,1),Z.qZA(),Z.YNc(2,J,3,4,"ng-container",2),Z.YNc(3,Y,3,0,"ng-template",null,3,Z.W1O),Z.YNc(5,Q,4,0,"ng-template",null,4,Z.W1O)),2&e){const e=Z.MAs(6);Z.xp6(2),Z.Q6J("ngIf",!t.loading)("ngIfElse",e)}},directives:[s.O5,s.sg,y.lW,C.o,L.$g],pipes:[s.Ov,k.X],styles:["[_nghost-%COMP%]{padding:1rem;height:100%;width:100%}"]}),e})()},{path:"extend/:id",component:i(3511).z},{path:"**",redirectTo:"about"}]},{path:"**",redirectTo:"-"}];var j=i(7561);let F=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Z.oAB({type:e}),e.\u0275inj=Z.cJS({imports:[[s.ez,a.u5,n.Bz.forChild(P),j.X]]}),e})()}}]);