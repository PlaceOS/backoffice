(self.webpackChunkplaceos=self.webpackChunkplaceos||[]).push([[987],{9987:(e,t,i)=>{"use strict";i.r(t),i.d(t,{AppRepositoriesModule:()=>j});var o=i(1511),a=i(3695),n=i(6898),r=i(4762),s=i(5697),c=i(8194),l=i(1572),d=i(5802),m=i(8512),f=i(878),p=i(4689),u=i(7727),v=i(9996),h=i(3835),b=i(8739),g=i(4415),Z=i(5712),_=i(4608);let A=(()=>{class e{constructor(e,t){this._state=e,this._dialog=t,this._loading=new m.X(!1),this.loading=this._loading.asObservable(),this.item=this._state.item,this.driver_list=this._state.all_item.pipe((0,p.w)(e=>e instanceof d.aPq&&e.repo_type!==d.VYb.Interface?(this._loading.next(!0),(0,d.qTj)(e.id,{limit:2e3})):(0,f.of)(null)),(0,u.K)(e=>[]),(0,v.U)(e=>(this._loading.next(!1),e))),this.commit=this._state.all_item.pipe((0,h.h)(e=>e instanceof d.aPq),(0,p.w)(e=>(0,d.rmk)(e.id,{count:1})),(0,u.K)(e=>[]),(0,v.U)(e=>{var t;return(null===(t=e[0])||void 0===t?void 0:t.commit)||"HEAD"}))}get active_item(){return this._state.active_item}pullLatestCommit(){return(0,r.mG)(this,void 0,void 0,function*(){const e=yield(0,d.cYE)(this.active_item.id).toPromise().catch(e=>{(0,b.cB)(`Error pulling latest commit. Error: ${JSON.stringify(e.response||e.message||"Pull timed out")}`)});e&&this._state.replaceItem(new d.aPq(Object.assign(Object.assign({},this.active_item),{commit_hash:e.commit_hash})))})}newDriver(e){return(0,r.mG)(this,void 0,void 0,function*(){this._dialog.open(g.K,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:new d.CbG({name:"",module_name:"",repository_id:this.active_item.id,file_name:e}),name:"Driver",save:e=>(0,d.X2O)(e)}})})}}return e.\u0275fac=function(t){return new(t||e)(l.LFG(Z.L),l.LFG(_.uw))},e.\u0275prov=l.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var x=i(7096),T=i(6478);let q=(()=>{class e extends c.K{constructor(e){super(),this._service=e,this.name="repositories",this.tab_list=[]}get extensions(){return(0,s.fq)(this._service.active_item,this.name)}updateTabList(){this.tab_list=(this.driver_count<0||!this.driver_count?[{id:"about",name:"About",icon:{class:"backoffice-info-with-circle"}}]:[{id:"about",name:"About",icon:{class:"backoffice-info-with-circle"}},{id:"drivers",name:"Drivers",count:this.driver_count,icon:{class:"backoffice-documents"}}]).concat(this.extensions)}ngOnInit(){return(0,r.mG)(this,void 0,void 0,function*(){this.subscription("item",this._service.driver_list.subscribe(e=>{this.driver_count=e?e.length:-1,this.updateTabList()})),this.updateTabList()})}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(A))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-repositories"]],features:[l.qOj],decls:3,vars:1,consts:[[1,"flex-1","flex-col","sm:flex-row","flex","h-full","w-full","relative"],["heading","Repositories","name","repositories",1,"absolute","top-0","left-0","h-12","w-full","sm:h-full","sm:static"],["name","repo","route","repositories",1,"flex-1","relative","mt-12","sm:mt-0","w-full","sm:w-1/2",3,"tabs"]],template:function(e,t){1&e&&(l.TgZ(0,"div",0),l._UZ(1,"sidebar",1),l._UZ(2,"item-display",2),l.qZA()),2&e&&(l.xp6(2),l.Q6J("tabs",t.tab_list))},directives:[x.k,T.s],styles:["sidebar[_ngcontent-%COMP%]{transition:height .3s}@media screen and (min-width:640px){sidebar[_ngcontent-%COMP%]{width:20em!important}}"]}),e})();var w=i(7439),y=i(5980),L=i(7806),D=i(1004),O=i(6529);function $(e,t){1&e&&(l.ynx(0),l.SDv(1,24),l.BQk())}function I(e,t){if(1&e&&(l.TgZ(0,"span",25),l._uU(1),l.qZA()),2&e){const e=l.oxw();l.xp6(1),l.hij(" (",e.commit,") ")}}function U(e,t){1&e&&l._UZ(0,"mat-spinner",26)}let k=(()=>{class e extends c.K{constructor(e){super(),this._service=e,this.commit=""}get item(){return this._service.active_item}get local_url(){return this.item.type===d.VYb.Interface?`${location.origin}/${this.item.folder_name}/`:`${location.hash}`}get repo_uri(){var e;return null===(e=this.item)||void 0===e?void 0:e.uri.replace(/\/[a-zA-Z0-9\-\.:]*@/,"/...@")}ngOnInit(){this.commit="",this.subscription("commit",this._service.commit.subscribe(e=>this.commit=e))}pullLatestCommit(){return(0,r.mG)(this,void 0,void 0,function*(){this.pulling=!0,yield this._service.pullLatestCommit(),this.pulling=!1})}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(A))},e.\u0275cmp=l.Xpm({type:e,selectors:[["repository-about"]],features:[l.qOj],decls:57,vars:25,consts:function(){let e,t,i,o,a,n,r,s,c,d,m,f;return e=$localize`:@@repoPullActionDetails␟705317b9b8c222fb8e2835b4ae429a4b968b16f6␟5996546099806594516: Pull the latest commit for${"\ufffd#4\ufffd\ufffd/#4\ufffd"}:LINE_BREAK: this repository `,t=$localize`:@@repoTypeLabel␟e78c0d60ac39787f62c9159646fe0b3c1ed55a1d␟2736556170366900089:Type:`,i=$localize`:␟f07f17add1b4d8fd14dedf1038249bf1fcc7595c␟2995574017154029352:{VAR_SELECT, select, interface {Interface Repository } driver {Driver Repository } , other {=Unknown=}}`,i=l.Zx4(i,{VAR_SELECT:"\ufffd0\ufffd"}),o=$localize`:@@driverListEmpty␟4c00bff7f0dcbae591d1cdd9e6040169e11900e0␟675757566509609077: ${i}:ICU: `,a=$localize`:@@repoFolderNameLabel␟28e6abdb97b12116fa31c70e842d7b4b37e08fda␟8999240573830223335:Folder name:`,n=$localize`:@@repoUriLabel␟6457460dafb273ccfbc2d68f7ec171f467c6e1c1␟1789506856666851299:Repository URI:`,r=$localize`:@@repoBranchLabel␟6ff214f90707e3964f2a08e22f6a079ec2649a5f␟733188758140846537:Branch:`,s=$localize`:@@repoCommitHashLabel␟682ca154aba791fe87aa293b29c921247e12da9c␟7502103762200984555:Commit hash:`,c=$localize`:@@descriptionLabel␟4a22c6843133f0b0d7dc0d28f864f2f90c1de7ad␟6996799422725544865:Description:`,d=$localize`:@@repoCreatedAtLabel␟a5ed099ffc9e96f6970df843289ade8a7d20ab9f␟1616250945945379783:Created:`,m=$localize`:@@repoUpdatedAtLabel␟f94240161f912dbd8758b858877cddeab80f36cb␟1116759395536210856:Updated:`,f=$localize`:@@repoPullAction␟9bcb0809ace39056b42648266b3bd89f1fca0fcb␟2795587821431625096: Pull `,[[1,"mb-4","text-center"],[1,"w-52"],e,["mat-button","",1,"w-40",3,"disabled","click"],[4,"ngIf","ngIfElse"],[1,"space-y-2"],[1,"flex","items-center","space-x-2"],t,[1,"value"],o,a,[1,"value","select-all"],["target","_blank",3,"href"],n,[1,"value","underline","select-all"],r,[1,"value","select-all","bg-gray-200","px-2","pb-1","pt-2","text-xs","rounded","mono","dark:text-black"],s,[1,"value","select-text","bg-gray-200","px-2","pb-1","pt-2","text-xs","rounded","mono","dark:text-black"],["class","select-text mono",4,"ngIf"],c,d,m,["spinner",""],f,[1,"select-text","mono"],["diameter","32"]]},template:function(e,t){if(1&e&&(l.TgZ(0,"section",0),l.TgZ(1,"mat-card",1),l.TgZ(2,"mat-card-content"),l.tHW(3,2),l._UZ(4,"br"),l.N_p(),l.qZA(),l.TgZ(5,"mat-card-actions"),l.TgZ(6,"button",3),l.NdJ("click",function(){return t.pullLatestCommit()}),l.YNc(7,$,2,0,"ng-container",4),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(8,"section",5),l.TgZ(9,"div",6),l.TgZ(10,"label"),l.SDv(11,7),l.qZA(),l.TgZ(12,"div",8),l.SDv(13,9),l.qZA(),l.qZA(),l.TgZ(14,"div",6),l.TgZ(15,"label"),l.SDv(16,10),l.qZA(),l.TgZ(17,"div",11),l.TgZ(18,"a",12),l._uU(19),l.qZA(),l.qZA(),l.qZA(),l.TgZ(20,"div",6),l.TgZ(21,"label"),l.SDv(22,13),l.qZA(),l.TgZ(23,"div",14),l.TgZ(24,"a",12),l.ALo(25,"safe"),l._uU(26),l.qZA(),l.qZA(),l.qZA(),l.TgZ(27,"div",6),l.TgZ(28,"label"),l.SDv(29,15),l.qZA(),l.TgZ(30,"div",16),l._uU(31),l.qZA(),l.qZA(),l.TgZ(32,"div",6),l.TgZ(33,"label"),l.SDv(34,17),l.qZA(),l.TgZ(35,"div",18),l._uU(36),l.YNc(37,I,2,1,"span",19),l.qZA(),l.qZA(),l.TgZ(38,"div",6),l.TgZ(39,"label"),l.SDv(40,20),l.qZA(),l.TgZ(41,"div",11),l._uU(42),l.qZA(),l.qZA(),l.TgZ(43,"div",6),l.TgZ(44,"label"),l.SDv(45,21),l.qZA(),l.TgZ(46,"div",8),l._uU(47),l.ALo(48,"dateFrom"),l.qZA(),l.qZA(),l.TgZ(49,"div",6),l.TgZ(50,"label"),l.SDv(51,22),l.qZA(),l.TgZ(52,"div",8),l._uU(53),l.ALo(54,"dateFrom"),l.qZA(),l.qZA(),l.qZA(),l.YNc(55,U,1,0,"ng-template",null,23,l.W1O)),2&e){const e=l.MAs(56);l.xp6(6),l.Q6J("disabled",t.pulling),l.xp6(1),l.Q6J("ngIf",!t.pulling)("ngIfElse",e),l.xp6(6),l.pQV(t.item.type),l.QtT(13),l.xp6(4),l.ekj("underline","interface"===t.item.type)("pointer-events-none","interface"!==t.item.type),l.xp6(1),l.Q6J("href",t.local_url,l.LSH),l.xp6(1),l.Oqu(t.item.folder_name||"No folder set"),l.xp6(5),l.Q6J("href",l.xi3(25,18,t.item.uri,"url"),l.LSH),l.xp6(2),l.Oqu(t.repo_uri||"No URI set"),l.xp6(5),l.hij(" ",t.item.branch||"master"," "),l.xp6(5),l.hij(" ",t.item.commit_hash||"No Commit hash set"," "),l.xp6(1),l.Q6J("ngIf",t.commit&&t.commit!==t.item.commit_hash),l.xp6(5),l.hij(" ",t.item.description||"No description"," "),l.xp6(5),l.Oqu(l.lcZ(48,21,1e3*t.item.created_at)),l.xp6(6),l.Oqu(l.lcZ(54,23,1e3*t.item.updated_at))}},directives:[w.a8,w.dn,w.hq,y.lW,o.O5,L.$g],pipes:[D.y,O.R],styles:["[_nghost-%COMP%]{padding:1rem;height:100%;width:100%}.mono[_ngcontent-%COMP%]{font-family:var(--mono-font)}"]}),e})();var C=i(3609),z=i(3709);function N(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",13),l._UZ(1,"div",14),l.ALo(2,"driverFormat"),l.TgZ(3,"div",15),l.TgZ(4,"button",16),l.NdJ("click",function(){const t=l.CHM(e).$implicit;return l.oxw(3).newDriver(t)}),l._UZ(5,"app-icon",17),l.qZA(),l.qZA(),l.qZA()}if(2&e){const e=t.$implicit;l.xp6(1),l.Q6J("innerHTML",l.lcZ(2,1,e),l.oJD)}}function S(e,t){if(1&e&&(l.TgZ(0,"div",6),l.TgZ(1,"div",7),l.TgZ(2,"td",8),l.SDv(3,9),l.qZA(),l._UZ(4,"td",10),l.qZA(),l.TgZ(5,"div",11),l.YNc(6,N,6,3,"div",12),l.ALo(7,"async"),l.qZA(),l.qZA()),2&e){const e=l.oxw(2);l.xp6(6),l.Q6J("ngForOf",l.lcZ(7,1,e.driver_list))}}function E(e,t){if(1&e&&(l.ynx(0),l.YNc(1,S,8,3,"div",5),l.ALo(2,"async"),l.BQk()),2&e){const e=l.oxw(),t=l.MAs(4);let i;l.xp6(1),l.Q6J("ngIf",null==(i=l.lcZ(2,2,e.driver_list))?null:i.length)("ngIfElse",t)}}function J(e,t){1&e&&(l.TgZ(0,"div",18),l.TgZ(1,"p"),l.SDv(2,19),l.qZA(),l.qZA())}function Y(e,t){1&e&&(l.TgZ(0,"div",18),l._UZ(1,"mat-spinner",20),l.TgZ(2,"p"),l.SDv(3,21),l.qZA(),l.qZA())}const P=[{path:":id",component:q,children:[{path:"about",component:k},{path:"drivers",component:(()=>{class e{constructor(e){this._service=e,this.driver_list=this._service.driver_list,this.newDriver=e=>this._service.newDriver(e)}get item(){return this._service.active_item}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(A))},e.\u0275cmp=l.Xpm({type:e,selectors:[["repository-drivers"]],decls:7,vars:2,consts:function(){let e,t,i,o;return e=$localize`:@@repoDriverHeader␟0fb2961dd5d0938e459c98921d1effe1d21e759b␟4782277420149557084:Available Drivers`,t=$localize`:@@driverListname␟cff1428d10d59d14e45edec3c735a27b5482db59␟8953033926734869941:Name`,i=$localize`:@@driverListEmpty␟0b0bbe90203a8b9ff0681db976d02fbcd960cb85␟6121742772920538074:No drivers for repository`,o=$localize`:@@driverListLoading␟929bfd86e4829c0b7401762d92f52536a57ca6c0␟4949757592530193773:Loading driver list...`,[[1,"font-medium","text-lg","mb-2"],e,[4,"ngIf","ngIfElse"],["empty_state",""],["load_state",""],["role","table","class","overflow-x-auto",4,"ngIf","ngIfElse"],["role","table",1,"overflow-x-auto"],["table-head",""],[1,"flex-1","p-2"],t,[1,"w-12","p-2","h-10"],["body","",1,"overflow-y-auto"],["table-row","",4,"ngFor","ngForOf"],["table-row",""],[1,"flex-1","p-2",3,"innerHTML"],[1,"w-12","flex","justify-center"],["mat-icon-button","",3,"click"],["className","backoffice-plus"],[1,"flex","flex-col","p-8","items-center","justify-center"],i,["diameter","48",1,"mb-4"],o]},template:function(e,t){if(1&e&&(l.TgZ(0,"h3",0),l.SDv(1,1),l.qZA(),l.YNc(2,E,3,4,"ng-container",2),l.YNc(3,J,3,0,"ng-template",null,3,l.W1O),l.YNc(5,Y,4,0,"ng-template",null,4,l.W1O)),2&e){const e=l.MAs(6);l.xp6(2),l.Q6J("ngIf",!t.loading)("ngIfElse",e)}},directives:[o.O5,o.sg,y.lW,C.o,L.$g],pipes:[o.Ov,z.X],styles:["[_nghost-%COMP%]{padding:1rem;height:100%;width:100%}"]}),e})()},{path:"extend/:id",component:i(3511).z},{path:"**",redirectTo:"about"}]},{path:"**",redirectTo:"-"}];var Q=i(7561);let j=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({imports:[[o.ez,a.u5,n.Bz.forChild(P),Q.X]]}),e})()}}]);
//# sourceMappingURL=987.2d905f9376280c857e4c.js.map