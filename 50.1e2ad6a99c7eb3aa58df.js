(self.webpackChunkplaceos=self.webpackChunkplaceos||[]).push([[50],{50:(e,t,i)=>{"use strict";i.r(t),i.d(t,{AppModulesModule:()=>le});var s=i(1511),n=i(3695),o=i(6898),a=i(4762),c=i(5802),l=i(5712),d=i(8194),r=i(5697),u=i(1572),m=i(7096),f=i(6478);let g=(()=>{class e extends d.K{constructor(e){super(),this._service=e,this.name="modules",this.show_options=this._service.show_options,this.tab_list=[]}get extensions(){return(0,r.fq)(this._service.active_item,this.name)}updateTabList(){this.tab_list=[{id:"about",name:"About",icon:{class:"backoffice-info-with-circle"}},{id:"systems",name:"Systems",count:this.system_count,icon:{class:"backoffice-documents"}},{id:"history",name:"Settings History",icon:{class:"backoffice-clock"}}].concat(this.extensions)}ngOnInit(){this.subscription("item",this._service.item.subscribe(e=>{this.loadValues(e),this.updateTabList()})),this.updateTabList()}loadValues(e){return(0,a.mG)(this,void 0,void 0,function*(){if(!e)return;const t={offset:0,limit:1,module_id:e.id};this.system_count=(yield(0,c.vIL)(t).toPromise()).total})}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(l.L))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-modules"]],features:[u.qOj],decls:3,vars:1,consts:[[1,"flex-1","flex-col","sm:flex-row","flex","h-full","w-full","relative"],["heading","Modules","name","modules",1,"absolute","top-0","left-0","h-12","w-full","sm:h-full","sm:static"],["name","module","route","modules",1,"flex-1","relative","mt-12","sm:mt-0","w-full","sm:w-1/2",3,"tabs"]],template:function(e,t){1&e&&(u.TgZ(0,"div",0),u._UZ(1,"sidebar",1),u._UZ(2,"item-display",2),u.qZA()),2&e&&(u.xp6(2),u.Q6J("tabs",t.tab_list))},directives:[m.k,f.s],styles:["sidebar[_ngcontent-%COMP%]{transition:height .3s}@media screen and (min-width:640px){sidebar[_ngcontent-%COMP%]{width:20em!important}}"]}),e})();var p=i(8512),Z=i(878),v=i(3835),h=i(7701),b=i(4689),_=i(8303),x=i(9996),A=i(7727),q=i(4019),T=i(8739),y=i(5646),L=i(4608);let w=(()=>{class e{constructor(e,t){this._state=e,this._dialog=t,this._loading=new p.X(!1),this.loading=this._loading.asObservable(),this.item=this._state.item.pipe((0,v.h)(e=>e instanceof c.SQz)),this.associated_settings=this._state.all_item.pipe((0,h.b)(300),(0,b.w)(e=>e&&e instanceof c.SQz?(0,c.eRm)(e.id):[])),this.driver=this.item.pipe((0,b.w)(e=>(0,c.L4d)(e.driver_id)),(0,_.d)(1)),this.system=this.item.pipe((0,b.w)(e=>e.system_id?(0,c.hMA)(e.system_id):(0,Z.of)(null)),(0,_.d)(1)),this.system_list=this.item.pipe((0,b.w)(e=>(this._loading.next(!0),console.log("Loading Systems..."),(0,c.vIL)({module_id:e.id}))),(0,x.U)(e=>e.data),(0,A.K)(()=>[]),(0,q.b)(e=>this._loading.next(!1)),(0,_.d)(1))}get active_item(){return this._state.active_item}toggleModuleState(){return(0,a.mG)(this,void 0,void 0,function*(){const e=this.active_item.running?c.iAP:c.Dqv,t=yield e(this.active_item.id).toPromise().catch(e=>e);t?"string"==typeof t&&t.length<64?(0,T.cB)(t):(0,T.cB)(`Failed to ${this.active_item.running?"stop":"start"} device '${this.active_item.id}'.\nView Error?`,"View",()=>this.viewDetails(t)):((0,T.t5)("Module successfully "+(this.active_item.running?"stopped":"started")),this.active_item.running=!this.active_item.running)})}viewDetails(e){this._dialog.open(y.a,{data:{content:e}})}}return e.\u0275fac=function(t){return new(t||e)(u.LFG(l.L),u.LFG(L.uw))},e.\u0275prov=u.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var S=i(5980),U=i(7806),I=i(9441),J=i(6529);function N(e,t){if(1&e&&(u.TgZ(0,"div",2),u.TgZ(1,"label"),u.SDv(2,14),u.qZA(),u.TgZ(3,"div",4),u._uU(4),u.qZA(),u.qZA()),2&e){const e=u.oxw();u.xp6(4),u.Oqu(e.item.notes)}}function O(e,t){if(1&e&&(u.TgZ(0,"div",2),u.TgZ(1,"label"),u.SDv(2,15),u.qZA(),u.TgZ(3,"div",4),u._uU(4),u.qZA(),u.qZA()),2&e){const e=u.oxw();u.xp6(4),u.Oqu(e.item.ip)}}function Q(e,t){if(1&e&&(u.TgZ(0,"div",2),u.TgZ(1,"label"),u.SDv(2,16),u.qZA(),u.TgZ(3,"div",4),u._uU(4),u.qZA(),u.qZA()),2&e){const e=u.oxw();u.xp6(4),u.Oqu(e.item.port)}}function $(e,t){if(1&e&&(u.TgZ(0,"div",2),u.TgZ(1,"label"),u.SDv(2,17),u.qZA(),u.TgZ(3,"div",4),u._uU(4),u.ALo(5,"dateFrom"),u.qZA(),u.qZA()),2&e){const e=u.oxw();u.xp6(4),u.Oqu(u.lcZ(5,1,1e3*e.item.created_at))}}function D(e,t){if(1&e&&(u.TgZ(0,"div",2),u.TgZ(1,"label"),u.SDv(2,18),u.qZA(),u.TgZ(3,"div",4),u._uU(4),u.ALo(5,"dateFrom"),u.qZA(),u.qZA()),2&e){const e=u.oxw();u.xp6(4),u.Oqu(u.lcZ(5,1,1e3*e.item.updated_at))}}const M=function(e){return["/drivers",e]};function z(e,t){if(1&e&&(u.TgZ(0,"div",2),u.TgZ(1,"label"),u.SDv(2,19),u.qZA(),u.TgZ(3,"a",20),u._uU(4),u.ALo(5,"async"),u.qZA(),u.qZA()),2&e){const e=u.oxw();u.xp6(3),u.Q6J("routerLink",u.VKq(4,M,e.item.driver_id)),u.xp6(1),u.hij(" ",u.lcZ(5,2,e.driver).name||"<Unnamed>"," ")}}const Y=function(e){return["/systems",e,"modules"]};function k(e,t){if(1&e&&(u.TgZ(0,"div",2),u.TgZ(1,"label"),u.SDv(2,21),u.qZA(),u.TgZ(3,"a",20),u.ALo(4,"async"),u._uU(5),u.ALo(6,"async"),u.qZA(),u.qZA()),2&e){const e=u.oxw();u.xp6(3),u.Q6J("routerLink",u.VKq(6,Y,u.lcZ(4,2,e.system).id)),u.xp6(2),u.hij(" ",u.lcZ(6,4,e.system).name," ")}}function C(e,t){if(1&e&&(u.TgZ(0,"div",22),u.SDv(1,23),u.qZA()),2&e){const e=u.oxw();u.xp6(1),u.pQV(e.item.running),u.QtT(1)}}function P(e,t){1&e&&u._UZ(0,"mat-spinner",24)}const E=function(){return[]};function F(e,t){if(1&e&&(u.TgZ(0,"section"),u._UZ(1,"a-settings-form",25),u.ALo(2,"async"),u.qZA()),2&e){const e=u.oxw();u.xp6(1),u.Q6J("id",e.item.id)("merge",!0)("settings",e.item.settings)("merge_settings",u.lcZ(2,4,e.other_settings)||u.DdM(6,E))}}function V(e,t){1&e&&(u.TgZ(0,"div",26),u._UZ(1,"mat-spinner",27),u.TgZ(2,"p"),u.SDv(3,28),u.qZA(),u.qZA())}let j=(()=>{class e{constructor(e){this._service=e,this.driver=this._service.driver,this.system=this._service.system,this.other_settings=this._service.associated_settings}get item(){return this._service.active_item}toggleModuleState(){return(0,a.mG)(this,void 0,void 0,function*(){this.stopping=!0,yield this._service,this.stopping=!1})}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(w))},e.\u0275cmp=u.Xpm({type:e,selectors:[["module-about"]],decls:32,vars:20,consts:function(){let e,t,i,s,n,o,a,c,l,d,r,m,f;return e=$localize`:@moduleTLSLabel␟fc14542d8661d50a55ec617e759b8275266b4084␟6787048658913260060:TLS:`,t=$localize`:@moduleUDPLabel␟45a627302b2be9d4d92e8361c28128b8747a3a76␟9217682045572066115:UDP:`,i=$localize`:@@settingsLabel␟121cc5391cd2a5115bc2b3160379ee5b36cd7716␟4930506384627295710:Settings`,s=$localize`:@moduleNotesLabel␟3b193ba24bd715ed412f5419df3acb59090141d3␟8421971980013015956:Notes:`,n=$localize`:@moduleIPLabel␟8271bb466916303dc1516952bf50e7e6626f7b2c␟253752108238785328:IP:`,o=$localize`:@modulePortLabel␟a2ceedad860954f374fc1ac8bae057292b1cec2e␟6167294183925653141:Port:`,a=$localize`:@@moduleCreatedAtLabel␟a5ed099ffc9e96f6970df843289ade8a7d20ab9f␟1616250945945379783:Created:`,c=$localize`:@moduleUpdatedAtLabel␟f94240161f912dbd8758b858877cddeab80f36cb␟1116759395536210856:Updated:`,l=$localize`:@moduleUpdatedAtLabel␟797f76e214854e3930b89347440a035b92fb3adb␟1174891546565206449:Driver:`,d=$localize`:@moduleUpdatedAtLabel␟9680e97832208eb205d7d7e643c30265d8b4e9f5␟4615578067123890535:Logic for system:`,r=$localize`:␟2e434410a64453fd12259ac38cfcb4f7b4b26137␟2537520834646109979:{VAR_SELECT, select, true {Stop Module } false {Start Module }}`,r=u.Zx4(r,{VAR_SELECT:"\ufffd0\ufffd"}),m=$localize`:@@moduleStateToggle␟d09fa3d7f10a3f4ba1dbb8ede1ea6f993f0adc3b␟6594646568873405470: ${r}:ICU: `,f=$localize`:@@moduleDetailsLoading␟cb7cffb188a2b0bce758e40f67c29387dd6ccfcf␟3678638452756535871:Loading module settings...`,[[1,"space-y-2"],["class","flex items-center space-x-2",4,"ngIf"],[1,"flex","items-center","space-x-2"],e,[1,"value"],t,[1,"my-4"],["mat-button","",3,"disabled","click"],["class","text",4,"ngIf"],["diameter","32",4,"ngIf"],[1,"font-medium","text-lg"],i,[4,"ngIf","ngIfElse"],["load_state",""],s,n,o,a,c,l,[1,"underline",3,"routerLink"],d,[1,"text"],m,["diameter","32"],[3,"id","merge","settings","merge_settings"],[1,"p-8","flex","flex-col","items-center","justify-center","m-auto"],["diameter","48",1,"mb-4"],f]},template:function(e,t){if(1&e&&(u.TgZ(0,"section",0),u.YNc(1,N,5,1,"div",1),u.YNc(2,O,5,1,"div",1),u.YNc(3,Q,5,1,"div",1),u.TgZ(4,"div",2),u.TgZ(5,"label"),u.SDv(6,3),u.qZA(),u.TgZ(7,"div",4),u._uU(8),u.qZA(),u.qZA(),u.TgZ(9,"div",2),u.TgZ(10,"label"),u.SDv(11,5),u.qZA(),u.TgZ(12,"div",4),u._uU(13),u.qZA(),u.qZA(),u.YNc(14,$,6,3,"div",1),u.YNc(15,D,6,3,"div",1),u.YNc(16,z,6,6,"div",1),u.ALo(17,"async"),u.YNc(18,k,7,8,"div",1),u.ALo(19,"async"),u.qZA(),u._UZ(20,"hr",6),u.TgZ(21,"section"),u.TgZ(22,"button",7),u.NdJ("click",function(){return t.toggleModuleState()}),u.YNc(23,C,2,1,"div",8),u.YNc(24,P,1,0,"mat-spinner",9),u.qZA(),u.qZA(),u._UZ(25,"hr",6),u.TgZ(26,"header",10),u.SDv(27,11),u.qZA(),u.YNc(28,F,3,7,"section",12),u.ALo(29,"async"),u.YNc(30,V,4,0,"ng-template",null,13,u.W1O)),2&e){const e=u.MAs(31);u.xp6(1),u.Q6J("ngIf",t.item.notes),u.xp6(1),u.Q6J("ngIf",t.item.ip),u.xp6(1),u.Q6J("ngIf",t.item.port),u.xp6(5),u.Oqu(t.item.tls),u.xp6(5),u.Oqu(t.item.udp),u.xp6(1),u.Q6J("ngIf",t.item.created_at),u.xp6(1),u.Q6J("ngIf",t.item.updated_at),u.xp6(1),u.Q6J("ngIf",u.lcZ(17,14,t.driver)),u.xp6(2),u.Q6J("ngIf",u.lcZ(19,16,t.system)),u.xp6(4),u.Q6J("disabled",t.stopping),u.xp6(1),u.Q6J("ngIf",!t.stopping),u.xp6(1),u.Q6J("ngIf",t.stopping),u.xp6(4),u.Q6J("ngIf",t.item.settings&&u.lcZ(29,18,t.other_settings))("ngIfElse",e)}},directives:[s.O5,S.lW,o.yS,U.$g,I.v],pipes:[s.Ov,J.R],styles:["[_nghost-%COMP%]{padding:1rem;height:100%;width:100%}"]}),e})();var K=i(3080),X=i(6283),G=i(3609),R=i(6756);const B=function(e){return["/systems",e]};function W(e,t){if(1&e&&(u.TgZ(0,"div",18),u.TgZ(1,"div",19),u.TgZ(2,"a",20),u._uU(3),u.qZA(),u.qZA(),u.TgZ(4,"div",12),u._uU(5),u.qZA(),u.TgZ(6,"div",14),u._uU(7),u.ALo(8,"dateFrom"),u.qZA(),u.qZA()),2&e){const e=t.$implicit;u.xp6(2),u.Q6J("routerLink",u.VKq(6,B,e.id)),u.xp6(1),u.Oqu(e.name),u.xp6(2),u.hij(" ",e.installed_ui_devices||"0"," "),u.xp6(2),u.hij(" ",u.lcZ(8,4,1e3*e.created_at)," ")}}function H(e,t){if(1&e&&(u.TgZ(0,"div",8),u.TgZ(1,"div",9),u.TgZ(2,"div",10),u.SDv(3,11),u.qZA(),u.TgZ(4,"div",12),u.SDv(5,13),u.qZA(),u.TgZ(6,"div",14),u.SDv(7,15),u.qZA(),u.qZA(),u.TgZ(8,"div",16),u.YNc(9,W,9,8,"div",17),u.ALo(10,"async"),u.qZA(),u.qZA()),2&e){const e=u.oxw(2);u.xp6(9),u.Q6J("ngForOf",u.lcZ(10,1,e.system_list))}}function ee(e,t){if(1&e&&(u.TgZ(0,"section"),u.YNc(1,H,11,3,"div",7),u.ALo(2,"async"),u.qZA()),2&e){const e=u.oxw(),t=u.MAs(9);let i;u.xp6(1),u.Q6J("ngIf",null==(i=u.lcZ(2,2,e.system_list))?null:i.length)("ngIfElse",t)}}function te(e,t){1&e&&(u.TgZ(0,"div",21),u._UZ(1,"mat-spinner",22),u.TgZ(2,"p"),u._uU(3,"Loading systems..."),u.qZA(),u.qZA()),2&e&&(u.xp6(1),u.Q6J("diameter",48))}function ie(e,t){1&e&&(u.TgZ(0,"div",21),u.TgZ(1,"p"),u._uU(2,"No systems with module"),u.qZA(),u.qZA())}let se=(()=>{class e{constructor(e){this._service=e,this.filter$=new p.X(""),this.loading=this._service.loading,this.system_list=(0,K.aj)([this.filter$,this._service.system_list]).pipe((0,x.U)(e=>{const[t,i]=e,s=t.toLowerCase();return t?i.filter(e=>e.name.toLowerCase().includes(s)):i}))}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(w))},e.\u0275cmp=u.Xpm({type:e,selectors:[["module-systems"]],decls:10,vars:5,consts:function(){let e,t,i;return e=$localize`:@@nameLabel␟cff1428d10d59d14e45edec3c735a27b5482db59␟8953033926734869941:Name`,t=$localize`:@@systemLabel␟6c24d3e08bc16576fbd5580dc255a31c4b08c366␟8919524640139321287:No. Modules`,i=$localize`:@@createdLabel␟1b051734b0ee9021991c91b3ed4e81c244322462␟4207916966377787111:Created`,[[1,"flex","items-center","mb-4"],["appearance","outline",1,"h-12","flex-1"],["matPrefix","","className","backoffice-magnifying-glass text-xl mr-2"],["matInput","","placeholder","Filter systems...",1,"rounded-none",3,"ngModel","ngModelChange"],[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],["role","table","class","overflow-x-auto",4,"ngIf","ngIfElse"],["role","table",1,"overflow-x-auto"],["table-head",""],["flex","",1,"flex-1","p-2"],e,[1,"w-48","p-2"],t,[1,"w-36","p-2"],i,["table-body","",1,"overflow-y-auto"],["table-row","",4,"ngFor","ngForOf"],["table-row",""],["flex","",1,"flex-1","p-2","underline"],[3,"routerLink"],[1,"flex","flex-col","items-center","p-8","mx-auto"],[1,"mb-4",3,"diameter"]]},template:function(e,t){if(1&e&&(u.TgZ(0,"section",0),u.TgZ(1,"mat-form-field",1),u._UZ(2,"app-icon",2),u.TgZ(3,"input",3),u.NdJ("ngModelChange",function(e){return t.filter$.next(e)}),u.qZA(),u.qZA(),u.qZA(),u.YNc(4,ee,3,4,"section",4),u.ALo(5,"async"),u.YNc(6,te,4,1,"ng-template",null,5,u.W1O),u.YNc(8,ie,3,0,"ng-template",null,6,u.W1O)),2&e){const e=u.MAs(7);u.xp6(3),u.Q6J("ngModel",""),u.xp6(1),u.Q6J("ngIf",!u.lcZ(5,3,t.loading))("ngIfElse",e)}},directives:[X.KE,G.o,X.qo,R.Nt,n.Fj,n.JJ,n.On,s.O5,s.sg,o.yS,U.$g],pipes:[s.Ov,J.R],styles:["[_nghost-%COMP%]{padding:1rem;height:100%;width:100%}"]}),e})();var ne=i(3511),oe=i(9858);const ae=[{path:":id",component:g,children:[{path:"about",component:j},{path:"systems",component:se},{path:"extend/:id",component:ne.z},{path:"history",component:oe.D},{path:"**",redirectTo:"about"}]},{path:"**",redirectTo:"-"}];var ce=i(7561);let le=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[s.ez,n.u5,o.Bz.forChild(ae),ce.X]]}),e})()}}]);