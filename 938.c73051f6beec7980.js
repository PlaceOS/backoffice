"use strict";(self.webpackChunkbackoffice=self.webpackChunkbackoffice||[]).push([[938],{8938:(Me,I,c)=>{c.r(I),c.d(I,{AppTriggersModule:()=>Ze});var u=c(6575),E=c(987),b=c(9794),f=c(7792),g=c(5530),L=c(7422),P=c(4424),T=c(1670),U=c(462),J=c(8159),B=c(9681),w=c(6520),K=c(680),G=c(7627),A=c(3759),N=c(3540),p=c(9928),Q=c(7398),z=c(819),e=c(3129),k=c(6861);let x=(()=>{class n{get active_item(){return this._service.active_item}constructor(t,i){this._service=t,this._dialog=i,this._change=new U.X(0),this.item=this._service.item,this.instances=(0,J.aj)([this.item,this._change]).pipe((0,w.w)(([o])=>o instanceof g.cgz?(0,g.o$$)(o.id):(0,B.of)([])),(0,K.d)(1))}editCondition(t=null,i){var o=this;return(0,T.Z)(function*(){if(!i)return;const s=o._dialog.open(z.P,{width:"auto",height:"auto",data:{trigger:o.active_item,condition:t?JSON.parse(JSON.stringify(t)):void 0,system:i}}),r=yield Promise.race([s.componentInstance.event.pipe((0,G.P)(a=>"done"===a.reason)).toPromise(),s.afterClosed().toPromise()]);r?.reason&&o._service.replaceItem(r.metadata.trigger)})()}editAction(t=null,i){var o=this;return(0,T.Z)(function*(){if(!i)return;const s=o._dialog.open(Q.L,{data:{trigger:o.active_item,action:t,system:i}}),r=yield Promise.race([s.componentInstance.event.pipe((0,G.P)(a=>"done"===a.reason)).toPromise(),s.afterClosed().toPromise()]);r?.reason&&o._service.replaceItem(r.metadata.trigger)})()}reorderAction(t,i,o){var s=this;return(0,T.Z)(function*(){const r=yield(0,A._5)({title:`Reoreder trigger ${t} action`,content:"Are you sure you want remove this trigger condition?<br>All systems using this trigger will be updated <strong>immediately</strong>.",icon:{type:"icon",class:"backoffice-trash"}},s._dialog);if(!r)return;const a=[..."function"===t?s.active_item.actions.functions:s.active_item.actions.mailers];(0,f.bA)(a,i,o);const l={functions:"function"===t?a:s.active_item.actions.functions,mailers:"function"===t?s.active_item.actions.mailers:a};r.loading("Re-ordering triggger actions...");const d=yield(0,g.dqJ)(s.active_item.id,{...s.active_item.toJSON(),actions:l}).toPromise().catch(C=>C);if(!(d instanceof g.cgz))return(0,p.cB)(`Error re-ordered trigger ${t} action. Error: ${JSON.stringify(d.response||d.message||d)}`);s._service.replaceItem(d),(0,p.t5)(`Successfully re-ordered trigger ${t} action.`)})()}removeCondition(t){var i=this;return(0,T.Z)(function*(){const o=yield(0,A._5)({title:"Remove trigger condition",content:"Are you sure you want remove this trigger condition?<br>All systems using this trigger will be updated <strong>immediately</strong>.",icon:{type:"icon",class:"backoffice-trash"}},i._dialog);if(!o?.reason)return;o.loading("Removing trigger condition...");const s=i.active_item,r={comparisons:[...s.conditions.comparisons],time_dependents:[...s.conditions.time_dependents]},a=(t.type?s.conditions.time_dependents:s.conditions.comparisons).findIndex(d=>JSON.stringify(d)===JSON.stringify(t));r.time_dependents.splice(a,1),(t.type?r.time_dependents:r.comparisons).splice(a,1);const l=yield(0,g.dqJ)(s.id,{...s.toJSON(),conditions:r}).toPromise().catch(d=>d);if(o.close(),!(l instanceof g.cgz))return(0,p.cB)(`Error removing trigger condition. Error: ${JSON.stringify(l.response||l.message||l)}`);i._service.replaceItem(l),(0,p.t5)("Successfully removed trigger condition.")})()}removeAction(t){var i=this;return(0,T.Z)(function*(){const o=yield(0,A._5)({title:"Remove trigger action",content:"Are you sure you want remove this trigger action?<br>All systems using this trigger will be updated <strong>immediately</strong>.",icon:{type:"icon",class:"backoffice-trash"}},i._dialog);if(!o?.reason)return;o.loading("Removing trigger action...");const s=i.active_item,r={functions:[...s.actions.functions],mailers:[...s.actions.mailers]},a=(t.emails?s.actions.mailers:s.actions.functions).findIndex(d=>JSON.stringify(d)===JSON.stringify(t));(t.emails?r.mailers:r.functions).splice(a,1);const l=yield(0,g.dqJ)(s.id,{...s.toJSON(),actions:r}).toPromise().catch(d=>d);if(o.close(),!(l instanceof g.cgz))return(0,p.cB)(`Error removing trigger action. Error: ${JSON.stringify(l.response||l.message||l)}`);i._service.replaceItem(l),(0,p.t5)("Successfully removed trigger action.")})()}removeTriggerFromParent(t){var i=this;return(0,T.Z)(function*(){const o=t.zone_id?"zone":"system",s=yield(0,A._5)({title:`Remove trigger from ${o}`,content:`Are you sure you want remove this trigger from ${t.name}?<br>The ${o} will be updated <strong>immediately</strong>.`,icon:{type:"icon",class:"backoffice-trash"}},i._dialog);if(!s?.reason)return;s.loading(`Removing trigger from ${o}...`);const r=g.LfU;let a=yield r(t.control_system_id,t?.id||i.active_item.id).toPromise().catch(l=>({error:l}));if(s.close(),a?.error)return a=a.error,(0,p.cB)(`Error removing trigger from ${o}. Error: ${a.responseText||a.message||a}`);i._change.next(Date.now()),(0,p.t5)(`Successfully removed trigger from ${o}.`)})()}static#e=this.\u0275fac=function(i){return new(i||n)(e.LFG(N.L),e.LFG(k.uw))};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var R=c(5997),X=c(3992),S=c(702),O=c(257),Z=c(857),q=c(7208);function Y(n,_){if(1&n&&(e.TgZ(0,"div",3)(1,"label",18),e.SDv(2,19),e.qZA(),e.TgZ(3,"div",20),e._uU(4),e.ALo(5,"dateFrom"),e.qZA()()),2&n){const t=e.oxw();e.xp6(4),e.Oqu(e.lcZ(5,1,1e3*t.item.created_at))}}function H(n,_){if(1&n&&(e.TgZ(0,"div",3)(1,"label",18),e.SDv(2,21),e.qZA(),e.TgZ(3,"div",20),e._uU(4),e.ALo(5,"dateFrom"),e.qZA()()),2&n){const t=e.oxw();e.xp6(4),e.Oqu(e.lcZ(5,1,1e3*t.item.updated_at))}}function V(n,_){1&n&&(e.TgZ(0,"div",26),e.tHW(1,27),e._UZ(2,"div",28),e.N_p(),e.qZA())}const F=function(){return{class:"backoffice-edit"}},h=function(){return{class:"backoffice-trash"}};function j(n,_){if(1&n){const t=e.EpF();e.TgZ(0,"div",29),e._UZ(1,"div",30),e.TgZ(2,"div",28),e._uU(3),e.ALo(4,"json"),e.ALo(5,"json"),e.qZA(),e.TgZ(6,"div",31)(7,"button",8),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.editCondition(s))}),e._UZ(8,"app-icon",32),e.qZA(),e.TgZ(9,"button",33),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.removeCondition(s))}),e._UZ(10,"app-icon",32),e.qZA()()()}if(2&n){const t=_.$implicit,i=e.oxw(2);e.xp6(3),e.lnq(" ",e.lcZ(4,6,t.left)," ",t.operator," ",e.lcZ(5,8,t.right)," "),e.xp6(4),e.Q6J("disabled",!i.template_system),e.xp6(1),e.Q6J("icon",e.DdM(10,F)),e.xp6(2),e.Q6J("icon",e.DdM(11,h))}}function W(n,_){1&n&&(e.TgZ(0,"div",26),e.tHW(1,34),e._UZ(2,"div",28),e.N_p(),e.qZA())}function ee(n,_){if(1&n){const t=e.EpF();e.TgZ(0,"div",29),e._UZ(1,"div",30),e.TgZ(2,"div",28),e._uU(3),e.qZA(),e.TgZ(4,"div",31)(5,"button",35),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.editCondition(s))}),e._UZ(6,"app-icon",36),e.qZA(),e.TgZ(7,"button",37),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.removeCondition(s))}),e._UZ(8,"app-icon",38),e.qZA()()()}if(2&n){const t=_.$implicit,i=e.oxw(2);e.xp6(3),e.AsE(" ","at"===t.type?"At time":"CRON"," ","at"===t.type?t.time:t.cron," "),e.xp6(2),e.Q6J("disabled",!i.template_system)}}function te(n,_){if(1&n&&(e.TgZ(0,"section",22),e.YNc(1,V,3,0,"div",23),e.TgZ(2,"div",24),e.YNc(3,j,11,12,"div",25),e.qZA(),e.YNc(4,W,3,0,"div",23),e.TgZ(5,"div",24),e.YNc(6,ee,9,3,"div",25),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.comparisons.length),e.xp6(2),e.Q6J("ngForOf",t.comparisons),e.xp6(1),e.Q6J("ngIf",t.time_dependents.length),e.xp6(2),e.Q6J("ngForOf",t.time_dependents)}}function ie(n,_){1&n&&(e.TgZ(0,"div",26),e.tHW(1,41),e._UZ(2,"div",28),e.N_p(),e.qZA())}function ne(n,_){1&n&&e._UZ(0,"div",45)}const M=function(){return{class:"backoffice-select-arrows"}};function oe(n,_){if(1&n){const t=e.EpF();e.TgZ(0,"div",42)(1,"div",43),e._UZ(2,"app-icon",32),e.qZA(),e.TgZ(3,"div",28),e._uU(4),e.ALo(5,"json"),e.qZA(),e.TgZ(6,"div",31)(7,"button",14),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.editAction(s))}),e._UZ(8,"app-icon",32),e.qZA(),e.TgZ(9,"button",33),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.removeAction(s))}),e._UZ(10,"app-icon",32),e.qZA()(),e.YNc(11,ne,1,0,"div",44),e.qZA()}if(2&n){const t=_.$implicit,i=e.oxw(2);e.xp6(2),e.Q6J("icon",e.DdM(9,M)),e.xp6(2),e.lnq(" ",t.mod,", ",t.method,"(",e.lcZ(5,7,t.args),") "),e.xp6(3),e.Q6J("disabled",!i.template_system),e.xp6(1),e.Q6J("icon",e.DdM(10,F)),e.xp6(2),e.Q6J("icon",e.DdM(11,h))}}function se(n,_){1&n&&(e.TgZ(0,"div",26),e.tHW(1,46),e._UZ(2,"div",28),e.N_p(),e.qZA())}function re(n,_){1&n&&e._UZ(0,"div",45)}function ce(n,_){if(1&n){const t=e.EpF();e.TgZ(0,"div",42)(1,"div",43),e._UZ(2,"app-icon",32),e.qZA(),e.TgZ(3,"div",28)(4,"span",47),e.SDv(5,48),e.ALo(6,"formatList"),e.qZA(),e._uU(7),e.qZA(),e.TgZ(8,"div",31)(9,"button",14),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.editAction(s))}),e._UZ(10,"app-icon",32),e.qZA(),e.TgZ(11,"button",33),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.removeAction(s))}),e._UZ(12,"app-icon",32),e.qZA()(),e.YNc(13,re,1,0,"div",44),e.qZA()}if(2&n){const t=_.$implicit,i=e.oxw(2);e.xp6(2),e.Q6J("icon",e.DdM(10,M)),e.xp6(2),e.Q6J("matTooltip",e.lcZ(6,8,t.emails)),e.xp6(2),e.pQV(t.emails.length)(t.emails.length),e.QtT(5),e.xp6(1),e.hij("\xa0 | Body Length: ",t.content.length," "),e.xp6(2),e.Q6J("disabled",!i.template_system),e.xp6(1),e.Q6J("icon",e.DdM(11,F)),e.xp6(2),e.Q6J("icon",e.DdM(12,h))}}function _e(n,_){if(1&n){const t=e.EpF();e.TgZ(0,"section",22),e.YNc(1,ie,3,0,"div",23),e.TgZ(2,"div",39),e.NdJ("cdkDropListDropped",function(o){e.CHM(t);const s=e.oxw();return e.KtG(s.confirmReorder("function",o))}),e.YNc(3,oe,12,12,"div",40),e.qZA(),e.YNc(4,se,3,0,"div",23),e.TgZ(5,"div",39),e.NdJ("cdkDropListDropped",function(o){e.CHM(t);const s=e.oxw();return e.KtG(s.confirmReorder("mailer",o))}),e.YNc(6,ce,14,13,"div",40),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.functions.length),e.xp6(2),e.Q6J("ngForOf",t.functions),e.xp6(1),e.Q6J("ngIf",t.mailers.length),e.xp6(2),e.Q6J("ngForOf",t.mailers)}}function ae(n,_){1&n&&(e.TgZ(0,"div",49),e.SDv(1,50),e.qZA())}function le(n,_){1&n&&(e.TgZ(0,"div",49),e.SDv(1,51),e.qZA())}let de=(()=>{class n extends P.c{get item(){return this._service.active_item}constructor(t){super(),this._service=t,this.comparisons=[],this.time_dependents=[],this.functions=[],this.mailers=[],this.query_fn=i=>(0,g.vIL)({q:i}).pipe((0,L.U)(o=>o.data)),this.editCondition=i=>this._service.editCondition(i,this.template_system),this.removeCondition=i=>this._service.removeCondition(i),this.editAction=i=>this._service.editAction(i,this.template_system),this.removeAction=i=>this._service.removeAction(i)}ngOnInit(){this.subscription("item",this._service.item.subscribe(t=>{this.item&&this.item.conditions&&(this.comparisons=this.item.conditions.comparisons||[],this.time_dependents=this.item.conditions.time_dependents||[],this.functions=this.item.actions.functions||[],this.mailers=this.item.actions.mailers||[])}))}confirmReorder(t,i){i&&i.previousIndex!==i.currentIndex&&this._service.reorderAction(t,i.previousIndex,i.currentIndex)}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(x))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["trigger-about"]],features:[e.qOj],decls:24,vars:10,consts:function(){let t,i,o,s,r,a,l,d,C,v,y,$,D;return t=$localize`:@@triggerTemplateSystemLabel␟f137c1d09ed9de301a81d208b8cdad80a968dcaf␟6860745490563598830:Template System: `,i=$localize`:@@triggerConditionsHeader␟1020647667eed59388dbc8a6094558415ad60d7d␟1021838865383496895: Conditions `,o=$localize`:@@triggerActionsHeader␟208b27e7a9b133922050b947e10f18db10b61114␟6653730762255659549: Actions `,s=$localize`:@@triggerCreatedAtLabel␟d49f4e2d0f6f1c5c27f50ce84b641707b3a4ee6c␟413007852336996465: Created: `,r=$localize`:@triggerUpdatedAtLabel␟66e4cd62a9d138134250c0c4601360b86ef456b3␟2152865669771715382: Updated: `,a=$localize`:@@triggerComparisonLabel␟2c50e7b3646c263fc578eebbc9d6088cc3afb6a9␟3927510240684371304:${"\ufffd#2\ufffd"}:START_TAG_DIV:Variable Comparison Condtions${"\ufffd/#2\ufffd"}:CLOSE_TAG_DIV:`,l=$localize`:@@triggerTimeLabel␟9fc71327ed24f47d8e496dae7e04e96b20509d93␟997506514207464791:${"\ufffd#2\ufffd"}:START_TAG_DIV:Time Dependent Conditions${"\ufffd/#2\ufffd"}:CLOSE_TAG_DIV:`,d=$localize`:@@triggerFunctionsLabel␟86ae51bf8b293757b07a57dc39d9c3d0ad92f6fa␟6665573509830119346:${"\ufffd#2\ufffd"}:START_TAG_DIV:Function Call Actions${"\ufffd/#2\ufffd"}:CLOSE_TAG_DIV:`,C=$localize`:@@triggerEmailsLabel␟c4c4274d639d6589ecedd093580919ca1b680d51␟611546964449236535:${"\ufffd#2\ufffd"}:START_TAG_DIV:Email Actions${"\ufffd/#2\ufffd"}:CLOSE_TAG_DIV:`,v=$localize`:␟6e542484e5a5b97451d8db2f7dfdbb6ae9882409␟3981906223455182500:{VAR_PLURAL, plural, =1 {Address } other {Addresses }}`,v=e.Zx4(v,{VAR_PLURAL:"\ufffd1\ufffd"}),y=$localize`:@@emailCountDisplay␟0999296882eee5cef69cbe222cf6f242c97a20f5␟468872276403073781:${"\ufffd0\ufffd"}:INTERPOLATION: ${v}:ICU:`,$=$localize`:@@triggerConditionsEmpty␟2ceae343187bb2de41817089be3056066fd4c8a4␟1442769940044870194: No condtions for trigger `,D=$localize`:@@triggerActionsEmpty␟2bb8a715685fabfcbc42e7d2bbab46768d101c53␟4672676563300001774: No actions for trigger `,[[1,"space-y-2"],["class","flex items-center space-x-2",4,"ngIf"],[1,"my-4"],[1,"flex","items-center","space-x-2"],["for","driver","matTooltip","System to use for available status variables and function calls",1,"whitespace-nowrap"],t,["name","system",1,"h-12",3,"query_fn","ngModel","ngModelChange"],[1,"flex","items-center","my-4"],["btn","","icon","",3,"disabled","click"],["className","backoffice-plus"],[1,"font-medium","text-lg"],i,["role","table",4,"ngIf","ngIfElse"],[1,"flex","items-center","space-x-2","my-4"],["icon","","btn","","icon","",3,"disabled","click"],o,["no_conditions",""],["no_actions",""],[1,"w-24"],s,[1,"value"],r,["role","table"],["table-head","",4,"ngIf"],["table-body",""],["table-row","",4,"ngFor","ngForOf"],["table-head",""],a,[1,"flex-1","p-2"],["table-row",""],[1,"w-12"],[1,"w-24","flex","items-center","justify-center"],[3,"icon"],["btn","","icon","",3,"click"],l,["icon","","matRipple","",3,"disabled","click"],["className","backoffice-edit"],["icon","","matRipple","",3,"click"],["className","backoffice-trash"],["table-body","","cdkDropList","",3,"cdkDropListDropped"],["table-row","","cdkDrag","",4,"ngFor","ngForOf"],d,["table-row","","cdkDrag",""],["cdkDragHandle","",1,"w-12","flex","items-center","justify-center"],["class","w-[calc(100-0.5rem)] m-1 h-10 rounded border-2 border-dashed border-neutral bg-base-200",4,"cdkDragPlaceholder"],[1,"w-[calc(100-0.5rem)]","m-1","h-10","rounded","border-2","border-dashed","border-neutral","bg-base-200"],C,[3,"matTooltip"],y,[1,"flex","flex-col","items-center","p-8"],$,D]},template:function(i,o){if(1&i&&(e.TgZ(0,"section",0),e.YNc(1,Y,6,3,"div",1),e.YNc(2,H,6,3,"div",1),e.qZA(),e._UZ(3,"hr",2),e.TgZ(4,"div",3)(5,"label",4),e.SDv(6,5),e.qZA(),e.TgZ(7,"item-search-field",6),e.NdJ("ngModelChange",function(r){return o.template_system=r}),e.qZA()(),e.TgZ(8,"header",7)(9,"button",8),e.NdJ("click",function(){return o.editCondition()}),e._UZ(10,"app-icon",9),e.qZA(),e.TgZ(11,"div",10),e.SDv(12,11),e.qZA()(),e.YNc(13,te,7,4,"section",12),e.TgZ(14,"header",13)(15,"button",14),e.NdJ("click",function(){return o.editAction()}),e._UZ(16,"app-icon",9),e.qZA(),e.TgZ(17,"div",10),e.SDv(18,15),e.qZA()(),e.YNc(19,_e,7,4,"section",12),e.YNc(20,ae,2,0,"ng-template",null,16,e.W1O),e.YNc(22,le,2,0,"ng-template",null,17,e.W1O)),2&i){const s=e.MAs(21),r=e.MAs(23);e.xp6(1),e.Q6J("ngIf",null==o.item?null:o.item.created_at),e.xp6(1),e.Q6J("ngIf",null==o.item?null:o.item.updated_at),e.xp6(5),e.Q6J("query_fn",o.query_fn)("ngModel",o.template_system),e.xp6(2),e.Q6J("disabled",!o.template_system),e.xp6(4),e.Q6J("ngIf",o.comparisons.length||o.time_dependents.length)("ngIfElse",s),e.xp6(2),e.Q6J("disabled",!o.template_system),e.xp6(4),e.Q6J("ngIf",o.functions.length||o.mailers.length)("ngIfElse",r)}},dependencies:[u.sg,u.O5,E.JJ,E.On,R.o,X.y,S.gM,O.wG,f.Wj,f.Zt,f.Bh,f.Hk,u.Ts,Z.R,q.M],styles:["[_nghost-%COMP%]{height:100%;width:100%}\n\n/*# sourceMappingURL=trigger-about.component.ts-angular-inline--52.css.map*/"]})}return n})();const ge=function(n){return["/zones",n]},me=function(n){return["/systems",n]};function ue(n,_){if(1&n&&(e.TgZ(0,"a",19),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("routerLink",t.zone_id?e.VKq(3,ge,t.zone_id):e.VKq(5,me,t.control_system_id))("matTooltip",t.zone_id||t.control_system_id),e.xp6(1),e.hij(" ",t.name||t.zone_id||t.control_system_id," ")}}function pe(n,_){if(1&n){const t=e.EpF();e.TgZ(0,"div",11)(1,"div",12),e._UZ(2,"div",13),e.qZA(),e.TgZ(3,"div",14),e.YNc(4,ue,2,7,"a",15),e.qZA(),e.TgZ(5,"div",16),e._uU(6),e.ALo(7,"dateFrom"),e.qZA(),e.TgZ(8,"div",12)(9,"button",17),e.NdJ("click",function(){const s=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.deleteTrigger(s))}),e._UZ(10,"app-icon",18),e.qZA()()()}if(2&n){const t=_.$implicit;e.xp6(2),e.ekj("active",t.bookable),e.xp6(2),e.Q6J("ngIf",t.id),e.xp6(2),e.hij(" ",e.lcZ(7,4,1e3*+t.created_at)," ")}}function Te(n,_){if(1&n&&(e.TgZ(0,"div",2)(1,"div",3),e._UZ(2,"td",4),e.TgZ(3,"td",5),e.SDv(4,6),e.qZA(),e.TgZ(5,"td",7),e.SDv(6,8),e.qZA(),e._UZ(7,"td",4),e.qZA(),e.TgZ(8,"div",9),e.YNc(9,pe,11,6,"div",10),e.ALo(10,"async"),e.qZA()()),2&n){const t=e.oxw();e.xp6(9),e.Q6J("ngForOf",e.lcZ(10,1,t.instances))}}function fe(n,_){1&n&&(e.TgZ(0,"div",20)(1,"div",21),e.SDv(2,22),e.qZA()())}let Ae=(()=>{class n{get item(){return this._service.active_item}constructor(t){this._service=t,this.instances=this._service.instances,this.connected={},this.deleteTrigger=i=>this._service.removeTriggerFromParent(i)}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(x))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["trigger-systems"]],decls:4,vars:4,consts:function(){let t,i,o;return t=$localize`:@@systemTableName␟a00b3fab0247b5f24e425efaeb163f6e0a46bf41␟8903333566889559902: Parent ID `,i=$localize`:@@systemTableAdded␟2eb7d7c2b3e22d1a719fb20ddf67d87c565f4c7a␟4724324591383487398: Added `,o=$localize`:@@systemTableEmpty␟0c246c3a5d499a8fa40ffd072ae9bd7ff1c2d5ca␟4487301581823190563: No instances of trigger `,[["role","table",4,"ngIf","ngIfElse"],["empty_state",""],["role","table"],["table-head",""],[1,"w-12","h-10"],[1,"flex-1","h-10","flex","items-center","px-2"],t,[1,"w-32","h-10","flex","items-center","px-2"],i,["table-body",""],["table-row","",4,"ngFor","ngForOf"],["table-row",""],[1,"w-12","flex","items-center","justify-center"],[1,"h-2","w-2","rounded-full","bg-base-content"],[1,"flex-1","p-2"],["class","underline",3,"routerLink","matTooltip",4,"ngIf"],[1,"w-32","p-2"],["btn","","icon","",3,"click"],["className","backoffice-trash"],[1,"underline",3,"routerLink","matTooltip"],[1,"flex","flex-col","items-center","p-8"],[1,"text"],o]},template:function(i,o){if(1&i&&(e.YNc(0,Te,11,3,"div",0),e.ALo(1,"async"),e.YNc(2,fe,3,0,"ng-template",null,1,e.W1O)),2&i){const s=e.MAs(3);let r;e.Q6J("ngIf",null==(r=e.lcZ(1,2,o.instances))?null:r.length)("ngIfElse",s)}},dependencies:[u.sg,u.O5,b.rH,R.o,S.gM,u.Ov,Z.R],styles:["[_nghost-%COMP%]{height:100%;width:100%}.active[_ngcontent-%COMP%]{background-color:var(--success)!important}\n\n/*# sourceMappingURL=trigger-instances.component.ts-angular-inline--53.css.map*/"]})}return n})();var Ce=c(6497),ve=c(2941),Ee=c(5375),be=c(2637),Re=c(5694),Se=c(8771),Fe=c(6529),he=c(4331),Ie=c(1387);function Pe(n,_){if(1&n){const t=e.EpF();e.ynx(0),e._UZ(1,"item-details",15)(2,"item-tablist",16),e.TgZ(3,"div",17,18),e.NdJ("scroll",function(){e.CHM(t);const o=e.MAs(4),s=e.oxw();return e.KtG(s.scroll=o.scrollTop)}),e._UZ(5,"router-outlet"),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("can_edit",!0)("item",t.item),e.xp6(1),e.Q6J("base",t.name)("tabs",t.tab_list)("scrolled",t.scroll>0)}}function Ge(n,_){1&n&&e._UZ(0,"app-debug-output",19)}function Ne(n,_){1&n&&e._UZ(0,"app-debug-output",20)}const xe=[{path:":id",component:(()=>{class n extends P.c{get item(){return this._service.active_item}get extensions(){return(0,ve.fq)(this._service.active_item,this.name)}get debug_position(){return this._debug.position}updateTabList(){this.tab_list=[{id:"about",name:"About",icon:{class:"backoffice-info-with-circle"}},{id:"instances",name:"Instances",count:this.instance_count,icon:{class:"backoffice-documents"}}].concat(this.extensions)}constructor(t,i){super(),this._service=t,this._debug=i,this.name="triggers",this.open_menu=!1,this.instance_count=0,this.tab_list=[],this.newItem=()=>this._service.create()}ngOnInit(){this.subscription("item",this._service.item.subscribe(t=>{this.loadValues(t)})),this.updateTabList()}loadValues(t){var i=this;return(0,T.Z)(function*(){t&&(i.instance_count=(yield(0,g.o$$)(t.id).toPromise()).length,i.updateTabList())})()}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(N.L),e.Y36(Ee.i))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["new-triggers-view"]],features:[e.qOj],decls:15,vars:7,consts:[[1,"absolute","inset-0","flex","items-center","divide-y","sm:divide-y-0","sm:divide-x","divide-base-200","bg-base-100"],[1,"sm:h-full",3,"open","openChange"],[1,"flex","flex-col","h-full","flex-1","overflow-hidden","w-px"],[1,"flex","flex-1","h-px"],["title","Triggers",1,"hidden","sm:block",3,"route"],[1,"flex-1","w-1/2","h-full","relative","flex","flex-col","z-0"],["title","Triggers",1,"z-20","sm:hidden",3,"route"],["btn","","icon","",1,"sm:hidden","mr-2",3,"click"],["className","backoffice-menu"],[1,"flex","flex-col","flex-1","h-1/2"],[4,"ngIf"],["matTooltip","New trigger","matTooltipPosition","right","matRipple","",1,"absolute","bottom-2","left-2","sm:-left-9","w-12","h-12","flex","items-center","justify-center","bg-secondary","rounded-lg","shadow","z-30","text-secondary-content",3,"click"],[1,"text-3xl",3,"className"],["below","",4,"ngIf"],["side","","class","h-full max-w-[30rem]",4,"ngIf"],["type","Trigger",3,"can_edit","item"],[1,"z-10",3,"base","tabs","scrolled"],[1,"flex-1","h-1/2","w-full","overflow-auto","p-4","z-0","relative",3,"scroll"],["el",""],["below",""],["side","",1,"h-full","max-w-[30rem]"]],template:function(i,o){1&i&&(e.TgZ(0,"div",0)(1,"sidebar-menu",1),e.NdJ("openChange",function(r){return o.open_menu=r}),e.qZA(),e.TgZ(2,"div",2)(3,"div",3),e._UZ(4,"item-sidebar",4),e.TgZ(5,"div",5)(6,"item-selection",6)(7,"button",7),e.NdJ("click",function(){return o.open_menu=!0}),e._UZ(8,"app-icon",8),e.qZA()(),e.TgZ(9,"div",9),e.YNc(10,Pe,6,5,"ng-container",10),e.qZA(),e.TgZ(11,"button",11),e.NdJ("click",function(){return o.newItem()}),e._UZ(12,"app-icon",12),e.qZA()()(),e.YNc(13,Ge,1,0,"app-debug-output",13),e.qZA(),e.YNc(14,Ne,1,0,"app-debug-output",14),e.qZA()),2&i&&(e.xp6(1),e.Q6J("open",o.open_menu),e.xp6(3),e.Q6J("route",o.name),e.xp6(2),e.Q6J("route",o.name),e.xp6(4),e.Q6J("ngIf",null==o.item?null:o.item.id),e.xp6(2),e.Q6J("className","backoffice-plus"),e.xp6(1),e.Q6J("ngIf","below"===o.debug_position),e.xp6(1),e.Q6J("ngIf","side"===o.debug_position))},dependencies:[u.O5,b.lC,R.o,be.$,Re.z,Se.V,Fe.K,he.r,Ie.l,S.gM,O.wG]})}return n})(),children:[{path:"about",component:de},{path:"instances",component:Ae},{path:"extend/:id",component:Ce.z},{path:"**",redirectTo:"about"}]},{path:"**",redirectTo:"-"}];var Oe=c(5858);let Ze=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.oAB({type:n});static#i=this.\u0275inj=e.cJS({imports:[u.ez,E.u5,b.Bz.forChild(xe),Oe.X,f._t]})}return n})()}}]);
//# sourceMappingURL=938.c73051f6beec7980.js.map