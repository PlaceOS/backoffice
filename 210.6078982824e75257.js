"use strict";(self.webpackChunkbackoffice=self.webpackChunkbackoffice||[]).push([[210],{9210:(ae,O,r)=>{r.r(O),r.d(O,{AppRepositoriesModule:()=>le});var c=r(4666),M=r(609),R=r(959),d=r(1670),a=r(613),S=r(1843),N=r(4505),y=r(4139),E=r(9095),u=r(7418),T=r(6942),L=r(9151),P=r(6123),F=r(2016),$=r(9850),e=r(9676),Z=r(640);let m=(()=>{class o{constructor(t,i){this._state=t,this._dialog=i,this._loading=new N.X(!1),this.loading=this._loading.asObservable(),this.item=this._state.item,this.driver_list=this._state.active_item$.pipe((0,E.w)(n=>n instanceof a.aPq&&n.repo_type!==a.VYb.Interface?(this._loading.next(!0),(0,a.qTj)(n.id,{limit:2e3})):(0,y.of)(null)),(0,u.K)(n=>[]),(0,T.U)(n=>(this._loading.next(!1),n))),this.commit=this._state.active_item$.pipe((0,L.h)(n=>n instanceof a.aPq),(0,E.w)(n=>(0,a.rmk)(n.id,{count:1})),(0,u.K)(n=>[]),(0,T.U)(n=>n[0]?.commit||"HEAD"))}get active_item(){return this._state.active_item}pullLatestCommit(){var t=this;return(0,d.Z)(function*(){if(!(yield(0,a.cYE)(t.active_item.id).toPromise().catch(l=>{(0,F.cB)(`Error pulling latest commit. Error: ${JSON.stringify(l.response||l.message||"Pull timed out")}`)})))return;const n=yield(0,a.AOp)(t.active_item.id).toPromise();t._state.replaceItem(n)})()}newDriver(t){var i=this;return(0,d.Z)(function*(){i._dialog.open($.K,{height:"auto",width:"auto",maxHeight:"calc(100vh - 2em)",maxWidth:"calc(100vw - 2em)",data:{item:new a.CbG({name:"",module_name:"",repository_id:i.active_item.id,file_name:t}),name:"Driver",save:n=>(0,a.X2O)(n)}})})()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(P.L),e.LFG(Z.uw))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var f=r(4522),g=r(1708),x=r(1185),B=r(3674);function U(o,s){if(1&o&&(e.TgZ(0,"span",24),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" (",t.commit,") ")}}function D(o,s){1&o&&(e.ynx(0),e.SDv(1,25),e.BQk())}function Y(o,s){1&o&&e._UZ(0,"mat-spinner",26)}let K=(()=>{class o extends S.K{constructor(t){super(),this._service=t,this.commit=""}get item(){return this._service.active_item}get local_url(){return this.item.type===a.VYb.Interface?`${location.origin}/${this.item.folder_name}/`:`${location.hash}`}get repo_uri(){return this.item?.uri.replace(/\/[a-zA-Z0-9\-\.:]*@/,"/...@")}ngOnInit(){this.commit="",this.subscription("commit",this._service.commit.subscribe(t=>this.commit=t))}pullLatestCommit(){var t=this;return(0,d.Z)(function*(){t.pulling=!0,yield t._service.pullLatestCommit(),t.pulling=!1})()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(m))},o.\u0275cmp=e.Xpm({type:o,selectors:[["repository-about"]],features:[e.qOj],decls:54,vars:25,consts:function(){let s,t,i,n,l,p,C,v,I,h,b;return s=$localize`:@@descriptionLabel␟4a22c6843133f0b0d7dc0d28f864f2f90c1de7ad␟6996799422725544865:Description:`,t=$localize`:@@repoTypeLabel␟e78c0d60ac39787f62c9159646fe0b3c1ed55a1d␟2736556170366900089:Type:`,i=$localize`:␟f07f17add1b4d8fd14dedf1038249bf1fcc7595c␟2995574017154029352:{VAR_SELECT, select, interface {Interface Repository } driver {Driver Repository } , other {=Unknown=}}`,i=e.Zx4(i,{VAR_SELECT:"\ufffd0\ufffd"}),n=$localize`:@@driverListEmpty␟ae94603c1f5d07ee3a1a2697b3b44cdf7ba68b3b␟1624572359752225100: ${i}:ICU: `,l=$localize`:@@repoFolderNameLabel␟28e6abdb97b12116fa31c70e842d7b4b37e08fda␟8999240573830223335:Folder name:`,p=$localize`:@@repoCreatedAtLabel␟a5ed099ffc9e96f6970df843289ade8a7d20ab9f␟1616250945945379783:Created:`,C=$localize`:@@repoUpdatedAtLabel␟f94240161f912dbd8758b858877cddeab80f36cb␟1116759395536210856:Updated:`,v=$localize`:@@repoUriLabel␟6457460dafb273ccfbc2d68f7ec171f467c6e1c1␟1789506856666851299:Repository URI:`,I=$localize`:@@repoBranchLabel␟6ff214f90707e3964f2a08e22f6a079ec2649a5f␟733188758140846537:Branch:`,h=$localize`:@@repoCommitHashLabel␟682ca154aba791fe87aa293b29c921247e12da9c␟7502103762200984555:Commit hash:`,b=$localize`:@@repoPullAction␟e74b9f1086c2fdfeaf7334dbdfa8651830ab2acf␟2864409842456905465: Pull latest commit `,[[1,"mb-4","text-center","flex","space-x-2"],[1,"rounded","p-2","border","border-gray-200","dark:border-neutral-500","space-y-2","w-1/3","flex-1","flex","flex-col"],[1,"flex","items-center","space-x-2"],s,[1,"value","select-all"],t,[1,"value"],n,l,["target","_blank",3,"href"],p,C,v,[1,"value","underline","select-all"],I,[1,"text-xs"],[1,"whitespace-nowrap"],h,[1,"text-xs","truncate"],["class","select-text mono",4,"ngIf"],[1,"flex-1"],["mat-button","",1,"w-full",3,"disabled","click"],[4,"ngIf","ngIfElse"],["spinner",""],[1,"select-text","mono"],b,["diameter","32"]]},template:function(t,i){if(1&t&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"label"),e.SDv(4,3),e.qZA(),e.TgZ(5,"div",4),e._uU(6),e.qZA()(),e.TgZ(7,"div",2)(8,"label"),e.SDv(9,5),e.qZA(),e.TgZ(10,"div",6),e.SDv(11,7),e.qZA()(),e.TgZ(12,"div",2)(13,"label"),e.SDv(14,8),e.qZA(),e.TgZ(15,"div",4)(16,"a",9),e._uU(17),e.qZA()()(),e.TgZ(18,"div",2)(19,"label"),e.SDv(20,10),e.qZA(),e.TgZ(21,"div",6),e._uU(22),e.ALo(23,"dateFrom"),e.qZA()(),e.TgZ(24,"div",2)(25,"label"),e.SDv(26,11),e.qZA(),e.TgZ(27,"div",6),e._uU(28),e.ALo(29,"dateFrom"),e.qZA()()(),e.TgZ(30,"div",1)(31,"div",2)(32,"label"),e.SDv(33,12),e.qZA(),e.TgZ(34,"div",13)(35,"a",9),e.ALo(36,"safe"),e._uU(37),e.qZA()()(),e.TgZ(38,"div",2)(39,"label"),e.SDv(40,14),e.qZA(),e.TgZ(41,"code",15),e._uU(42),e.qZA()(),e.TgZ(43,"div",2)(44,"label",16),e.SDv(45,17),e.qZA(),e.TgZ(46,"code",18),e._uU(47),e.YNc(48,U,2,1,"span",19),e.qZA()(),e._UZ(49,"div",20),e.TgZ(50,"button",21),e.NdJ("click",function(){return i.pullLatestCommit()}),e.YNc(51,D,2,0,"ng-container",22),e.qZA()()(),e.YNc(52,Y,1,0,"ng-template",null,23,e.W1O)),2&t){const n=e.MAs(53);e.xp6(6),e.hij(" ",i.item.description||"No description"," "),e.xp6(5),e.pQV(i.item.type),e.QtT(11),e.xp6(4),e.ekj("underline","interface"===i.item.type)("pointer-events-none","interface"!==i.item.type),e.xp6(1),e.Q6J("href",i.local_url,e.LSH),e.xp6(1),e.Oqu(i.item.folder_name||"No folder set"),e.xp6(5),e.hij(" ",e.lcZ(23,18,1e3*i.item.created_at)," "),e.xp6(6),e.hij(" ",e.lcZ(29,20,1e3*i.item.updated_at)," "),e.xp6(7),e.Q6J("href",e.xi3(36,22,i.item.uri,"url"),e.LSH),e.xp6(2),e.Oqu(i.repo_uri||"No URI set"),e.xp6(5),e.hij(" ",i.item.branch," "),e.xp6(5),e.hij(" ",i.item.commit_hash||"No Commit hash set"," "),e.xp6(1),e.Q6J("ngIf",i.commit&&i.commit!==i.item.commit_hash),e.xp6(2),e.Q6J("disabled",i.pulling),e.xp6(1),e.Q6J("ngIf",!i.pulling)("ngIfElse",n)}},dependencies:[c.O5,f.lW,g.Ou,x.R,B.y],styles:["[_nghost-%COMP%]{height:100%;width:100%}.mono[_ngcontent-%COMP%]{font-family:var(--mono-font)}label[_ngcontent-%COMP%]{width:6rem;text-align:left}\n/*# sourceMappingURL=repository-about.component.ts-angular-inline--49.css.map*/"]}),o})();var A=r(5341),G=r(9429);function X(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",13),e._UZ(1,"div",14),e.ALo(2,"driverFormat"),e.TgZ(3,"div",15)(4,"button",16),e.NdJ("click",function(){const l=e.CHM(t).$implicit,p=e.oxw(3);return e.KtG(p.newDriver(l))}),e._UZ(5,"app-icon",17),e.qZA()()()}if(2&o){const t=s.$implicit;e.xp6(1),e.Q6J("innerHTML",e.lcZ(2,1,t),e.oJD)}}function z(o,s){if(1&o&&(e.TgZ(0,"div",6)(1,"div",7)(2,"td",8),e.SDv(3,9),e.qZA(),e._UZ(4,"td",10),e.qZA(),e.TgZ(5,"div",11),e.YNc(6,X,6,3,"div",12),e.ALo(7,"async"),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(6),e.Q6J("ngForOf",e.lcZ(7,1,t.driver_list))}}function J(o,s){if(1&o&&(e.ynx(0),e.YNc(1,z,8,3,"div",5),e.ALo(2,"async"),e.BQk()),2&o){const t=e.oxw(),i=e.MAs(4);let n;e.xp6(1),e.Q6J("ngIf",null==(n=e.lcZ(2,2,t.driver_list))?null:n.length)("ngIfElse",i)}}function w(o,s){1&o&&(e.TgZ(0,"div",18)(1,"p"),e.SDv(2,19),e.qZA()())}function Q(o,s){1&o&&(e.TgZ(0,"div",18),e._UZ(1,"mat-spinner",20),e.TgZ(2,"p"),e.SDv(3,21),e.qZA()())}let j=(()=>{class o{constructor(t){this._service=t,this.driver_list=this._service.driver_list,this.newDriver=i=>this._service.newDriver(i)}get item(){return this._service.active_item}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(m))},o.\u0275cmp=e.Xpm({type:o,selectors:[["repository-drivers"]],decls:7,vars:2,consts:function(){let s,t,i,n;return s=$localize`:@@repoDriverHeader␟0fb2961dd5d0938e459c98921d1effe1d21e759b␟4782277420149557084:Available Drivers`,t=$localize`:@@driverListname␟cff1428d10d59d14e45edec3c735a27b5482db59␟8953033926734869941:Name`,i=$localize`:@@driverListEmpty␟0b0bbe90203a8b9ff0681db976d02fbcd960cb85␟6121742772920538074:No drivers for repository`,n=$localize`:@@driverListLoading␟929bfd86e4829c0b7401762d92f52536a57ca6c0␟4949757592530193773:Loading driver list...`,[[1,"font-medium","text-lg","mb-2"],s,[4,"ngIf","ngIfElse"],["empty_state",""],["load_state",""],["role","table","class","overflow-x-auto",4,"ngIf","ngIfElse"],["role","table",1,"overflow-x-auto"],["table-head",""],[1,"flex-1","p-2"],t,[1,"w-12","p-2","h-10"],["body","",1,"overflow-y-auto"],["table-row","",4,"ngFor","ngForOf"],["table-row",""],[1,"flex-1","p-2",3,"innerHTML"],[1,"w-12","flex","justify-center"],["mat-icon-button","",3,"click"],["className","backoffice-plus"],[1,"flex","flex-col","p-8","items-center","justify-center"],i,["diameter","48",1,"mb-4"],n]},template:function(t,i){if(1&t&&(e.TgZ(0,"h3",0),e.SDv(1,1),e.qZA(),e.YNc(2,J,3,4,"ng-container",2),e.YNc(3,w,3,0,"ng-template",null,3,e.W1O),e.YNc(5,Q,4,0,"ng-template",null,4,e.W1O)),2&t){const n=e.MAs(6);e.xp6(2),e.Q6J("ngIf",!i.loading)("ngIfElse",n)}},dependencies:[c.sg,c.O5,A.o,f.lW,g.Ou,c.Ov,G.X],styles:["[_nghost-%COMP%]{height:100%;width:100%}\n/*# sourceMappingURL=repository-drivers.component.ts-angular-inline--50.css.map*/"]}),o})();var V=r(9960),H=r(8537),W=r(4834),k=r(3409),q=r(3182),ee=r(1535),te=r(1551),oe=r(6896),ie=r(207);function ne(o,s){if(1&o){const t=e.EpF();e.ynx(0),e._UZ(1,"item-details",11)(2,"item-tablist",12),e.TgZ(3,"div",13,14),e.NdJ("scroll",function(){e.CHM(t);const n=e.MAs(4),l=e.oxw();return e.KtG(l.scroll=n.scrollTop)}),e._UZ(5,"router-outlet"),e.qZA(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("can_edit",!0)("item",t.item),e.xp6(1),e.Q6J("base",t.name)("tabs",t.tab_list)("scrolled",t.scroll>0)}}const re=[{path:":id",component:(()=>{class o extends S.K{constructor(t,i){super(),this._service=t,this._item=i,this.name="repositories",this.open_menu=!1,this.driver_count=0,this.tab_list=[],this.newItem=()=>this._item.create()}get item(){return this._service.active_item}get extensions(){return(0,H.fq)(this._service.active_item,this.name)}updateTabList(){this.tab_list=(this.driver_count<0||!this.driver_count?[{id:"about",name:"About",icon:{class:"backoffice-info-with-circle"}}]:[{id:"about",name:"About",icon:{class:"backoffice-info-with-circle"}},{id:"drivers",name:"Drivers",count:this.driver_count,icon:{class:"backoffice-documents"}}]).concat(this.extensions)}ngOnInit(){var t=this;return(0,d.Z)(function*(){t.subscription("item",t._service.driver_list.subscribe(i=>{t.driver_count=i?i.length:-1,t.updateTabList()})),t.updateTabList()})()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(m),e.Y36(P.L))},o.\u0275cmp=e.Xpm({type:o,selectors:[["new-repositories-view"]],features:[e.qOj],decls:11,vars:5,consts:[[1,"absolute","inset-0","flex","items-center","divide-y","sm:divide-y-0","sm:divide-x","divide-gray-300","dark:divide-neutral-600","bg-white","dark:bg-neutral-700"],[1,"sm:h-full",3,"open","openChange"],["title","Repositories",1,"hidden","sm:block",3,"route"],[1,"flex-1","w-1/2","h-full","relative","flex","flex-col","z-0"],["title","Repositories",1,"z-20","sm:hidden",3,"route"],["mat-icon-button","",1,"sm:hidden","mr-2",3,"click"],["className","backoffice-menu"],[1,"flex","flex-col","flex-1","h-1/2"],[4,"ngIf"],["matTooltip","New repository","matTooltipPosition","right","matRipple","",1,"absolute","bottom-2","left-2","sm:-left-9","w-12","h-12","flex","items-center","justify-center","bg-primary","dark:bg-pink","rounded-lg","shadow","z-30","text-white",3,"click"],[1,"text-3xl",3,"className"],["type","Repository",3,"can_edit","item"],[1,"z-10",3,"base","tabs","scrolled"],[1,"flex-1","h-1/2","w-full","overflow-auto","p-4","z-0","relative",3,"scroll"],["el",""]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"sidebar-menu",1),e.NdJ("openChange",function(l){return i.open_menu=l}),e.qZA(),e._UZ(2,"item-sidebar",2),e.TgZ(3,"div",3)(4,"item-selection",4)(5,"button",5),e.NdJ("click",function(){return i.open_menu=!0}),e._UZ(6,"app-icon",6),e.qZA()(),e.TgZ(7,"div",7),e.YNc(8,ne,6,5,"ng-container",8),e.qZA(),e.TgZ(9,"button",9),e.NdJ("click",function(){return i.newItem()}),e._UZ(10,"app-icon",10),e.qZA()()()),2&t&&(e.xp6(1),e.Q6J("open",i.open_menu),e.xp6(1),e.Q6J("route",i.name),e.xp6(2),e.Q6J("route",i.name),e.xp6(4),e.Q6J("ngIf",null==i.item?null:i.item.id),e.xp6(2),e.Q6J("className","backoffice-plus"))},dependencies:[c.O5,R.lC,A.o,W.$,k.V,q.K,ee.r,te.l,f.lW,oe.gM,ie.wG]}),o})(),children:[{path:"about",component:K},{path:"drivers",component:j},{path:"extend/:id",component:V.z},{path:"**",redirectTo:"about"}]},{path:"**",redirectTo:"-"}];var se=r(1166);let le=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[c.ez,M.u5,R.Bz.forChild(re),se.X]}),o})()}}]);
//# sourceMappingURL=210.6078982824e75257.js.map