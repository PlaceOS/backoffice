"use strict";(self.webpackChunkbackoffice=self.webpackChunkbackoffice||[]).push([[432],{6179:(R_,f,i)=>{i.r(f),i.d(f,{AppModulesModule:()=>N_});var c=i(6895),S=i(4719),E=i(6581),m=i(5861),a=i(2837),p=i(591),B=i(1086),D=i(2198),x=i(13),A=i(7545),M=i(5154),C=i(4850),Z=i(7221),y=i(2994),T=i(6123),g=i(2016),$=i(7701),_=i(6353),K=i(5412);let U=(()=>{class t{constructor(e,n){this._state=e,this._dialog=n,this._loading=new p.X(!1),this.loading=this._loading.asObservable(),this.item=this._state.item.pipe((0,D.h)(o=>o instanceof a.SQz)),this.associated_settings=this._state.active_item$.pipe((0,x.b)(300),(0,A.w)(o=>o&&o instanceof a.SQz?(0,a.eRm)(o.id):[])),this.driver=this.item.pipe((0,A.w)(o=>(0,a.L4d)(o.driver_id)),(0,M.d)(1)),this.system=this.item.pipe((0,A.w)(o=>o.system_id?(0,a.hMA)(o.system_id):(0,B.of)(null)),(0,M.d)(1)),this.system_list=this.item.pipe((0,A.w)(o=>(this._loading.next(!0),console.log("Loading Systems..."),(0,a.vIL)({module_id:o.id}))),(0,C.U)(o=>o.data),(0,Z.K)(()=>[]),(0,y.b)(o=>this._loading.next(!1)),(0,M.d)(1))}get active_item(){return this._state.active_item}toggleModuleState(){var e=this;return(0,m.Z)(function*(){const o=yield(e.active_item.running?a.iAP:a.Dqv)(e.active_item.id).pipe((0,C.U)(l=>null)).toPromise().catch(l=>l);if(o)return console.log("Error:",o),void("string"==typeof o&&o.length<64?(0,g.cB)(o):(0,g.cB)(`Failed to ${e.active_item.running?"stop":"start"} device '${e.active_item.id}'.\nView Error?`,"View",()=>e.viewDetails(o)));(0,g.t5)("Module successfully "+(e.active_item.running?"stopped":"started")),e.active_item.running=!e.active_item.running})()}viewDetails(e){this._dialog.open($.a,{data:{content:e}})}}return t.\u0275fac=function(e){return new(e||t)(_.LFG(T.L),_.LFG(K.uw))},t.\u0275prov=_.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var X=i(3436),P=i(4859),v=i(1572),L=i(490);function J(t,s){if(1&t&&(_.TgZ(0,"div",11)(1,"label"),_.SDv(2,12),_.qZA(),_.TgZ(3,"div",13),_._uU(4),_.qZA()()),2&t){const e=_.oxw();_.xp6(4),_.Oqu(e.item.notes)}}function G(t,s){if(1&t&&(_.TgZ(0,"div",11)(1,"label"),_.SDv(2,14),_.qZA(),_.TgZ(3,"div",13),_._uU(4),_.qZA()()),2&t){const e=_.oxw();_.xp6(4),_.Oqu(e.item.ip)}}function Q(t,s){if(1&t&&(_.TgZ(0,"div",11)(1,"label"),_.SDv(2,15),_.qZA(),_.TgZ(3,"div",13),_._uU(4),_.qZA()()),2&t){const e=_.oxw();_.xp6(4),_.Oqu(e.item.port)}}function Y(t,s){1&t&&(_.TgZ(0,"code",18),_._uU(1,"TLS"),_.qZA())}function w(t,s){1&t&&(_.TgZ(0,"code",18),_._uU(1,"UDP"),_.qZA())}function z(t,s){if(1&t&&(_.TgZ(0,"div",11)(1,"label"),_.SDv(2,16),_.qZA(),_.YNc(3,Y,2,0,"code",17),_.YNc(4,w,2,0,"code",17),_.qZA()),2&t){const e=_.oxw();_.xp6(3),_.Q6J("ngIf",e.item.tls),_.xp6(1),_.Q6J("ngIf",e.item.udp)}}function j(t,s){if(1&t&&(_.TgZ(0,"div",11)(1,"label"),_.SDv(2,19),_.qZA(),_.TgZ(3,"div",13),_._uU(4),_.ALo(5,"dateFrom"),_.qZA()()),2&t){const e=_.oxw();_.xp6(4),_.hij(" ",_.lcZ(5,1,1e3*e.item.created_at)," ")}}function q(t,s){if(1&t&&(_.TgZ(0,"div",11)(1,"label"),_.SDv(2,20),_.qZA(),_.TgZ(3,"div",13),_._uU(4),_.ALo(5,"dateFrom"),_.qZA()()),2&t){const e=_.oxw();_.xp6(4),_.hij(" ",_.lcZ(5,1,1e3*e.item.updated_at)," ")}}const V=function(t){return["/drivers",t]};function W(t,s){if(1&t&&(_.TgZ(0,"div",11)(1,"label"),_.SDv(2,21),_.qZA(),_.TgZ(3,"a",22),_._uU(4),_.ALo(5,"async"),_.qZA()()),2&t){const e=_.oxw();_.xp6(3),_.Q6J("routerLink",_.VKq(4,V,e.item.driver_id)),_.xp6(1),_.hij(" ",_.lcZ(5,2,e.driver).name||"<Unnamed>"," ")}}const H=function(t){return["/systems",t,"modules"]};function k(t,s){if(1&t&&(_.TgZ(0,"div",11)(1,"label"),_.SDv(2,23),_.qZA(),_.TgZ(3,"a",22),_.ALo(4,"async"),_._uU(5),_.ALo(6,"async"),_.qZA()()),2&t){const e=_.oxw();_.xp6(3),_.Q6J("routerLink",_.VKq(6,H,_.lcZ(4,2,e.system).id)),_.xp6(2),_.hij(" ",_.lcZ(6,4,e.system).name," ")}}function __(t,s){if(1&t&&(_.TgZ(0,"div",24),_.SDv(1,25),_.qZA()),2&t){const e=_.oxw();_.xp6(1),_.pQV(e.item.running),_.QtT(1)}}function e_(t,s){1&t&&_._UZ(0,"mat-spinner",26)}const t_=function(){return[]};function o_(t,s){if(1&t&&(_.TgZ(0,"section"),_._UZ(1,"a-settings-form",27),_.ALo(2,"async"),_.qZA()),2&t){const e=_.oxw();_.xp6(1),_.Q6J("id",e.item.id)("merge",!0)("settings",e.item.settings)("merge_settings",_.lcZ(2,4,e.other_settings)||_.DdM(6,t_))}}function n_(t,s){1&t&&(_.TgZ(0,"div",28),_._UZ(1,"mat-spinner",29),_.TgZ(2,"p"),_.SDv(3,30),_.qZA()())}let i_=(()=>{class t{constructor(e){this._service=e,this.driver=this._service.driver,this.system=this._service.system,this.other_settings=this._service.associated_settings}get item(){return this._service.active_item}toggleModuleState(){var e=this;return(0,m.Z)(function*(){e.stopping=!0,yield e._service.toggleModuleState(),e.stopping=!1})()}}return t.\u0275fac=function(e){return new(e||t)(_.Y36(U))},t.\u0275cmp=_.Xpm({type:t,selectors:[["module-about"]],decls:24,vars:19,consts:function(){let s,e,n,o,l,u,O,R,h,r,I,b;return s=$localize`:@@settingsLabel␟5ba97a3f90a79c4d7720b941ae416c8c84337e38␟180274732945114229: Settings `,e=$localize`:@moduleNotesLabel␟3b193ba24bd715ed412f5419df3acb59090141d3␟8421971980013015956:Notes:`,n=$localize`:@moduleIPLabel␟8271bb466916303dc1516952bf50e7e6626f7b2c␟253752108238785328:IP:`,o=$localize`:@modulePortLabel␟a2ceedad860954f374fc1ac8bae057292b1cec2e␟6167294183925653141:Port:`,l=$localize`:@moduleTLSLabel␟2a29507802055ca7586062ecd0486e58728951ae␟6065664962291805568:Protocol:`,u=$localize`:@@moduleCreatedAtLabel␟a5ed099ffc9e96f6970df843289ade8a7d20ab9f␟1616250945945379783:Created:`,O=$localize`:@moduleUpdatedAtLabel␟f94240161f912dbd8758b858877cddeab80f36cb␟1116759395536210856:Updated:`,R=$localize`:@moduleUpdatedAtLabel␟797f76e214854e3930b89347440a035b92fb3adb␟1174891546565206449:Driver:`,h=$localize`:@moduleUpdatedAtLabel␟aaeaff696111bf2df60b2d2df331ca5c1d7dc4e2␟6879447585908883888:System:`,r=$localize`:␟5fda3780116b25a7118c37e1c91cfc7f5c33033e␟6379274373106326963:{VAR_SELECT, select, true {Stop Module } false {Start
                    Module }}`,r=_.Zx4(r,{VAR_SELECT:"\ufffd0\ufffd"}),I=$localize`:@@moduleStateToggle␟efea421c84f6d7b59e0731f34a33669608173f2b␟4260503478140979604: ${r}:ICU: `,b=$localize`:@@moduleDetailsLoading␟cb7cffb188a2b0bce758e40f67c29387dd6ccfcf␟3678638452756535871:Loading module settings...`,[[1,"space-y-2","flex"],[1,"shadow","rounded","p-2","border","border-black/10","space-y-2","min-w-[50%]"],["class","flex items-center space-x-2",4,"ngIf"],[1,"my-4"],["mat-button","",1,"w-32",3,"disabled","click"],["class","text",4,"ngIf"],["diameter","32",4,"ngIf"],[1,"font-medium","text-lg"],s,[4,"ngIf","ngIfElse"],["load_state",""],[1,"flex","items-center","space-x-2"],e,[1,"value"],n,o,l,["class","bg-success text-white",4,"ngIf"],[1,"bg-success","text-white"],u,O,R,[1,"underline",3,"routerLink"],h,[1,"text"],I,["diameter","32"],[3,"id","merge","settings","merge_settings"],[1,"p-8","flex","flex-col","items-center","justify-center","m-auto"],["diameter","48",1,"mb-4"],b]},template:function(e,n){if(1&e&&(_.TgZ(0,"section",0)(1,"div",1),_.YNc(2,J,5,1,"div",2),_.YNc(3,G,5,1,"div",2),_.YNc(4,Q,5,1,"div",2),_.YNc(5,z,5,2,"div",2),_.YNc(6,j,6,3,"div",2),_.YNc(7,q,6,3,"div",2),_.YNc(8,W,6,6,"div",2),_.ALo(9,"async"),_.YNc(10,k,7,8,"div",2),_.ALo(11,"async"),_.qZA()(),_._UZ(12,"hr",3),_.TgZ(13,"section")(14,"button",4),_.NdJ("click",function(){return n.toggleModuleState()}),_.YNc(15,__,2,1,"div",5),_.YNc(16,e_,1,0,"mat-spinner",6),_.qZA()(),_._UZ(17,"hr",3),_.TgZ(18,"header",7),_.SDv(19,8),_.qZA(),_.YNc(20,o_,3,7,"section",9),_.ALo(21,"async"),_.YNc(22,n_,4,0,"ng-template",null,10,_.W1O)),2&e){const o=_.MAs(23);_.xp6(2),_.Q6J("ngIf",n.item.notes),_.xp6(1),_.Q6J("ngIf",n.item.ip),_.xp6(1),_.Q6J("ngIf",n.item.port>1),_.xp6(1),_.Q6J("ngIf",n.item.tls||n.item.udp),_.xp6(1),_.Q6J("ngIf",n.item.created_at),_.xp6(1),_.Q6J("ngIf",n.item.updated_at),_.xp6(1),_.Q6J("ngIf",_.lcZ(9,13,n.driver)),_.xp6(2),_.Q6J("ngIf",_.lcZ(11,15,n.system)),_.xp6(4),_.Q6J("disabled",n.stopping),_.xp6(1),_.Q6J("ngIf",!n.stopping),_.xp6(1),_.Q6J("ngIf",n.stopping),_.xp6(4),_.Q6J("ngIf",n.item.settings&&_.lcZ(21,17,n.other_settings))("ngIfElse",o)}},dependencies:[c.O5,E.yS,X.v,P.lW,v.Ou,c.Ov,L.R],styles:["[_nghost-%COMP%]{height:100%;width:100%}label[_ngcontent-%COMP%]{width:4rem}"]}),t})();var s_=i(3426),F=i(5341),N=i(9549),l_=i(4144);const d_=function(t){return["/systems",t]};function a_(t,s){if(1&t&&(_.TgZ(0,"div",18)(1,"div",19)(2,"a",20),_._uU(3),_.qZA()(),_.TgZ(4,"div",12),_._uU(5),_.qZA(),_.TgZ(6,"div",14),_._uU(7),_.ALo(8,"dateFrom"),_.qZA()()),2&t){const e=s.$implicit;_.xp6(2),_.Q6J("routerLink",_.VKq(6,d_,e.id)),_.xp6(1),_.Oqu(e.name),_.xp6(2),_.hij(" ",e.installed_ui_devices||"0"," "),_.xp6(2),_.hij(" ",_.lcZ(8,4,1e3*e.created_at)," ")}}function c_(t,s){if(1&t&&(_.TgZ(0,"div",8)(1,"div",9)(2,"div",10),_.SDv(3,11),_.qZA(),_.TgZ(4,"div",12),_.SDv(5,13),_.qZA(),_.TgZ(6,"div",14),_.SDv(7,15),_.qZA()(),_.TgZ(8,"div",16),_.YNc(9,a_,9,8,"div",17),_.ALo(10,"async"),_.qZA()()),2&t){const e=_.oxw(2);_.xp6(9),_.Q6J("ngForOf",_.lcZ(10,1,e.system_list))}}function S_(t,s){if(1&t&&(_.TgZ(0,"section"),_.YNc(1,c_,11,3,"div",7),_.ALo(2,"async"),_.qZA()),2&t){const e=_.oxw(),n=_.MAs(9);let o;_.xp6(1),_.Q6J("ngIf",null==(o=_.lcZ(2,2,e.system_list))?null:o.length)("ngIfElse",n)}}function E_(t,s){1&t&&(_.TgZ(0,"div",21),_._UZ(1,"mat-spinner",22),_.TgZ(2,"p"),_._uU(3,"Loading systems..."),_.qZA()()),2&t&&(_.xp6(1),_.Q6J("diameter",48))}function A_(t,s){1&t&&(_.TgZ(0,"div",21)(1,"p"),_._uU(2,"No systems with module"),_.qZA()())}let u_=(()=>{class t{constructor(e){this._service=e,this.filter$=new p.X(""),this.loading=this._service.loading,this.system_list=(0,s_.aj)([this.filter$,this._service.system_list]).pipe((0,C.U)(n=>{const[o,l]=n,u=o.toLowerCase();return o?l.filter(O=>O.name.toLowerCase().includes(u)):l}))}}return t.\u0275fac=function(e){return new(e||t)(_.Y36(U))},t.\u0275cmp=_.Xpm({type:t,selectors:[["module-systems"]],decls:10,vars:5,consts:function(){let s,e,n;return s=$localize`:@@nameLabel␟cff1428d10d59d14e45edec3c735a27b5482db59␟8953033926734869941:Name`,e=$localize`:@@systemLabel␟6c24d3e08bc16576fbd5580dc255a31c4b08c366␟8919524640139321287:No. Modules`,n=$localize`:@@createdLabel␟1b051734b0ee9021991c91b3ed4e81c244322462␟4207916966377787111:Created`,[[1,"flex","items-center","mb-4"],["appearance","outline",1,"h-12","flex-1"],["matPrefix","","className","backoffice-magnifying-glass text-xl mr-2"],["matInput","","placeholder","Filter systems...",1,"rounded-none",3,"ngModel","ngModelChange"],[4,"ngIf","ngIfElse"],["load_state",""],["empty_state",""],["role","table","class","overflow-x-auto",4,"ngIf","ngIfElse"],["role","table",1,"overflow-x-auto"],["table-head",""],["flex","",1,"flex-1","p-2"],s,[1,"w-48","p-2"],e,[1,"w-36","p-2"],n,["table-body","",1,"overflow-y-auto"],["table-row","",4,"ngFor","ngForOf"],["table-row",""],["flex","",1,"flex-1","p-2","underline"],[3,"routerLink"],[1,"flex","flex-col","items-center","p-8","mx-auto"],[1,"mb-4",3,"diameter"]]},template:function(e,n){if(1&e&&(_.TgZ(0,"section",0)(1,"mat-form-field",1),_._UZ(2,"app-icon",2),_.TgZ(3,"input",3),_.NdJ("ngModelChange",function(l){return n.filter$.next(l)}),_.qZA()()(),_.YNc(4,S_,3,4,"section",4),_.ALo(5,"async"),_.YNc(6,E_,4,1,"ng-template",null,5,_.W1O),_.YNc(8,A_,3,0,"ng-template",null,6,_.W1O)),2&e){const o=_.MAs(7);_.xp6(3),_.Q6J("ngModel",""),_.xp6(1),_.Q6J("ngIf",!_.lcZ(5,3,n.loading))("ngIfElse",o)}},dependencies:[c.sg,c.O5,S.Fj,S.JJ,S.On,E.yS,F.o,N.KE,N.qo,l_.Nt,v.Ou,c.Ov,L.R],styles:["[_nghost-%COMP%]{height:100%;width:100%}"]}),t})();var O_=i(9960),r_=i(5558),m_=i(8537),M_=i(1843),C_=i(4834),g_=i(3409),f_=i(3182),p_=i(1535),T_=i(1551),U_=i(266),P_=i(3238);function v_(t,s){if(1&t){const e=_.EpF();_.ynx(0),_._UZ(1,"item-details",11)(2,"item-tablist",12),_.TgZ(3,"div",13,14),_.NdJ("scroll",function(){_.CHM(e);const o=_.MAs(4),l=_.oxw();return _.KtG(l.scroll=o.scrollTop)}),_._UZ(5,"router-outlet"),_.qZA(),_.BQk()}if(2&t){const e=_.oxw();_.xp6(1),_.Q6J("can_edit",!0)("item",e.item),_.xp6(1),_.Q6J("base",e.name)("tabs",e.tab_list)("scrolled",e.scroll>0)}}const L_=[{path:":id",component:(()=>{class t extends M_.K{constructor(e){super(),this._service=e,this.open_menu=!1,this.name="modules",this.tab_list=[],this.newItem=()=>this._service.create()}get item(){return this._service.active_item}get extensions(){return(0,m_.fq)(this._service.active_item,this.name)}updateTabList(){this.tab_list=[{id:"about",name:"About",icon:{class:"backoffice-info-with-circle"}},{id:"systems",name:"Systems",count:this.system_count,icon:{class:"backoffice-documents"}},{id:"history",name:"Settings History",icon:{class:"backoffice-clock"}}].concat(this.extensions)}ngOnInit(){this.subscription("item",this._service.item.subscribe(e=>{this.loadValues(e),this.updateTabList()})),this.updateTabList()}loadValues(e){var n=this;return(0,m.Z)(function*(){if(!e)return;const o={offset:0,limit:1,module_id:e.id};n.system_count=(yield(0,a.vIL)(o).toPromise()).total})()}}return t.\u0275fac=function(e){return new(e||t)(_.Y36(T.L))},t.\u0275cmp=_.Xpm({type:t,selectors:[["new-modules-view"]],features:[_.qOj],decls:11,vars:5,consts:[[1,"absolute","inset-0","flex","items-center","divide-y","sm:divide-y-0","sm:divide-x","divide-gray-300","dark:divide-neutral-600","bg-white","dark:bg-neutral-700"],[1,"sm:h-full",3,"open","openChange"],["title","Modules",1,"hidden","sm:block",3,"route"],[1,"flex-1","w-1/2","h-full","relative","flex","flex-col","z-0"],["title","Modules",1,"z-20","sm:hidden",3,"route"],["mat-icon-button","",1,"sm:hidden","mr-2",3,"click"],["className","backoffice-menu"],[1,"flex","flex-col","flex-1","h-1/2"],[4,"ngIf"],["matTooltip","New module","matTooltipPosition","right","matRipple","",1,"absolute","bottom-2","left-2","sm:-left-9","w-12","h-12","flex","items-center","justify-center","bg-primary","dark:bg-pink","rounded-lg","shadow","z-30","text-white",3,"click"],[1,"text-3xl",3,"className"],["type","Module",3,"can_edit","item"],[1,"z-10",3,"base","tabs","scrolled"],[1,"flex-1","h-1/2","w-full","overflow-auto","p-4","z-0","relative",3,"scroll"],["el",""]],template:function(e,n){1&e&&(_.TgZ(0,"div",0)(1,"sidebar-menu",1),_.NdJ("openChange",function(l){return n.open_menu=l}),_.qZA(),_._UZ(2,"item-sidebar",2),_.TgZ(3,"div",3)(4,"item-selection",4)(5,"button",5),_.NdJ("click",function(){return n.open_menu=!0}),_._UZ(6,"app-icon",6),_.qZA()(),_.TgZ(7,"div",7),_.YNc(8,v_,6,5,"ng-container",8),_.qZA(),_.TgZ(9,"button",9),_.NdJ("click",function(){return n.newItem()}),_._UZ(10,"app-icon",10),_.qZA()()()),2&e&&(_.xp6(1),_.Q6J("open",n.open_menu),_.xp6(1),_.Q6J("route",n.name),_.xp6(2),_.Q6J("route",n.name),_.xp6(4),_.Q6J("ngIf",null==n.item?null:n.item.id),_.xp6(2),_.Q6J("className","backoffice-plus"))},dependencies:[c.O5,E.lC,F.o,C_.$,g_.V,f_.K,p_.r,T_.l,P.lW,U_.gM,P_.wG]}),t})(),children:[{path:"about",component:i_},{path:"systems",component:u_},{path:"extend/:id",component:O_.z},{path:"history",component:r_.D},{path:"**",redirectTo:"about"}]},{path:"**",redirectTo:"-"}];var F_=i(4524);let N_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=_.oAB({type:t}),t.\u0275inj=_.cJS({imports:[c.ez,S.u5,E.Bz.forChild(L_),F_.X]}),t})()}}]);